"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.BOOTSTRAP_PATH = exports.WDA_BUNDLE_ID = exports.WebDriverAgent = exports.default = void 0;

require("source-map-support/register");

var _lodash = _interopRequireDefault(require("lodash"));

var _path = _interopRequireDefault(require("path"));

var _url2 = _interopRequireDefault(require("url"));

var _appiumBaseDriver = require("appium-base-driver");

var _appiumSupport = require("appium-support");

var _logger = _interopRequireDefault(require("../logger"));

var _noSessionProxy = require("./no-session-proxy");

var _utils = require("./utils");

var _utils2 = require("../utils");

var _xcodebuild = _interopRequireDefault(require("./xcodebuild"));

var _iproxy = _interopRequireDefault(require("./iproxy"));

var _teen_process = require("teen_process");

const BOOTSTRAP_PATH = _path.default.resolve(__dirname, '..', '..', '..', 'WebDriverAgent');

exports.BOOTSTRAP_PATH = BOOTSTRAP_PATH;
const WDA_BUNDLE_ID = 'com.apple.test.WebDriverAgentRunner-Runner';
exports.WDA_BUNDLE_ID = WDA_BUNDLE_ID;
const WDA_LAUNCH_TIMEOUT = 60 * 1000;
const WDA_AGENT_PORT = 8100;
const WDA_BASE_URL = 'http://localhost';

class WebDriverAgent {
  constructor(xcodeVersion, args = {}) {
    this.xcodeVersion = xcodeVersion;
    this.args = _lodash.default.clone(args);
    this.device = args.device;
    this.platformVersion = args.platformVersion;
    this.host = args.host;
    this.realDevice = !!args.realDevice;
    this.setWDAPaths(args.bootstrapPath, args.agentPath);
    this.wdaLocalPort = args.wdaLocalPort;
    this.prebuildWDA = args.prebuildWDA;
    this.webDriverAgentUrl = args.webDriverAgentUrl;
    this.started = false;
    this.wdaConnectionTimeout = args.wdaConnectionTimeout;
    this.useCarthageSsl = _lodash.default.isBoolean(args.useCarthageSsl) && args.useCarthageSsl;
    this.useXctestrunFile = args.useXctestrunFile;
    this.xcodebuild = new _xcodebuild.default(this.xcodeVersion, this.device, {
      platformVersion: this.platformVersion,
      agentPath: this.agentPath,
      bootstrapPath: this.bootstrapPath,
      realDevice: this.realDevice,
      showXcodeLog: !!args.showXcodeLog,
      xcodeConfigFile: args.xcodeConfigFile,
      xcodeOrgId: args.xcodeOrgId,
      xcodeSigningId: args.xcodeSigningId,
      keychainPath: args.keychainPath,
      keychainPassword: args.keychainPassword,
      useSimpleBuildTest: args.useSimpleBuildTest,
      usePrebuiltWDA: args.usePrebuiltWDA,
      updatedWDABundleId: args.updatedWDABundleId,
      launchTimeout: args.wdaLaunchTimeout || WDA_LAUNCH_TIMEOUT,
      wdaRemotePort: this.realDevice ? WDA_AGENT_PORT : this.wdaLocalPort || WDA_AGENT_PORT,
      useXctestrunFile: this.useXctestrunFile,
      derivedDataPath: args.derivedDataPath,
      mjpegServerPort: args.mjpegServerPort
    });
  }

  setWDAPaths(bootstrapPath, agentPath) {
    this.bootstrapPath = bootstrapPath || BOOTSTRAP_PATH;

    _logger.default.info(`Using WDA path: '${this.bootstrapPath}'`);

    this.agentPath = agentPath || _path.default.resolve(this.bootstrapPath, 'WebDriverAgent.xcodeproj');

    _logger.default.info(`Using WDA agent: '${this.agentPath}'`);
  }

  async cleanupObsoleteProcesses() {
    const pids = await (0, _utils2.getPIDsListeningOnPort)(this.url.port, cmdLine => (cmdLine.includes('/WebDriverAgentRunner') || cmdLine.includes('/iproxy')) && !cmdLine.toLowerCase().includes(this.device.udid.toLowerCase()));

    if (!pids.length) {
      _logger.default.debug(`No obsolete cached processes from previous WDA sessions ` + `listening on port ${this.url.port} have been found`);

      return;
    }

    _logger.default.info(`Detected ${pids.length} obsolete cached process${pids.length === 1 ? '' : 'es'} ` + `from previous WDA sessions. Cleaning up...`);

    try {
      await (0, _teen_process.exec)('kill', pids);
    } catch (e) {
      _logger.default.warn(`Failed to kill obsolete cached process${pids.length === 1 ? '' : 'es'} '${pids}'. ` + `Original error: ${e.message}`);
    }
  }

  async isRunning() {
    return !!(await this.getStatus());
  }

  async getStatus() {
    const noSessionProxy = new _noSessionProxy.NoSessionProxy({
      server: this.url.hostname,
      port: this.url.port,
      base: '',
      timeout: 3000
    });

    try {
      return await noSessionProxy.command('/status', 'GET');
    } catch (err) {
      _logger.default.debug(`WDA is not listening at '${this.url.href}'`);

      return null;
    }
  }

  async uninstall() {
    _logger.default.debug(`Removing WDA application from device`);

    try {
      await this.device.removeApp(WDA_BUNDLE_ID);
    } catch (e) {
      _logger.default.warn(`WebDriverAgent uninstall failed. Perhaps, it is already uninstalled? Original error: ${JSON.stringify(e)}`);
    }
  }

  async launch(sessionId) {
    if (this.webDriverAgentUrl) {
      _logger.default.info(`Using provided WebdriverAgent at '${this.webDriverAgentUrl}'`);

      this.url = this.webDriverAgentUrl;
      this.setupProxies(sessionId);
      return;
    }

    _logger.default.info('Launching WebDriverAgent on the device');

    this.setupProxies(sessionId);

    if (!this.useXctestrunFile && !(await _appiumSupport.fs.exists(this.agentPath))) {
      throw new Error(`Trying to use WebDriverAgent project at '${this.agentPath}' but the ` + 'file does not exist');
    }

    if (!this.useXctestrunFile) {
      const didPerformUpgrade = await (0, _utils.checkForDependencies)(this.bootstrapPath, this.useCarthageSsl);

      if (didPerformUpgrade) {
        await this.xcodebuild.cleanProject();
      }
    }

    await (0, _utils2.resetXCTestProcesses)(this.device.udid, !this.realDevice, {
      wdaLocalPort: this.url.port
    });

    if (this.realDevice) {
      this.iproxy = new _iproxy.default(this.device.udid, this.url.port, WDA_AGENT_PORT);
      await this.iproxy.start();
    }

    await this.xcodebuild.init(this.noSessionProxy);

    if (this.prebuildWDA) {
      await this.xcodebuild.prebuild();
    }

    return await this.xcodebuild.start();
  }

  setupProxies(sessionId) {
    const proxyOpts = {
      server: this.url.hostname,
      port: this.url.port,
      base: '',
      timeout: this.wdaConnectionTimeout
    };
    this.jwproxy = new _appiumBaseDriver.JWProxy(proxyOpts);
    this.jwproxy.sessionId = sessionId;
    this.proxyReqRes = this.jwproxy.proxyReqRes.bind(this.jwproxy);
    this.noSessionProxy = new _noSessionProxy.NoSessionProxy(proxyOpts);
    this.noSessionProxyReqRes = this.noSessionProxy.proxyReqRes.bind(this.noSessionProxy);
  }

  async quit() {
    _logger.default.info('Shutting down sub-processes');

    if (this.iproxy) {
      await this.iproxy.quit();
    }

    await this.xcodebuild.quit();
    await this.xcodebuild.reset();

    if (this.jwproxy) {
      this.jwproxy.sessionId = null;
    }

    this.started = false;

    if (!this.args.webDriverAgentUrl) {
      this.webDriverAgentUrl = null;
    }
  }

  get url() {
    if (!this._url) {
      let port = this.wdaLocalPort || WDA_AGENT_PORT;
      this._url = _url2.default.parse(`${WDA_BASE_URL}:${port}`);
    }

    return this._url;
  }

  set url(_url) {
    this._url = _url2.default.parse(_url);
  }

  get fullyStarted() {
    return this.started;
  }

  set fullyStarted(started = false) {
    this.started = started;

    if (this.iproxy) {
      this.iproxy.expectIProxyErrors = !started;
    }
  }

  async retrieveDerivedDataPath() {
    return await this.xcodebuild.retrieveDerivedDataPath();
  }

  async setupCaching(updatedWDABundleId) {
    const status = await this.getStatus();

    if (!status || !status.build) {
      _logger.default.debug('WDA is currently not running. There is nothing to cache');

      return;
    }

    const {
      productBundleIdentifier,
      upgradedAt
    } = status.build;

    if (_appiumSupport.util.hasValue(productBundleIdentifier) && _appiumSupport.util.hasValue(updatedWDABundleId) && updatedWDABundleId !== productBundleIdentifier) {
      _logger.default.info(`Will uninstall running WDA since it has different bundle id. The actual value is '${productBundleIdentifier}'.`);

      return await this.uninstall();
    }

    if (_appiumSupport.util.hasValue(productBundleIdentifier) && !_appiumSupport.util.hasValue(updatedWDABundleId) && _utils.WDA_RUNNER_BUNDLE_ID !== productBundleIdentifier) {
      _logger.default.info(`Will uninstall running WDA since its bundle id is not equal to the default value ${_utils.WDA_RUNNER_BUNDLE_ID}`);

      return await this.uninstall();
    }

    const actualUpgradeTimestamp = await (0, _utils.getWDAUpgradeTimestamp)(this.bootstrapPath);

    _logger.default.debug(`Upgrade timestamp of the currently bundled WDA: ${actualUpgradeTimestamp}`);

    _logger.default.debug(`Upgrade timestamp of the WDA on the device: ${upgradedAt}`);

    if (actualUpgradeTimestamp && upgradedAt && _lodash.default.toLower(`${actualUpgradeTimestamp}`) !== _lodash.default.toLower(`${upgradedAt}`)) {
      _logger.default.info('Will uninstall running WDA since it has different version in comparison to the one ' + `which is bundled with appium-xcuitest-driver module (${actualUpgradeTimestamp} != ${upgradedAt})`);

      return await this.uninstall();
    }

    const message = _appiumSupport.util.hasValue(productBundleIdentifier) ? `Will reuse previously cached WDA instance at '${this.url.href}' with '${productBundleIdentifier}'` : `Will reuse previously cached WDA instance at '${this.url.href}'`;

    _logger.default.info(`${message}. Set the wdaLocalPort capability to a value different from ${this.url.port} if this is an undesired behavior.`);

    this.webDriverAgentUrl = this.url.href;
  }

  async quitAndUninstall() {
    await this.quit();
    await this.uninstall();
  }

}

exports.WebDriverAgent = WebDriverAgent;
var _default = WebDriverAgent;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi93ZGEvd2ViZHJpdmVyYWdlbnQuanMiXSwibmFtZXMiOlsiQk9PVFNUUkFQX1BBVEgiLCJwYXRoIiwicmVzb2x2ZSIsIl9fZGlybmFtZSIsIldEQV9CVU5ETEVfSUQiLCJXREFfTEFVTkNIX1RJTUVPVVQiLCJXREFfQUdFTlRfUE9SVCIsIldEQV9CQVNFX1VSTCIsIldlYkRyaXZlckFnZW50IiwiY29uc3RydWN0b3IiLCJ4Y29kZVZlcnNpb24iLCJhcmdzIiwiXyIsImNsb25lIiwiZGV2aWNlIiwicGxhdGZvcm1WZXJzaW9uIiwiaG9zdCIsInJlYWxEZXZpY2UiLCJzZXRXREFQYXRocyIsImJvb3RzdHJhcFBhdGgiLCJhZ2VudFBhdGgiLCJ3ZGFMb2NhbFBvcnQiLCJwcmVidWlsZFdEQSIsIndlYkRyaXZlckFnZW50VXJsIiwic3RhcnRlZCIsIndkYUNvbm5lY3Rpb25UaW1lb3V0IiwidXNlQ2FydGhhZ2VTc2wiLCJpc0Jvb2xlYW4iLCJ1c2VYY3Rlc3RydW5GaWxlIiwieGNvZGVidWlsZCIsIlhjb2RlQnVpbGQiLCJzaG93WGNvZGVMb2ciLCJ4Y29kZUNvbmZpZ0ZpbGUiLCJ4Y29kZU9yZ0lkIiwieGNvZGVTaWduaW5nSWQiLCJrZXljaGFpblBhdGgiLCJrZXljaGFpblBhc3N3b3JkIiwidXNlU2ltcGxlQnVpbGRUZXN0IiwidXNlUHJlYnVpbHRXREEiLCJ1cGRhdGVkV0RBQnVuZGxlSWQiLCJsYXVuY2hUaW1lb3V0Iiwid2RhTGF1bmNoVGltZW91dCIsIndkYVJlbW90ZVBvcnQiLCJkZXJpdmVkRGF0YVBhdGgiLCJtanBlZ1NlcnZlclBvcnQiLCJsb2ciLCJpbmZvIiwiY2xlYW51cE9ic29sZXRlUHJvY2Vzc2VzIiwicGlkcyIsInVybCIsInBvcnQiLCJjbWRMaW5lIiwiaW5jbHVkZXMiLCJ0b0xvd2VyQ2FzZSIsInVkaWQiLCJsZW5ndGgiLCJkZWJ1ZyIsImUiLCJ3YXJuIiwibWVzc2FnZSIsImlzUnVubmluZyIsImdldFN0YXR1cyIsIm5vU2Vzc2lvblByb3h5IiwiTm9TZXNzaW9uUHJveHkiLCJzZXJ2ZXIiLCJob3N0bmFtZSIsImJhc2UiLCJ0aW1lb3V0IiwiY29tbWFuZCIsImVyciIsImhyZWYiLCJ1bmluc3RhbGwiLCJyZW1vdmVBcHAiLCJKU09OIiwic3RyaW5naWZ5IiwibGF1bmNoIiwic2Vzc2lvbklkIiwic2V0dXBQcm94aWVzIiwiZnMiLCJleGlzdHMiLCJFcnJvciIsImRpZFBlcmZvcm1VcGdyYWRlIiwiY2xlYW5Qcm9qZWN0IiwiaXByb3h5IiwiaVByb3h5Iiwic3RhcnQiLCJpbml0IiwicHJlYnVpbGQiLCJwcm94eU9wdHMiLCJqd3Byb3h5IiwiSldQcm94eSIsInByb3h5UmVxUmVzIiwiYmluZCIsIm5vU2Vzc2lvblByb3h5UmVxUmVzIiwicXVpdCIsInJlc2V0IiwiX3VybCIsInBhcnNlIiwiZnVsbHlTdGFydGVkIiwiZXhwZWN0SVByb3h5RXJyb3JzIiwicmV0cmlldmVEZXJpdmVkRGF0YVBhdGgiLCJzZXR1cENhY2hpbmciLCJzdGF0dXMiLCJidWlsZCIsInByb2R1Y3RCdW5kbGVJZGVudGlmaWVyIiwidXBncmFkZWRBdCIsInV0aWwiLCJoYXNWYWx1ZSIsIldEQV9SVU5ORVJfQlVORExFX0lEIiwiYWN0dWFsVXBncmFkZVRpbWVzdGFtcCIsInRvTG93ZXIiLCJxdWl0QW5kVW5pbnN0YWxsIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUdBLE1BQU1BLGNBQWMsR0FBR0MsY0FBS0MsT0FBTCxDQUFhQyxTQUFiLEVBQXdCLElBQXhCLEVBQThCLElBQTlCLEVBQW9DLElBQXBDLEVBQTBDLGdCQUExQyxDQUF2Qjs7O0FBQ0EsTUFBTUMsYUFBYSxHQUFHLDRDQUF0Qjs7QUFDQSxNQUFNQyxrQkFBa0IsR0FBRyxLQUFLLElBQWhDO0FBQ0EsTUFBTUMsY0FBYyxHQUFHLElBQXZCO0FBQ0EsTUFBTUMs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QVUsR0FBRWEsT0FBUSwrREFBOEQsS0FBS1YsR0FBTCxDQUFTQyxJQUFLLG9DQUFoRzs7QUFDQSxTQUFLM0IsaUJBQUwsR0FBeUIsS0FBSzBCLEdBQUwsQ0FBU3FCLElBQWxDO0FBQ0Q7O0FBRUQsUUFBTXlDLGdCQUFOLEdBQTBCO0FBQ3hCLFVBQU0sS0FBS2pCLElBQUwsRUFBTjtBQUNBLFVBQU0sS0FBS3ZCLFNBQUwsRUFBTjtBQUNEOztBQXJTa0I7OztlQXdTTi9ELGMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgdXJsIGZyb20gJ3VybCc7XG5pbXBvcnQgeyBKV1Byb3h5IH0gZnJvbSAnYXBwaXVtLWJhc2UtZHJpdmVyJztcbmltcG9ydCB7IGZzLCB1dGlsIH0gZnJvbSAnYXBwaXVtLXN1cHBvcnQnO1xuaW1wb3J0IGxvZyBmcm9tICcuLi9sb2dnZXInO1xuaW1wb3J0IHsgTm9TZXNzaW9uUHJveHkgfSBmcm9tICcuL25vLXNlc3Npb24tcHJveHknO1xuaW1wb3J0IHsgY2hlY2tGb3JEZXBlbmRlbmNpZXMsIFdEQV9SVU5ORVJfQlVORExFX0lELCBnZXRXREFVcGdyYWRlVGltZXN0YW1wIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyByZXNldFhDVGVzdFByb2Nlc3NlcywgZ2V0UElEc0xpc3RlbmluZ09uUG9ydCB9IGZyb20gJy4uL3V0aWxzJztcbmltcG9ydCBYY29kZUJ1aWxkIGZyb20gJy4veGNvZGVidWlsZCc7XG5pbXBvcnQgaVByb3h5IGZyb20gJy4vaXByb3h5JztcbmltcG9ydCB7IGV4ZWMgfSBmcm9tICd0ZWVuX3Byb2Nlc3MnO1xuXG5cbmNvbnN0IEJPT1RTVFJBUF9QQVRIID0gcGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgJy4uJywgJy4uJywgJy4uJywgJ1dlYkRyaXZlckFnZW50Jyk7XG5jb25zdCBXREFfQlVORExFX0lEID0gJ2NvbS5hcHBsZS50ZXN0LldlYkRyaXZlckFnZW50UnVubmVyLVJ1bm5lcic7XG5jb25zdCBXREFfTEFVTkNIX1RJTUVPVVQgPSA2MCAqIDEwMDA7XG5jb25zdCBXREFfQUdFTlRfUE9SVCA9IDgxMDA7XG5jb25zdCBXREFfQkFTRV9VUkwgPSAnaHR0cDovL2xvY2FsaG9zdCc7XG5cblxuY2xhc3MgV2ViRHJpdmVyQWdlbnQge1xuICBjb25zdHJ1Y3RvciAoeGNvZGVWZXJzaW9uLCBhcmdzID0ge30pIHtcbiAgICB0aGlzLnhjb2RlVmVyc2lvbiA9IHhjb2RlVmVyc2lvbjtcblxuICAgIHRoaXMuYXJncyA9IF8uY2xvbmUoYXJncyk7XG5cbiAgICB0aGlzLmRldmljZSA9IGFyZ3MuZGV2aWNlO1xuICAgIHRoaXMucGxhdGZvcm1WZXJzaW9uID0gYXJncy5wbGF0Zm9ybVZlcnNpb247XG4gICAgdGhpcy5ob3N0ID0gYXJncy5ob3N0O1xuICAgIHRoaXMucmVhbERldmljZSA9ICEhYXJncy5yZWFsRGV2aWNlO1xuXG4gICAgdGhpcy5zZXRXREFQYXRocyhhcmdzLmJvb3RzdHJhcFBhdGgsIGFyZ3MuYWdlbnRQYXRoKTtcblxuICAgIHRoaXMud2RhTG9jYWxQb3J0ID0gYXJncy53ZGFMb2NhbFBvcnQ7XG5cbiAgICB0aGlzLnByZWJ1aWxkV0RBID0gYXJncy5wcmVidWlsZFdEQTtcblxuICAgIHRoaXMud2ViRHJpdmVyQWdlbnRVcmwgPSBhcmdzLndlYkRyaXZlckFnZW50VXJsO1xuXG4gICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG5cbiAgICB0aGlzLndkYUNvbm5lY3Rpb25UaW1lb3V0ID0gYXJncy53ZGFDb25uZWN0aW9uVGltZW91dDtcblxuICAgIHRoaXMudXNlQ2FydGhhZ2VTc2wgPSBfLmlzQm9vbGVhbihhcmdzLnVzZUNhcnRoYWdlU3NsKSAmJiBhcmdzLnVzZUNhcnRoYWdlU3NsO1xuXG4gICAgdGhpcy51c2VYY3Rlc3RydW5GaWxlID0gYXJncy51c2VYY3Rlc3RydW5GaWxlO1xuXG4gICAgdGhpcy54Y29kZWJ1aWxkID0gbmV3IFhjb2RlQnVpbGQodGhpcy54Y29kZVZlcnNpb24sIHRoaXMuZGV2aWNlLCB7XG4gICAgICBwbGF0Zm9ybVZlcnNpb246IHRoaXMucGxhdGZvcm1WZXJzaW9uLFxuICAgICAgYWdlbnRQYXRoOiB0aGlzLmFnZW50UGF0aCxcbiAgICAgIGJvb3RzdHJhcFBhdGg6IHRoaXMuYm9vdHN0cmFwUGF0aCxcbiAgICAgIHJlYWxEZXZpY2U6IHRoaXMucmVhbERldmljZSxcbiAgICAgIHNob3dYY29kZUxvZzogISFhcmdzLnNob3dYY29kZUxvZyxcbiAgICAgIHhjb2RlQ29uZmlnRmlsZTogYXJncy54Y29kZUNvbmZpZ0ZpbGUsXG4gICAgICB4Y29kZU9yZ0lkOiBhcmdzLnhjb2RlT3JnSWQsXG4gICAgICB4Y29kZVNpZ25pbmdJZDogYXJncy54Y29kZVNpZ25pbmdJZCxcbiAgICAgIGtleWNoYWluUGF0aDogYXJncy5rZXljaGFpblBhdGgsXG4gICAgICBrZXljaGFpblBhc3N3b3JkOiBhcmdzLmtleWNoYWluUGFzc3dvcmQsXG4gICAgICB1c2VTaW1wbGVCdWlsZFRlc3Q6IGFyZ3MudXNlU2ltcGxlQnVpbGRUZXN0LFxuICAgICAgdXNlUHJlYnVpbHRXREE6IGFyZ3MudXNlUHJlYnVpbHRXREEsXG4gICAgICB1cGRhdGVkV0RBQnVuZGxlSWQ6IGFyZ3MudXBkYXRlZFdEQUJ1bmRsZUlkLFxuICAgICAgbGF1bmNoVGltZW91dDogYXJncy53ZGFMYXVuY2hUaW1lb3V0IHx8IFdEQV9MQVVOQ0hfVElNRU9VVCxcbiAgICAgIHdkYVJlbW90ZVBvcnQ6IHRoaXMucmVhbERldmljZSA/IFdEQV9BR0VOVF9QT1JUIDogKHRoaXMud2RhTG9jYWxQb3J0IHx8IFdEQV9BR0VOVF9QT1JUKSxcbiAgICAgIHVzZVhjdGVzdHJ1bkZpbGU6IHRoaXMudXNlWGN0ZXN0cnVuRmlsZSxcbiAgICAgIGRlcml2ZWREYXRhUGF0aDogYXJncy5kZXJpdmVkRGF0YVBhdGgsXG4gICAgICBtanBlZ1NlcnZlclBvcnQ6IGFyZ3MubWpwZWdTZXJ2ZXJQb3J0LFxuICAgIH0pO1xuICB9XG5cbiAgc2V0V0RBUGF0aHMgKGJvb3RzdHJhcFBhdGgsIGFnZW50UGF0aCkge1xuICAgIC8vIGFsbG93IHRoZSB1c2VyIHRvIHNwZWNpZnkgYSBwbGFjZSBmb3IgV0RBLiBUaGlzIGlzIHVuZG9jdW1lbnRlZCBhbmRcbiAgICAvLyBvbmx5IGhlcmUgZm9yIHRoZSBwdXJwb3NlcyBvZiB0ZXN0aW5nIGRldmVsb3BtZW50IG9mIFdEQVxuICAgIHRoaXMuYm9vdHN0cmFwUGF0aCA9IGJvb3RzdHJhcFBhdGggfHwgQk9PVFNUUkFQX1BBVEg7XG4gICAgbG9nLmluZm8oYFVzaW5nIFdEQSBwYXRoOiAnJHt0aGlzLmJvb3RzdHJhcFBhdGh9J2ApO1xuXG4gICAgLy8gZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkgd2UgbmVlZCB0byBiZSBhYmxlIHRvIHNwZWNpZnkgYWdlbnRQYXRoIHRvb1xuICAgIHRoaXMuYWdlbnRQYXRoID0gYWdlbnRQYXRoIHx8IHBhdGgucmVzb2x2ZSh0aGlzLmJvb3RzdHJhcFBhdGgsICdXZWJEcml2ZXJBZ2VudC54Y29kZXByb2onKTtcbiAgICBsb2cuaW5mbyhgVXNpbmcgV0RBIGFnZW50OiAnJHt0aGlzLmFnZW50UGF0aH0nYCk7XG4gIH1cblxuICBhc3luYyBjbGVhbnVwT2Jzb2xldGVQcm9jZXNzZXMgKCkge1xuICAgIGNvbnN0IHBpZHMgPSBhd2FpdCBnZXRQSURzTGlzdGVuaW5nT25Qb3J0KHRoaXMudXJsLnBvcnQsXG4gICAgICAoY21kTGluZSkgPT4gKGNtZExpbmUuaW5jbHVkZXMoJy9XZWJEcml2ZXJBZ2VudFJ1bm5lcicpIHx8IGNtZExpbmUuaW5jbHVkZXMoJy9pcHJveHknKSkgJiZcbiAgICAgICAgIWNtZExpbmUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyh0aGlzLmRldmljZS51ZGlkLnRvTG93ZXJDYXNlKCkpKTtcbiAgICBpZiAoIXBpZHMubGVuZ3RoKSB7XG4gICAgICBsb2cuZGVidWcoYE5vIG9ic29sZXRlIGNhY2hlZCBwcm9jZXNzZXMgZnJvbSBwcmV2aW91cyBXREEgc2Vzc2lvbnMgYCArXG4gICAgICAgICAgICAgICAgYGxpc3RlbmluZyBvbiBwb3J0ICR7dGhpcy51cmwucG9ydH0gaGF2ZSBiZWVuIGZvdW5kYCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgbG9nLmluZm8oYERldGVjdGVkICR7cGlkcy5sZW5ndGh9IG9ic29sZXRlIGNhY2hlZCBwcm9jZXNzJHtwaWRzLmxlbmd0aCA9PT0gMSA/ICcnIDogJ2VzJ30gYCArXG4gICAgICAgICAgICAgYGZyb20gcHJldmlvdXMgV0RBIHNlc3Npb25zLiBDbGVhbmluZyB1cC4uLmApO1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBleGVjKCdraWxsJywgcGlkcyk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgbG9nLndhcm4oYEZhaWxlZCB0byBraWxsIG9ic29sZXRlIGNhY2hlZCBwcm9jZXNzJHtwaWRzLmxlbmd0aCA9PT0gMSA/ICcnIDogJ2VzJ30gJyR7cGlkc30nLiBgICtcbiAgICAgICAgICAgICAgIGBPcmlnaW5hbCBlcnJvcjogJHtlLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiBib29sZWFuIGlmIFdEQSBpcyBydW5uaW5nIG9yIG5vdFxuICAgKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIFdEQSBpcyBydW5uaW5nXG4gICAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGVyZSB3YXMgaW52YWxpZCByZXNwb25zZSBjb2RlIG9yIGJvZHlcbiAgICovXG4gIGFzeW5jIGlzUnVubmluZyAoKSB7XG4gICAgcmV0dXJuICEhKGF3YWl0IHRoaXMuZ2V0U3RhdHVzKCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiBjdXJyZW50IHJ1bm5pbmcgV0RBJ3Mgc3RhdHVzIGxpa2UgYmVsb3dcbiAgICoge1xuICAgKiAgIFwic3RhdGVcIjogXCJzdWNjZXNzXCIsXG4gICAqICAgXCJvc1wiOiB7XG4gICAqICAgICBcIm5hbWVcIjogXCJpT1NcIixcbiAgICogICAgIFwidmVyc2lvblwiOiBcIjExLjRcIixcbiAgICogICAgIFwic2RrVmVyc2lvblwiOiBcIjExLjNcIlxuICAgKiAgIH0sXG4gICAqICAgXCJpb3NcIjoge1xuICAgKiAgICAgXCJzaW11bGF0b3JWZXJzaW9uXCI6IFwiMTEuNFwiLFxuICAgKiAgICAgXCJpcFwiOiBcIjE3Mi4yNTQuOTkuMzRcIlxuICAgKiAgIH0sXG4gICAqICAgXCJidWlsZFwiOiB7XG4gICAqICAgICBcInRpbWVcIjogXCJKdW4gMjQgMjAxOCAxNzowODoyMVwiLFxuICAgKiAgICAgXCJwcm9kdWN0QnVuZGxlSWRlbnRpZmllclwiOiBcImNvbS5mYWNlYm9vay5XZWJEcml2ZXJBZ2VudFJ1bm5lclwiXG4gICAqICAgfVxuICAgKiB9XG4gICAqXG4gICAqIEByZXR1cm4gez9vYmplY3R9IFN0YXRlIE9iamVjdFxuICAgKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlcmUgd2FzIGludmFsaWQgcmVzcG9uc2UgY29kZSBvciBib2R5XG4gICAqL1xuICBhc3luYyBnZXRTdGF0dXMgKCkge1xuICAgIGNvbnN0IG5vU2Vzc2lvblByb3h5ID0gbmV3IE5vU2Vzc2lvblByb3h5KHtcbiAgICAgIHNlcnZlcjogdGhpcy51cmwuaG9zdG5hbWUsXG4gICAgICBwb3J0OiB0aGlzLnVybC5wb3J0LFxuICAgICAgYmFzZTogJycsXG4gICAgICB0aW1lb3V0OiAzMDAwLFxuICAgIH0pO1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgbm9TZXNzaW9uUHJveHkuY29tbWFuZCgnL3N0YXR1cycsICdHRVQnKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgV0RBIGlzIG5vdCBsaXN0ZW5pbmcgYXQgJyR7dGhpcy51cmwuaHJlZn0nYCk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cblxuICBhc3luYyB1bmluc3RhbGwgKCkge1xuICAgIGxvZy5kZWJ1ZyhgUmVtb3ZpbmcgV0RBIGFwcGxpY2F0aW9uIGZyb20gZGV2aWNlYCk7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuZGV2aWNlLnJlbW92ZUFwcChXREFfQlVORExFX0lEKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBsb2cud2FybihgV2ViRHJpdmVyQWdlbnQgdW5pbnN0YWxsIGZhaWxlZC4gUGVyaGFwcywgaXQgaXMgYWxyZWFkeSB1bmluc3RhbGxlZD8gT3JpZ2luYWwgZXJyb3I6ICR7SlNPTi5zdHJpbmdpZnkoZSl9YCk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgbGF1bmNoIChzZXNzaW9uSWQpIHtcbiAgICBpZiAodGhpcy53ZWJEcml2ZXJBZ2VudFVybCkge1xuICAgICAgbG9nLmluZm8oYFVzaW5nIHByb3ZpZGVkIFdlYmRyaXZlckFnZW50IGF0ICcke3RoaXMud2ViRHJpdmVyQWdlbnRVcmx9J2ApO1xuICAgICAgdGhpcy51cmwgPSB0aGlzLndlYkRyaXZlckFnZW50VXJsO1xuICAgICAgdGhpcy5zZXR1cFByb3hpZXMoc2Vzc2lvbklkKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBsb2cuaW5mbygnTGF1bmNoaW5nIFdlYkRyaXZlckFnZW50IG9uIHRoZSBkZXZpY2UnKTtcblxuICAgIHRoaXMuc2V0dXBQcm94aWVzKHNlc3Npb25JZCk7XG5cbiAgICBpZiAoIXRoaXMudXNlWGN0ZXN0cnVuRmlsZSAmJiAhYXdhaXQgZnMuZXhpc3RzKHRoaXMuYWdlbnRQYXRoKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBUcnlpbmcgdG8gdXNlIFdlYkRyaXZlckFnZW50IHByb2plY3QgYXQgJyR7dGhpcy5hZ2VudFBhdGh9JyBidXQgdGhlIGAgK1xuICAgICAgICAgICAgICAgICAgICAgICdmaWxlIGRvZXMgbm90IGV4aXN0Jyk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLnVzZVhjdGVzdHJ1bkZpbGUpIHtcbiAgICAgIC8vIG1ha2Ugc3VyZSB0aGF0IHRoZSBXREEgZGVwZW5kZW5jaWVzIGhhdmUgYmVlbiBidWlsdFxuICAgICAgY29uc3QgZGlkUGVyZm9ybVVwZ3JhZGUgPSBhd2FpdCBjaGVja0ZvckRlcGVuZGVuY2llcyh0aGlzLmJvb3RzdHJhcFBhdGgsIHRoaXMudXNlQ2FydGhhZ2VTc2wpO1xuICAgICAgaWYgKGRpZFBlcmZvcm1VcGdyYWRlKSB7XG4gICAgICAgIC8vIE9ubHkgcGVyZm9ybSB0aGUgY2xlYW51cCBhZnRlciBXREEgdXBncmFkZVxuICAgICAgICBhd2FpdCB0aGlzLnhjb2RlYnVpbGQuY2xlYW5Qcm9qZWN0KCk7XG4gICAgICB9XG4gICAgfVxuICAgIC8vIFdlIG5lZWQgdG8gcHJvdmlkZSBXREEgbG9jYWwgcG9ydCwgYmVjYXVzZSBpdCBtaWdodCBiZSBvY2N1cGllZCB3aXRoXG4gICAgLy8gaXByb3h5IGluc3RhbmNlIGluaXRpYXRlZCBieSBzb21lIHByZWNlZWRpbmcgcnVuIHdpdGggYSByZWFsIGRldmljZVxuICAgIC8vIChpcHJveHkgaW5zdGFuY2VzIGFyZSBub3Qga2lsbGVkIG9uIHNlc3Npb24gdGVybWluYXRpb24gYnkgZGVmYXVsdClcbiAgICBhd2FpdCByZXNldFhDVGVzdFByb2Nlc3Nlcyh0aGlzLmRldmljZS51ZGlkLCAhdGhpcy5yZWFsRGV2aWNlLCB7d2RhTG9jYWxQb3J0OiB0aGlzLnVybC5wb3J0fSk7XG5cbiAgICBpZiAodGhpcy5yZWFsRGV2aWNlKSB7XG4gICAgICB0aGlzLmlwcm94eSA9IG5ldyBpUHJveHkodGhpcy5kZXZpY2UudWRpZCwgdGhpcy51cmwucG9ydCwgV0RBX0FHRU5UX1BPUlQpO1xuICAgICAgYXdhaXQgdGhpcy5pcHJveHkuc3RhcnQoKTtcbiAgICB9XG5cbiAgICBhd2FpdCB0aGlzLnhjb2RlYnVpbGQuaW5pdCh0aGlzLm5vU2Vzc2lvblByb3h5KTtcblxuICAgIC8vIFN0YXJ0IHRoZSB4Y29kZWJ1aWxkIHByb2Nlc3NcbiAgICBpZiAodGhpcy5wcmVidWlsZFdEQSkge1xuICAgICAgYXdhaXQgdGhpcy54Y29kZWJ1aWxkLnByZWJ1aWxkKCk7XG4gICAgfVxuICAgIHJldHVybiBhd2FpdCB0aGlzLnhjb2RlYnVpbGQuc3RhcnQoKTtcbiAgfVxuXG4gIHNldHVwUHJveGllcyAoc2Vzc2lvbklkKSB7XG4gICAgY29uc3QgcHJveHlPcHRzID0ge1xuICAgICAgc2VydmVyOiB0aGlzLnVybC5ob3N0bmFtZSxcbiAgICAgIHBvcnQ6IHRoaXMudXJsLnBvcnQsXG4gICAgICBiYXNlOiAnJyxcbiAgICAgIHRpbWVvdXQ6IHRoaXMud2RhQ29ubmVjdGlvblRpbWVvdXQsXG4gICAgfTtcblxuICAgIHRoaXMuandwcm94eSA9IG5ldyBKV1Byb3h5KHByb3h5T3B0cyk7XG4gICAgdGhpcy5qd3Byb3h5LnNlc3Npb25JZCA9IHNlc3Npb25JZDtcbiAgICB0aGlzLnByb3h5UmVxUmVzID0gdGhpcy5qd3Byb3h5LnByb3h5UmVxUmVzLmJpbmQodGhpcy5qd3Byb3h5KTtcblxuICAgIHRoaXMubm9TZXNzaW9uUHJveHkgPSBuZXcgTm9TZXNzaW9uUHJveHkocHJveHlPcHRzKTtcbiAgICB0aGlzLm5vU2Vzc2lvblByb3h5UmVxUmVzID0gdGhpcy5ub1Nlc3Npb25Qcm94eS5wcm94eVJlcVJlcy5iaW5kKHRoaXMubm9TZXNzaW9uUHJveHkpO1xuICB9XG5cbiAgYXN5bmMgcXVpdCAoKSB7XG4gICAgbG9nLmluZm8oJ1NodXR0aW5nIGRvd24gc3ViLXByb2Nlc3NlcycpO1xuXG4gICAgaWYgKHRoaXMuaXByb3h5KSB7XG4gICAgICBhd2FpdCB0aGlzLmlwcm94eS5xdWl0KCk7XG4gICAgfVxuXG4gICAgYXdhaXQgdGhpcy54Y29kZWJ1aWxkLnF1aXQoKTtcbiAgICBhd2FpdCB0aGlzLnhjb2RlYnVpbGQucmVzZXQoKTtcblxuICAgIGlmICh0aGlzLmp3cHJveHkpIHtcbiAgICAgIHRoaXMuandwcm94eS5zZXNzaW9uSWQgPSBudWxsO1xuICAgIH1cblxuICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xuXG4gICAgaWYgKCF0aGlzLmFyZ3Mud2ViRHJpdmVyQWdlbnRVcmwpIHtcbiAgICAgIC8vIGlmIHdlIHBvcHVsYXRlZCB0aGUgdXJsIG91cnNlbHZlcyAoZHVyaW5nIGBzZXR1cENhY2hpbmdgIGNhbGwsIGZvciBpbnN0YW5jZSlcbiAgICAgIC8vIHRoZW4gY2xlYW4gdGhhdCB1cC4gSWYgdGhlIHVybCB3YXMgc3VwcGxpZWQsIHdlIHdhbnQgdG8ga2VlcCBpdFxuICAgICAgdGhpcy53ZWJEcml2ZXJBZ2VudFVybCA9IG51bGw7XG4gICAgfVxuICB9XG5cbiAgZ2V0IHVybCAoKSB7XG4gICAgaWYgKCF0aGlzLl91cmwpIHtcbiAgICAgIGxldCBwb3J0ID0gdGhpcy53ZGFMb2NhbFBvcnQgfHwgV0RBX0FHRU5UX1BPUlQ7XG4gICAgICB0aGlzLl91cmwgPSB1cmwucGFyc2UoYCR7V0RBX0JBU0VfVVJMfToke3BvcnR9YCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl91cmw7XG4gIH1cblxuICBzZXQgdXJsIChfdXJsKSB7XG4gICAgdGhpcy5fdXJsID0gdXJsLnBhcnNlKF91cmwpO1xuICB9XG5cbiAgZ2V0IGZ1bGx5U3RhcnRlZCAoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhcnRlZDtcbiAgfVxuXG4gIHNldCBmdWxseVN0YXJ0ZWQgKHN0YXJ0ZWQgPSBmYWxzZSkge1xuICAgIC8vIGJlZm9yZSBXREEgaXMgc3RhcnRlZCB3ZSBleHBlY3QgZXJyb3JzIGZyb20gaXByb3h5LCBzaW5jZSBpdCBpcyBub3RcbiAgICAvLyBjb21tdW5pY2F0aW5nIHdpdGggYW55dGhpbmcgeWV0XG4gICAgdGhpcy5zdGFydGVkID0gc3RhcnRlZDtcbiAgICBpZiAodGhpcy5pcHJveHkpIHtcbiAgICAgIHRoaXMuaXByb3h5LmV4cGVjdElQcm94eUVycm9ycyA9ICFzdGFydGVkO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHJldHJpZXZlRGVyaXZlZERhdGFQYXRoICgpIHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy54Y29kZWJ1aWxkLnJldHJpZXZlRGVyaXZlZERhdGFQYXRoKCk7XG4gIH1cblxuICAvKipcbiAgICogUmV1c2UgcnVubmluZyBXREEgaWYgaXQgaGFzIHRoZSBzYW1lIGJ1bmRsZSBpZCB3aXRoIHVwZGF0ZWRXREFCdW5kbGVJZC5cbiAgICogT3IgcmV1c2UgaXQgaWYgaXQgaGFzIHRoZSBkZWZhdWx0IGlkIHdpdGhvdXQgdXBkYXRlZFdEQUJ1bmRsZUlkLlxuICAgKiBVbmluc3RhbGwgaXQgaWYgdGhlIG1ldGhvZCBmYWNlcyBhbiBleGNlcHRpb24gZm9yIHRoZSBhYm92ZSBzaXR1YXRpb24uXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB1cGRhdGVkV0RBQnVuZGxlSWQgQnVuZGxlSWQgeW91J2QgbGlrZSB0byB1c2VcbiAgICovXG4gIGFzeW5jIHNldHVwQ2FjaGluZyAodXBkYXRlZFdEQUJ1bmRsZUlkKSB7XG4gICAgY29uc3Qgc3RhdHVzID0gYXdhaXQgdGhpcy5nZXRTdGF0dXMoKTtcbiAgICBpZiAoIXN0YXR1cyB8fCAhc3RhdHVzLmJ1aWxkKSB7XG4gICAgICBsb2cuZGVidWcoJ1dEQSBpcyBjdXJyZW50bHkgbm90IHJ1bm5pbmcuIFRoZXJlIGlzIG5vdGhpbmcgdG8gY2FjaGUnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB7XG4gICAgICBwcm9kdWN0QnVuZGxlSWRlbnRpZmllcixcbiAgICAgIHVwZ3JhZGVkQXQsXG4gICAgfSA9IHN0YXR1cy5idWlsZDtcbiAgICBpZiAodXRpbC5oYXNWYWx1ZShwcm9kdWN0QnVuZGxlSWRlbnRpZmllcikgJiYgdXRpbC5oYXNWYWx1ZSh1cGRhdGVkV0RBQnVuZGxlSWQpICYmIHVwZGF0ZWRXREFCdW5kbGVJZCAhPT0gcHJvZHVjdEJ1bmRsZUlkZW50aWZpZXIpIHtcbiAgICAgIGxvZy5pbmZvKGBXaWxsIHVuaW5zdGFsbCBydW5uaW5nIFdEQSBzaW5jZSBpdCBoYXMgZGlmZmVyZW50IGJ1bmRsZSBpZC4gVGhlIGFjdHVhbCB2YWx1ZSBpcyAnJHtwcm9kdWN0QnVuZGxlSWRlbnRpZmllcn0nLmApO1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMudW5pbnN0YWxsKCk7XG4gICAgfVxuICAgIGlmICh1dGlsLmhhc1ZhbHVlKHByb2R1Y3RCdW5kbGVJZGVudGlmaWVyKSAmJiAhdXRpbC5oYXNWYWx1ZSh1cGRhdGVkV0RBQnVuZGxlSWQpICYmIFdEQV9SVU5ORVJfQlVORExFX0lEICE9PSBwcm9kdWN0QnVuZGxlSWRlbnRpZmllcikge1xuICAgICAgbG9nLmluZm8oYFdpbGwgdW5pbnN0YWxsIHJ1bm5pbmcgV0RBIHNpbmNlIGl0cyBidW5kbGUgaWQgaXMgbm90IGVxdWFsIHRvIHRoZSBkZWZhdWx0IHZhbHVlICR7V0RBX1JVTk5FUl9CVU5ETEVfSUR9YCk7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy51bmluc3RhbGwoKTtcbiAgICB9XG5cbiAgICBjb25zdCBhY3R1YWxVcGdyYWRlVGltZXN0YW1wID0gYXdhaXQgZ2V0V0RBVXBncmFkZVRpbWVzdGFtcCh0aGlzLmJvb3RzdHJhcFBhdGgpO1xuICAgIGxvZy5kZWJ1ZyhgVXBncmFkZSB0aW1lc3RhbXAgb2YgdGhlIGN1cnJlbnRseSBidW5kbGVkIFdEQTogJHthY3R1YWxVcGdyYWRlVGltZXN0YW1wfWApO1xuICAgIGxvZy5kZWJ1ZyhgVXBncmFkZSB0aW1lc3RhbXAgb2YgdGhlIFdEQSBvbiB0aGUgZGV2aWNlOiAke3VwZ3JhZGVkQXR9YCk7XG4gICAgaWYgKGFjdHVhbFVwZ3JhZGVUaW1lc3RhbXAgJiYgdXBncmFkZWRBdCAmJiBfLnRvTG93ZXIoYCR7YWN0dWFsVXBncmFkZVRpbWVzdGFtcH1gKSAhPT0gXy50b0xvd2VyKGAke3VwZ3JhZGVkQXR9YCkpIHtcbiAgICAgIGxvZy5pbmZvKCdXaWxsIHVuaW5zdGFsbCBydW5uaW5nIFdEQSBzaW5jZSBpdCBoYXMgZGlmZmVyZW50IHZlcnNpb24gaW4gY29tcGFyaXNvbiB0byB0aGUgb25lICcgK1xuICAgICAgICBgd2hpY2ggaXMgYnVuZGxlZCB3aXRoIGFwcGl1bS14Y3VpdGVzdC1kcml2ZXIgbW9kdWxlICgke2FjdHVhbFVwZ3JhZGVUaW1lc3RhbXB9ICE9ICR7dXBncmFkZWRBdH0pYCk7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy51bmluc3RhbGwoKTtcbiAgICB9XG5cbiAgICBjb25zdCBtZXNzYWdlID0gdXRpbC5oYXNWYWx1ZShwcm9kdWN0QnVuZGxlSWRlbnRpZmllcilcbiAgICAgID8gYFdpbGwgcmV1c2UgcHJldmlvdXNseSBjYWNoZWQgV0RBIGluc3RhbmNlIGF0ICcke3RoaXMudXJsLmhyZWZ9JyB3aXRoICcke3Byb2R1Y3RCdW5kbGVJZGVudGlmaWVyfSdgXG4gICAgICA6IGBXaWxsIHJldXNlIHByZXZpb3VzbHkgY2FjaGVkIFdEQSBpbnN0YW5jZSBhdCAnJHt0aGlzLnVybC5ocmVmfSdgO1xuICAgIGxvZy5pbmZvKGAke21lc3NhZ2V9LiBTZXQgdGhlIHdkYUxvY2FsUG9ydCBjYXBhYmlsaXR5IHRvIGEgdmFsdWUgZGlmZmVyZW50IGZyb20gJHt0aGlzLnVybC5wb3J0fSBpZiB0aGlzIGlzIGFuIHVuZGVzaXJlZCBiZWhhdmlvci5gKTtcbiAgICB0aGlzLndlYkRyaXZlckFnZW50VXJsID0gdGhpcy51cmwuaHJlZjtcbiAgfVxuXG4gIGFzeW5jIHF1aXRBbmRVbmluc3RhbGwgKCkge1xuICAgIGF3YWl0IHRoaXMucXVpdCgpO1xuICAgIGF3YWl0IHRoaXMudW5pbnN0YWxsKCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgV2ViRHJpdmVyQWdlbnQ7XG5leHBvcnQgeyBXZWJEcml2ZXJBZ2VudCwgV0RBX0JVTkRMRV9JRCwgQk9PVFNUUkFQX1BBVEggfTtcbiJdLCJmaWxlIjoibGliL3dkYS93ZWJkcml2ZXJhZ2VudC5qcyIsInNvdXJjZVJvb3QiOiIuLi8uLi8uLiJ9

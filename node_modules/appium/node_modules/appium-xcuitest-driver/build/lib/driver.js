"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.XCUITestDriver = exports.default = void 0;

require("source-map-support/register");

var _appiumBaseDriver = require("appium-base-driver");

var _appiumSupport = require("appium-support");

var _lodash = _interopRequireDefault(require("lodash"));

var _url = _interopRequireDefault(require("url"));

var _nodeSimctl = require("node-simctl");

var _webdriveragent = _interopRequireDefault(require("./wda/webdriveragent"));

var _logger = _interopRequireDefault(require("./logger"));

var _simulatorManagement = require("./simulator-management");

var _appiumIosSimulator = require("appium-ios-simulator");

var _asyncbox = require("asyncbox");

var _appiumIosDriver = require("appium-ios-driver");

var _desiredCaps = _interopRequireDefault(require("./desired-caps"));

var _index = _interopRequireDefault(require("./commands/index"));

var _utils = require("./utils");

var _realDeviceManagement = require("./real-device-management");

var _bluebird = _interopRequireDefault(require("bluebird"));

var _asyncLock = _interopRequireDefault(require("async-lock"));

const SAFARI_BUNDLE_ID = 'com.apple.mobilesafari';
const WDA_SIM_STARTUP_RETRIES = 2;
const WDA_REAL_DEV_STARTUP_RETRIES = 1;
const WDA_REAL_DEV_TUTORIAL_URL = 'https://github.com/appium/appium-xcuitest-driver/blob/master/docs/real-device-config.md';
const WDA_STARTUP_RETRY_INTERVAL = 10000;
const DEFAULT_SETTINGS = {
  nativeWebTap: false,
  useJSONSource: false,
  shouldUseCompactResponses: true,
  elementResponseAttributes: 'type,label',
  mjpegServerScreenshotQuality: 25,
  mjpegServerFramerate: 10,
  screenshotQuality: 1
};
const SHARED_RESOURCES_GUARD = new _asyncLock.default();
const NO_PROXY_NATIVE_LIST = [['DELETE', /window/], ['GET', /^\/session\/[^\/]+$/], ['GET', /alert_text/], ['GET', /alert\/[^\/]+/], ['GET', /appium/], ['GET', /attribute/], ['GET', /context/], ['GET', /location/], ['GET', /log/], ['GET', /screenshot/], ['GET', /size/], ['GET', /source/], ['GET', /url/], ['GET', /window/], ['POST', /accept_alert/], ['POST', /actions$/], ['POST', /alert_text/], ['POST', /alert\/[^\/]+/], ['POST', /appium/], ['POST', /appium\/device\/is_locked/], ['POST', /appium\/device\/lock/], ['POST', /appium\/device\/unlock/], ['POST', /back/], ['POST', /clear/], ['POST', /context/], ['POST', /dismiss_alert/], ['POST', /element$/], ['POST', /elements$/], ['POST', /execute/], ['POST', /keys/], ['POST', /log/], ['POST', /moveto/], ['POST', /receive_async_response/], ['POST', /session\/[^\/]+\/location/], ['POST', /shake/], ['POST', /timeouts/], ['POST', /touch/], ['POST', /url/], ['POST', /value/], ['POST', /window/]];
const NO_PROXY_WEB_LIST = [['DELETE', /cookie/], ['GET', /attribute/], ['GET', /cookie/], ['GET', /element/], ['GET', /text/], ['GET', /title/], ['POST', /clear/], ['POST', /click/], ['POST', /cookie/], ['POST', /element/], ['POST', /forward/], ['POST', /frame/], ['POST', /keys/], ['POST', /refresh/]].concat(NO_PROXY_NATIVE_LIST);
const MEMOIZED_FUNCTIONS = ['getStatusBarHeight', 'getDevicePixelRatio', 'getScreenInfo', 'getSafariIsIphone', 'getSafariIsIphoneX'];

class XCUITestDriver extends _appiumBaseDriver.BaseDriver {
  constructor(opts = {}, shouldValidateCaps = true) {
    super(opts, shouldValidateCaps);
    this.desiredCapConstraints = _desiredCaps.default;
    this.locatorStrategies = ['xpath', 'id', 'name', 'class name', '-ios predicate string', '-ios class chain', 'accessibility id'];
    this.webLocatorStrategies = ['link text', 'css selector', 'tag name', 'link text', 'partial link text'];
    this.resetIos();
    this.settings = new _appiumBaseDriver.DeviceSettings(DEFAULT_SETTINGS, this.onSettingsUpdate.bind(this));
    this.logs = {};

    for (const fn of MEMOIZED_FUNCTIONS) {
      this[fn] = _lodash.default.memoize(this[fn]);
    }
  }

  async onSettingsUpdate(key, value) {
    if (key !== 'nativeWebTap') {
      return await this.proxyCommand('/appium/settings', 'POST', {
        settings: {
          [key]: value
        }
      });
    }

    this.opts.nativeWebTap = !!value;
  }

  resetIos() {
    this.opts = this.opts || {};
    this.wda = null;
    this.opts.device = null;
    this.jwpProxyActive = false;
    this.proxyReqRes = null;
    this.jwpProxyAvoid = [];
    this.safari = false;
    this.cachedWdaStatus = null;
    this.curWebFrames = [];
    this.webElementIds = [];
    this._currentUrl = null;
    this.curContext = null;
    this.xcodeVersion = {};
    this.iosSdkVersion = null;
    this.contexts = [];
    this.implicitWaitMs = 0;
    this.asynclibWaitMs = 0;
    this.pageLoadMs = 6000;
    this.landscapeWebCoordsOffset = 0;
  }

  get driverData() {
    return {};
  }

  async getStatus() {
    if (typeof this.driverInfo === 'undefined') {
      this.driverInfo = await (0, _utils.getDriverInfo)();
    }

    let status = {
      build: {
        version: this.driverInfo.version
      }
    };

    if (this.cachedWdaStatus) {
      status.wda = this.cachedWdaStatus;
    }

    return status;
  }

  async createSession(...args) {
    this.lifecycleData = {};

    try {
      let [sessionId, caps] = await super.createSession(...args);
      this.opts.sessionId = sessionId;
      await this.start();
      caps = Object.assign({}, _appiumIosDriver.defaultServerCaps, caps);
      caps.udid = this.opts.udid;

      if (_lodash.default.has(this.opts, 'nativeWebTap')) {
        await this.updateSettings({
          nativeWebTap: this.opts.nativeWebTap
        });
      }

      if (_lodash.default.has(this.opts, 'useJSONSource')) {
        await this.updateSettings({
          useJSONSource: this.opts.useJSONSource
        });
      }

      let wdaSettings = {
        elementResponseAttributes: DEFAULT_SETTINGS.elementResponseAttributes,
        shouldUseCompactResponses: DEFAULT_SETTINGS.shouldUseCompactResponses
      };

      if (_lodash.default.has(this.opts, 'elementResponseAttributes')) {
        wdaSettings.elementResponseAttributes = this.opts.elementResponseAttributes;
      }

      if (_lodash.default.has(this.opts, 'shouldUseCompactResponses')) {
        wdaSettings.shouldUseCompactResponses = this.opts.shouldUseCompactResponses;
      }

      if (_lodash.default.has(this.opts, 'mjpegServerScreenshotQuality')) {
        wdaSettings.mjpegServerScreenshotQuality = this.opts.mjpegServerScreenshotQuality;
      }

      if (_lodash.default.has(this.opts, 'mjpegServerFramerate')) {
        wdaSettings.mjpegServerFramerate = this.opts.mjpegServerFramerate;
      }

      if (this.opts.screenshotQuality) {
        _logger.default.info(`Setting the quality of phone screenshot: '${this.opts.screenshotQuality}'`);

        wdaSettings.screenshotQuality = this.opts.screenshotQuality;
      }

      await this.updateSettings(wdaSettings);

      if (this.opts.mjpegScreenshotUrl) {
        _logger.default.info(`Starting MJPEG stream reading URL: '${this.opts.mjpegScreenshotUrl}'`);

        this.mjpegStream = new _appiumSupport.mjpeg.MJpegStream(this.opts.mjpegScreenshotUrl);
        await this.mjpegStream.start();
      }

      return [sessionId, caps];
    } catch (e) {
      _logger.default.error(e);

      await this.deleteSession();
      throw e;
    }
  }

  async start() {
    this.opts.noReset = !!this.opts.noReset;
    this.opts.fullReset = !!this.opts.fullReset;
    await (0, _utils.printUser)();

    if (this.opts.platformVersion && parseFloat(this.opts.platformVersion) < 9.3) {
      throw Error(`Platform version must be 9.3 or above. '${this.opts.platformVersion}' is not supported.`);
    }

    const {
      device,
      udid,
      realDevice
    } = await this.determineDevice();

    _logger.default.info(`Determining device to run tests on: udid: '${udid}', real device: ${realDevice}`);

    this.opts.device = device;
    this.opts.udid = udid;
    this.opts.realDevice = realDevice;

    if (_lodash.default.isEmpty(this.xcodeVersion) && (!this.opts.webDriverAgentUrl || !this.opts.realDevice)) {
      this.xcodeVersion = await (0, _utils.getAndCheckXcodeVersion)();
      const tools = !this.xcodeVersion.toolsVersion ? '' : `(tools v${this.xcodeVersion.toolsVersion})`;

      _logger.default.info(`Xcode version set to '${this.xcodeVersion.versionString}' ${tools}`);

      this.iosSdkVersion = await (0, _utils.getAndCheckIosSdkVersion)();

      _logger.default.info(`iOS SDK Version set to '${this.iosSdkVersion}'`);
    }

    this.logEvent('xcodeDetailsRetrieved');

    if (this.opts.enableAsyncExecuteFromHttps && !this.isRealDevice()) {
      await (0, _simulatorManagement.shutdownSimulator)(this.opts.device);
      await this.startHttpsAsyncServer();
    }

    if (!this.opts.platformVersion) {
      if (this.opts.device && _lodash.default.isFunction(this.opts.device.getPlatformVersion)) {
        this.opts.platformVersion = await this.opts.device.getPlatformVersion();

        _logger.default.info(`No platformVersion specified. Using device version: '${this.opts.platformVersion}'`);
      } else {}
    }

    if (!this.opts.webDriverAgentUrl && this.iosSdkVersion) {
      if (parseFloat(this.opts.platformVersion) > parseFloat(this.iosSdkVersion)) {
        let msg = `Xcode ${this.xcodeVersion.versionString} has a maximum SDK version of ${this.iosSdkVersion}. ` + `It does not support iOS version ${this.opts.platformVersion}`;

        _logger.default.errorAndThrow(msg);
      }
    } else {
      _logger.default.debug('Xcode version will not be validated against iOS SDK version.');
    }

    if ((this.opts.browserName || '').toLowerCase() === 'safari') {
      _logger.default.info('Safari test requested');

      this.safari = true;
      this.opts.app = undefined;
      this.opts.processArguments = this.opts.processArguments || {};
      this.opts.bundleId = SAFARI_BUNDLE_ID;
      this._currentUrl = this.opts.safariInitialUrl || (this.isRealDevice() ? 'http://appium.io' : `http://${this.opts.address}:${this.opts.port}/welcome`);
      this.opts.processArguments.args = ['-u', this._currentUrl];
    } else {
      await this.configureApp();
    }

    this.logEvent('appConfigured');

    if (this.opts.app) {
      await (0, _utils.checkAppPresent)(this.opts.app);
    }

    if (!this.opts.bundleId) {
      this.opts.bundleId = await _appiumIosDriver.appUtils.extractBundleId(this.opts.app);
    }

    await this.runReset();

    const memoizedLogInfo = _lodash.default.memoize(function () {
      _logger.default.info("'skipLogCapture' is set. Skipping starting logs such as crash, system, safari console and safari network.");
    });

    const startLogCapture = async () => {
      if (this.opts.skipLogCapture) {
        memoizedLogInfo();
        return false;
      }

      const result = await this.startLogCapture();

      if (result) {
        this.logEvent('logCaptureStarted');
      }

      return result;
    };

    const isLogCaptureStarted = await startLogCapture();

    _logger.default.info(`Setting up ${this.isRealDevice() ? 'real device' : 'simulator'}`);

    if (this.isSimulator()) {
      if (this.opts.shutdownOtherSimulators) {
        if (!this.relaxedSecurityEnabled) {
          _logger.default.errorAndThrow(`Appium server must have relaxed security flag set in order ` + `for 'shutdownOtherSimulators' capability to work`);
        }

        await (0, _simulatorManagement.shutdownOtherSimulators)(this.opts.device);
      }

      if (_appiumSupport.util.hasValue(this.opts.reduceMotion)) {
        await this.opts.device.setReduceMotion(this.opts.reduceMotion);
      }

      this.localConfig = await _appiumIosDriver.settings.setLocaleAndPreferences(this.opts.device, this.opts, this.isSafari(), async sim => {
        await (0, _simulatorManagement.shutdownSimulator)(sim);
        await _appiumIosDriver.settings.setLocaleAndPreferences(sim, this.opts, this.isSafari());
      });
      await this.startSim();

      if (this.opts.customSSLCert) {
        if (await (0, _appiumIosSimulator.hasSSLCert)(this.opts.customSSLCert, this.opts.udid)) {
          _logger.default.info(`SSL cert '${_lodash.default.truncate(this.opts.customSSLCert, {
            length: 20
          })}' already installed`);
        } else {
          _logger.default.info(`Installing ssl cert '${_lodash.default.truncate(this.opts.customSSLCert, {
            length: 20
          })}'`);

          await (0, _simulatorManagement.shutdownSimulator)(this.opts.device);
          await (0, _appiumIosSimulator.installSSLCert)(this.opts.customSSLCert, this.opts.udid);

          _logger.default.info(`Restarting Simulator so that SSL certificate installation takes effect`);

          await this.startSim();
          this.logEvent('customCertInstalled');
        }
      }

      this.logEvent('simStarted');

      if (!isLogCaptureStarted) {
        await startLogCapture();
      }
    }

    if (this.opts.app) {
      await this.installAUT();
      this.logEvent('appInstalled');
    }

    if (!this.opts.app && this.opts.bundleId && !this.safari) {
      if (!(await this.opts.device.isAppInstalled(this.opts.bundleId))) {
        _logger.default.errorAndThrow(`App with bundle identifier '${this.opts.bundleId}' unknown`);
      }
    }

    if (this.opts.permissions) {
      if (this.isSimulator()) {
        _logger.default.debug('Setting the requested permissions before WDA is started');

        for (const [bundleId, permissionsMapping] of _lodash.default.toPairs(JSON.parse(this.opts.permissions))) {
          await this.opts.device.setPermissions(bundleId, permissionsMapping);
        }
      } else {
        _logger.default.warn('Setting permissions is only supported on Simulator. ' + 'The "permissions" capability will be ignored.');
      }
    }

    await SHARED_RESOURCES_GUARD.acquire(XCUITestDriver.name, async () => await this.startWda(this.opts.sessionId, realDevice));
    await this.setInitialOrientation(this.opts.orientation);
    this.logEvent('orientationSet');

    if (this.isRealDevice() && this.opts.startIWDP) {
      try {
        await this.startIWDP();

        _logger.default.debug(`Started ios_webkit_debug proxy server at: ${this.iwdpServer.endpoint}`);
      } catch (err) {
        _logger.default.errorAndThrow(`Could not start ios_webkit_debug_proxy server: ${err.message}`);
      }
    }

    if (this.isSafari() || this.opts.autoWebview) {
      _logger.default.debug('Waiting for initial webview');

      await this.navToInitialWebview();
      this.logEvent('initialWebviewNavigated');
    }

    if (!this.isRealDevice()) {
      if (this.opts.calendarAccessAuthorized) {
        await this.opts.device.enableCalendarAccess(this.opts.bundleId);
      } else if (this.opts.calendarAccessAuthorized === false) {
        await this.opts.device.disableCalendarAccess(this.opts.bundleId);
      }
    }
  }

  async startWda(sessionId, realDevice) {
    this.wda = new _webdriveragent.default(this.xcodeVersion, this.opts);
    await this.wda.cleanupObsoleteProcesses();

    if (this.opts.useNewWDA) {
      _logger.default.debug(`Capability 'useNewWDA' set to true, so uninstalling WDA before proceeding`);

      await this.wda.quitAndUninstall();
      this.logEvent('wdaUninstalled');
    } else if (!_appiumSupport.util.hasValue(this.wda.webDriverAgentUrl)) {
      await this.wda.setupCaching(this.opts.updatedWDABundleId);
    }

    const quitAndUninstall = async msg => {
      _logger.default.debug(msg);

      if (this.opts.webDriverAgentUrl) {
        _logger.default.debug('Not quitting/uninstalling WebDriverAgent since webDriverAgentUrl capability is provided');

        throw new Error(msg);
      }

      _logger.default.warn('Quitting and uninstalling WebDriverAgent');

      await this.wda.quitAndUninstall();
      throw new Error(msg);
    };

    const startupRetries = this.opts.wdaStartupRetries || (this.isRealDevice() ? WDA_REAL_DEV_STARTUP_RETRIES : WDA_SIM_STARTUP_RETRIES);
    const startupRetryInterval = this.opts.wdaStartupRetryInterval || WDA_STARTUP_RETRY_INTERVAL;

    _logger.default.debug(`Trying to start WebDriverAgent ${startupRetries} times with ${startupRetryInterval}ms interval`);

    if (!_appiumSupport.util.hasValue(this.opts.wdaStartupRetries) && !_appiumSupport.util.hasValue(this.opts.wdaStartupRetryInterval)) {
      _logger.default.debug(`These values can be customized by changing wdaStartupRetries/wdaStartupRetryInterval capabilities`);
    }

    let retryCount = 0;
    await (0, _asyncbox.retryInterval)(startupRetries, startupRetryInterval, async () => {
      this.logEvent('wdaStartAttempted');

      if (retryCount > 0) {
        _logger.default.info(`Retrying WDA startup (${retryCount + 1} of ${startupRetries})`);
      }

      try {
        const retries = this.xcodeVersion.major >= 10 ? 2 : 1;
        this.cachedWdaStatus = await (0, _asyncbox.retry)(retries, this.wda.launch.bind(this.wda), sessionId, realDevice);
      } catch (err) {
        this.logEvent('wdaStartFailed');
        retryCount++;
        let errorMsg = `Unable to launch WebDriverAgent because of xcodebuild failure: "${err.message}".`;

        if (this.isRealDevice()) {
          errorMsg += ` Make sure you follow the tutorial at ${WDA_REAL_DEV_TUTORIAL_URL}. ` + `Try to remove the WebDriverAgentRunner application from the device if it is installed ` + `and reboot the device.`;
        }

        await quitAndUninstall(errorMsg);
      }

      this.proxyReqRes = this.wda.proxyReqRes.bind(this.wda);
      this.jwpProxyActive = true;

      try {
        await (0, _asyncbox.retryInterval)(15, 1000, async () => {
          this.logEvent('wdaSessionAttempted');

          _logger.default.debug('Sending createSession command to WDA');

          try {
            this.cachedWdaStatus = this.cachedWdaStatus || (await this.proxyCommand('/status', 'GET'));
            await this.startWdaSession(this.opts.bundleId, this.opts.processArguments);
          } catch (err) {
            _logger.default.debug(`Failed to create WDA session (${err.message}). Retrying...`);

            throw err;
          }
        });
        this.logEvent('wdaSessionStarted');
      } catch (err) {
        let errorMsg = `Unable to start WebDriverAgent session because of xcodebuild failure: ${err.message}`;

        if (this.isRealDevice()) {
          errorMsg += ` Make sure you follow the tutorial at ${WDA_REAL_DEV_TUTORIAL_URL}. ` + `Try to remove the WebDriverAgentRunner application from the device if it is installed ` + `and reboot the device.`;
        }

        await quitAndUninstall(errorMsg);
      }

      if (!_appiumSupport.util.hasValue(this.opts.preventWDAAttachments)) {
        this.opts.preventWDAAttachments = this.xcodeVersion.major < 9;

        if (this.opts.preventWDAAttachments) {
          _logger.default.info('Enabled WDA attachments prevention by default to save the disk space. ' + `Set 'preventWDAAttachments' capability to false if this is an undesired behavior.`);
        }
      }

      if (this.opts.preventWDAAttachments) {
        await (0, _utils.adjustWDAAttachmentsPermissions)(this.wda, this.opts.preventWDAAttachments ? '555' : '755');
        this.logEvent('wdaPermsAdjusted');
      }

      if (this.opts.clearSystemFiles) {
        await (0, _utils.markSystemFilesForCleanup)(this.wda);
      }

      this.wda.fullyStarted = true;
      this.logEvent('wdaStarted');
    });
  }

  async runReset(opts = null) {
    this.logEvent('resetStarted');

    if (this.isRealDevice()) {
      await (0, _realDeviceManagement.runRealDeviceReset)(this.opts.device, opts || this.opts);
    } else {
      await (0, _simulatorManagement.runSimulatorReset)(this.opts.device, opts || this.opts);
    }

    this.logEvent('resetComplete');
  }

  async deleteSession() {
    await (0, _utils.removeAllSessionWebSocketHandlers)(this.server, this.sessionId);
    await SHARED_RESOURCES_GUARD.acquire(XCUITestDriver.name, async () => {
      await this.stop();

      if (this.opts.preventWDAAttachments) {
        await (0, _utils.adjustWDAAttachmentsPermissions)(this.wda, '755');
      }

      if (this.opts.clearSystemFiles) {
        if (this.isAppTemporary) {
          await _appiumSupport.fs.rimraf(this.opts.app);
        }

        await (0, _utils.clearSystemFiles)(this.wda, !!this.opts.showXcodeLog);
      } else {
        _logger.default.debug('Not clearing log files. Use `clearSystemFiles` capability to turn on.');
      }
    });

    if (this.isWebContext()) {
      _logger.default.debug('In a web session. Removing remote debugger');

      await this.stopRemote();
    }

    if (this.opts.resetOnSessionStartOnly === false) {
      await this.runReset();
    }

    if (this.isSimulator() && !this.opts.noReset && !!this.opts.device) {
      if (this.lifecycleData.createSim) {
        _logger.default.debug(`Deleting simulator created for this run (udid: '${this.opts.udid}')`);

        await (0, _simulatorManagement.shutdownSimulator)(this.opts.device);
        await this.opts.device.delete();
      }
    }

    if (!_lodash.default.isEmpty(this.logs)) {
      await this.logs.syslog.stopCapture();
      this.logs = {};
    }

    if (this.iwdpServer) {
      await this.stopIWDP();
    }

    if (this.opts.enableAsyncExecuteFromHttps && !this.isRealDevice()) {
      await this.stopHttpsAsyncServer();
    }

    if (this.mjpegStream) {
      _logger.default.info('Closing MJPEG stream');

      this.mjpegStream.stop();
    }

    this.resetIos();
    await super.deleteSession();
  }

  async stop() {
    this.jwpProxyActive = false;
    this.proxyReqRes = null;

    if (this.wda && this.wda.fullyStarted) {
      if (this.wda.jwproxy) {
        try {
          await this.proxyCommand(`/session/${this.sessionId}`, 'DELETE');
        } catch (err) {
          _logger.default.debug(`Unable to DELETE session on WDA: '${err.message}'. Continuing shutdown.`);
        }
      }

      if (this.wda && !this.wda.webDriverAgentUrl && this.opts.useNewWDA) {
        await this.wda.quit();
      }
    }
  }

  async executeCommand(cmd, ...args) {
    _logger.default.debug(`Executing command '${cmd}'`);

    if (cmd === 'receiveAsyncResponse') {
      return await this.receiveAsyncResponse(...args);
    }

    if (cmd === 'getStatus') {
      return await this.getStatus();
    }

    return await super.executeCommand(cmd, ...args);
  }

  async configureApp() {
    function appIsPackageOrBundle(app) {
      return /^([a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+)+$/.test(app);
    }

    if (!this.opts.bundleId && appIsPackageOrBundle(this.opts.app)) {
      this.opts.bundleId = this.opts.app;
      this.opts.app = '';
    }

    if (this.opts.bundleId && appIsPackageOrBundle(this.opts.bundleId) && (this.opts.app === '' || appIsPackageOrBundle(this.opts.app))) {
      _logger.default.debug('App is an iOS bundle, will attempt to run as pre-existing');

      return;
    }

    if (this.opts.app && this.opts.app.toLowerCase() === 'settings') {
      this.opts.bundleId = 'com.apple.Preferences';
      this.opts.app = null;
      return;
    } else if (this.opts.app && this.opts.app.toLowerCase() === 'calendar') {
      this.opts.bundleId = 'com.apple.mobilecal';
      this.opts.app = null;
      return;
    }

    const originalAppPath = this.opts.app;

    try {
      this.opts.app = await this.helpers.configureApp(this.opts.app, '.app');
    } catch (err) {
      _logger.default.error(err);

      throw new Error(`Bad app: ${this.opts.app}. App paths need to be absolute or an URL to a compressed file`);
    }

    this.isAppTemporary = this.opts.app && (await _appiumSupport.fs.exists(this.opts.app)) && !(await _appiumSupport.util.isSameDestination(originalAppPath, this.opts.app));
  }

  async determineDevice() {
    this.lifecycleData.createSim = false;
    this.opts.deviceName = (0, _utils.translateDeviceName)(this.opts.platformVersion, this.opts.deviceName);

    if (this.opts.udid) {
      if (this.opts.udid.toLowerCase() === 'auto') {
        try {
          this.opts.udid = await (0, _utils.detectUdid)();
        } catch (err) {
          _logger.default.warn(`Cannot detect any connected real devices. Falling back to Simulator. Original error: ${err.message}`);

          const device = await (0, _simulatorManagement.getExistingSim)(this.opts);

          if (!device) {
            _logger.default.errorAndThrow(`Cannot detect udid for ${this.opts.deviceName} Simulator running iOS ${this.opts.platformVersion}`);
          }

          this.opts.udid = device.udid;
          return {
            device,
            realDevice: false,
            udid: device.udid
          };
        }
      } else {
        const devices = await (0, _realDeviceManagement.getConnectedDevices)();

        _logger.default.debug(`Available devices: ${devices.join(', ')}`);

        if (!devices.includes(this.opts.udid)) {
          if (await (0, _appiumIosSimulator.simExists)(this.opts.udid)) {
            const device = await (0, _appiumIosSimulator.getSimulator)(this.opts.udid);
            return {
              device,
              realDevice: false,
              udid: this.opts.udid
            };
          }

          throw new Error(`Unknown device or simulator UDID: '${this.opts.udid}'`);
        }
      }

      const device = await (0, _realDeviceManagement.getRealDeviceObj)(this.opts.udid);
      return {
        device,
        realDevice: true,
        udid: this.opts.udid
      };
    }

    if (!this.opts.platformVersion && this.iosSdkVersion) {
      _logger.default.info(`No platformVersion specified. Using latest version Xcode supports: '${this.iosSdkVersion}' ` + `This may cause problems if a simulator does not exist for this platform version.`);

      this.opts.platformVersion = this.iosSdkVersion;
    }

    if (this.opts.enforceFreshSimulatorCreation) {
      _logger.default.debug(`New simulator is requested. If this is not wanted, set 'enforceFreshSimulatorCreation' capability to false`);
    } else {
      const device = await (0, _simulatorManagement.getExistingSim)(this.opts);

      if (device) {
        return {
          device,
          realDevice: false,
          udid: device.udid
        };
      }

      _logger.default.info('Simulator udid not provided');
    }

    _logger.default.info('Using desired caps to create a new simulator');

    const device = await this.createSim();
    return {
      device,
      realDevice: false,
      udid: device.udid
    };
  }

  async startSim() {
    const runOpts = {
      scaleFactor: this.opts.scaleFactor,
      connectHardwareKeyboard: !!this.opts.connectHardwareKeyboard,
      isHeadless: !!this.opts.isHeadless,
      devicePreferences: {}
    };

    if (this.opts.SimulatorWindowCenter) {
      runOpts.devicePreferences.SimulatorWindowCenter = this.opts.SimulatorWindowCenter;
    }

    const orientation = _lodash.default.isString(this.opts.orientation) && this.opts.orientation.toUpperCase();

    switch (orientation) {
      case 'LANDSCAPE':
        runOpts.devicePreferences.SimulatorWindowOrientation = 'LandscapeLeft';
        runOpts.devicePreferences.SimulatorWindowRotationAngle = 90;
        break;

      case 'PORTRAIT':
        runOpts.devicePreferences.SimulatorWindowOrientation = 'Portrait';
        runOpts.devicePreferences.SimulatorWindowRotationAngle = 0;
        break;
    }

    await this.opts.device.run(runOpts);
  }

  async createSim() {
    this.lifecycleData.createSim = true;
    let sim = await (0, _simulatorManagement.createSim)(this.opts);

    _logger.default.info(`Created simulator with udid '${sim.udid}'.`);

    return sim;
  }

  async launchApp() {
    const APP_LAUNCH_TIMEOUT = 20 * 1000;
    this.logEvent('appLaunchAttempted');
    await (0, _nodeSimctl.launch)(this.opts.device.udid, this.opts.bundleId);

    let checkStatus = async () => {
      let response = await this.proxyCommand('/status', 'GET');
      let currentApp = response.currentApp.bundleID;

      if (currentApp !== this.opts.bundleId) {
        throw new Error(`${this.opts.bundleId} not in foreground. ${currentApp} is in foreground`);
      }
    };

    _logger.default.info(`Waiting for '${this.opts.bundleId}' to be in foreground`);

    let retries = parseInt(APP_LAUNCH_TIMEOUT / 200, 10);
    await (0, _asyncbox.retryInterval)(retries, 200, checkStatus);

    _logger.default.info(`${this.opts.bundleId} is in foreground`);

    this.logEvent('appLaunched');
  }

  async startWdaSession(bundleId, processArguments) {
    let args = processArguments ? processArguments.args || [] : [];

    if (!_lodash.default.isArray(args)) {
      throw new Error(`processArguments.args capability is expected to be an array. ` + `${JSON.stringify(args)} is given instead`);
    }

    let env = processArguments ? processArguments.env || {} : {};

    if (!_lodash.default.isPlainObject(env)) {
      throw new Error(`processArguments.env capability is expected to be a dictionary. ` + `${JSON.stringify(env)} is given instead`);
    }

    let shouldWaitForQuiescence = _appiumSupport.util.hasValue(this.opts.waitForQuiescence) ? this.opts.waitForQuiescence : true;
    let maxTypingFrequency = _appiumSupport.util.hasValue(this.opts.maxTypingFrequency) ? this.opts.maxTypingFrequency : 60;
    let shouldUseSingletonTestManager = _appiumSupport.util.hasValue(this.opts.shouldUseSingletonTestManager) ? this.opts.shouldUseSingletonTestManager : true;
    let shouldUseTestManagerForVisibilityDetection = false;
    let eventloopIdleDelaySec = this.opts.wdaEventloopIdleDelay || 0;

    if (_appiumSupport.util.hasValue(this.opts.simpleIsVisibleCheck)) {
      shouldUseTestManagerForVisibilityDetection = this.opts.simpleIsVisibleCheck;
    }

    if (!isNaN(parseFloat(this.opts.platformVersion)) && parseFloat(this.opts.platformVersion).toFixed(1) === '9.3') {
      _logger.default.info(`Forcing shouldUseSingletonTestManager capability value to true, because of known XCTest issues under 9.3 platform version`);

      shouldUseTestManagerForVisibilityDetection = true;
    }

    if (_appiumSupport.util.hasValue(this.opts.language)) {
      args.push('-AppleLanguages', `(${this.opts.language})`);
      args.push('-NSLanguages', `(${this.opts.language})`);
    }

    if (_appiumSupport.util.hasValue(this.opts.locale)) {
      args.push('-AppleLocale', this.opts.locale);
    }

    let desired = {
      desiredCapabilities: {
        bundleId,
        arguments: args,
        environment: env,
        eventloopIdleDelaySec,
        shouldWaitForQuiescence,
        shouldUseTestManagerForVisibilityDetection,
        maxTypingFrequency,
        shouldUseSingletonTestManager
      }
    };

    if (_appiumSupport.util.hasValue(this.opts.shouldUseCompactResponses)) {
      desired.desiredCapabilities.shouldUseCompactResponses = this.opts.shouldUseCompactResponses;
    }

    if (_appiumSupport.util.hasValue(this.opts.elementResponseFields)) {
      desired.desiredCapabilities.elementResponseFields = this.opts.elementResponseFields;
    }

    if (this.opts.autoAcceptAlerts) {
      desired.desiredCapabilities.defaultAlertAction = 'accept';
    } else if (this.opts.autoDismissAlerts) {
      desired.desiredCapabilities.defaultAlertAction = 'dismiss';
    }

    await this.proxyCommand('/session', 'POST', desired);
  }

  proxyActive() {
    return this.jwpProxyActive;
  }

  getProxyAvoidList() {
    if (this.isWebview()) {
      return NO_PROXY_WEB_LIST;
    }

    return NO_PROXY_NATIVE_LIST;
  }

  canProxy() {
    return true;
  }

  isSafari() {
    return !!this.safari;
  }

  isRealDevice() {
    return this.opts.realDevice;
  }

  isSimulator() {
    return !this.opts.realDevice;
  }

  isWebview() {
    return this.isSafari() || this.isWebContext();
  }

  validateLocatorStrategy(strategy) {
    super.validateLocatorStrategy(strategy, this.isWebContext());
  }

  validateDesiredCaps(caps) {
    if (!super.validateDesiredCaps(caps)) {
      return false;
    }

    if ((caps.browserName || '').toLowerCase() !== 'safari' && !caps.app && !caps.bundleId) {
      let msg = 'The desired capabilities must include either an app or a bundleId for iOS';

      _logger.default.errorAndThrow(msg);
    }

    let verifyProcessArgument = processArguments => {
      const {
        args,
        env
      } = processArguments;

      if (!_lodash.default.isNil(args) && !_lodash.default.isArray(args)) {
        _logger.default.errorAndThrow('processArguments.args must be an array of strings');
      }

      if (!_lodash.default.isNil(env) && !_lodash.default.isPlainObject(env)) {
        _logger.default.errorAndThrow('processArguments.env must be an object <key,value> pair {a:b, c:d}');
      }
    };

    if (caps.processArguments) {
      if (_lodash.default.isString(caps.processArguments)) {
        try {
          caps.processArguments = JSON.parse(caps.processArguments);
          verifyProcessArgument(caps.processArguments);
        } catch (err) {
          _logger.default.errorAndThrow(`processArguments must be a json format or an object with format {args : [], env : {a:b, c:d}}. ` + `Both environment and argument can be null. Error: ${err}`);
        }
      } else if (_lodash.default.isPlainObject(caps.processArguments)) {
        verifyProcessArgument(caps.processArguments);
      } else {
        _logger.default.errorAndThrow(`'processArguments must be an object, or a string JSON object with format {args : [], env : {a:b, c:d}}. ` + `Both environment and argument can be null.`);
      }
    }

    if (caps.keychainPath && !caps.keychainPassword || !caps.keychainPath && caps.keychainPassword) {
      _logger.default.errorAndThrow(`If 'keychainPath' is set, 'keychainPassword' must also be set (and vice versa).`);
    }

    this.opts.resetOnSessionStartOnly = !_appiumSupport.util.hasValue(this.opts.resetOnSessionStartOnly) || this.opts.resetOnSessionStartOnly;
    this.opts.useNewWDA = _appiumSupport.util.hasValue(this.opts.useNewWDA) ? this.opts.useNewWDA : false;

    if (caps.commandTimeouts) {
      caps.commandTimeouts = (0, _utils.normalizeCommandTimeouts)(caps.commandTimeouts);
    }

    if (_lodash.default.isString(caps.webDriverAgentUrl)) {
      const {
        protocol,
        host
      } = _url.default.parse(caps.webDriverAgentUrl);

      if (_lodash.default.isEmpty(protocol) || _lodash.default.isEmpty(host)) {
        _logger.default.errorAndThrow(`'webDriverAgentUrl' capability is expected to contain a valid WebDriverAgent server URL. ` + `'${caps.webDriverAgentUrl}' is given instead`);
      }
    }

    if (caps.browserName) {
      if (caps.bundleId) {
        _logger.default.errorAndThrow(`'browserName' cannot be set together with 'bundleId' capability`);
      }

      if (caps.app) {
        _logger.default.warn(`The capabilities should generally not include both an 'app' and a 'browserName'`);
      }
    }

    if (caps.permissions) {
      try {
        for (const [bundleId, perms] of _lodash.default.toPairs(JSON.parse(caps.permissions))) {
          if (!_lodash.default.isString(bundleId)) {
            throw new Error(`'${JSON.stringify(bundleId)}' must be a string`);
          }

          if (!_lodash.default.isPlainObject(perms)) {
            throw new Error(`'${JSON.stringify(perms)}' must be a JSON object`);
          }
        }
      } catch (e) {
        _logger.default.errorAndThrow(`'${caps.permissions}' is expected to be a valid object with format ` + `{"<bundleId1>": {"<serviceName1>": "<serviceStatus1>", ...}, ...}. Original error: ${e.message}`);
      }
    }

    return true;
  }

  async installAUT() {
    if (this.isSafari()) {
      return;
    }

    if (this.opts.autoLaunch === false) {
      return;
    }

    try {
      await (0, _utils.verifyApplicationPlatform)(this.opts.app, this.isSimulator());
    } catch (err) {
      _logger.default.warn(`*********************************`);

      _logger.default.warn(`${this.isSimulator() ? 'Simulator' : 'Real device'} architecture appears to be unsupported ` + `by the '${this.opts.app}' application. ` + `Make sure the correct deployment target has been selected for its compilation in Xcode.`);

      _logger.default.warn('Don\'t be surprised if the application fails to launch.');

      _logger.default.warn(`*********************************`);
    }

    if (this.isRealDevice()) {
      await (0, _realDeviceManagement.installToRealDevice)(this.opts.device, this.opts.app, this.opts.bundleId, this.opts.noReset);
    } else {
      await (0, _simulatorManagement.installToSimulator)(this.opts.device, this.opts.app, this.opts.bundleId, this.opts.noReset);
    }

    if (_appiumSupport.util.hasValue(this.opts.iosInstallPause)) {
      let pause = parseInt(this.opts.iosInstallPause, 10);

      _logger.default.debug(`iosInstallPause set. Pausing ${pause} ms before continuing`);

      await _bluebird.default.delay(pause);
    }
  }

  async setInitialOrientation(orientation) {
    if (!_lodash.default.isString(orientation)) {
      _logger.default.info('Skipping setting of the initial display orientation. ' + 'Set the "orientation" capability to either "LANDSCAPE" or "PORTRAIT", if this is an undesired behavior.');

      return;
    }

    orientation = orientation.toUpperCase();

    if (!_lodash.default.includes(['LANDSCAPE', 'PORTRAIT'], orientation)) {
      _logger.default.debug(`Unable to set initial orientation to '${orientation}'`);

      return;
    }

    _logger.default.debug(`Setting initial orientation to '${orientation}'`);

    try {
      await this.proxyCommand('/orientation', 'POST', {
        orientation
      });
      this.opts.curOrientation = orientation;
    } catch (err) {
      _logger.default.warn(`Setting initial orientation failed with: ${err.message}`);
    }
  }

  _getCommandTimeout(cmdName) {
    if (this.opts.commandTimeouts) {
      if (cmdName && _lodash.default.has(this.opts.commandTimeouts, cmdName)) {
        return this.opts.commandTimeouts[cmdName];
      }

      return this.opts.commandTimeouts[_utils.DEFAULT_TIMEOUT_KEY];
    }
  }

  async getSession() {
    const driverSession = await super.getSession();

    if (!this.wdaCaps) {
      this.wdaCaps = await this.proxyCommand('/', 'GET');
    }

    if (!this.deviceCaps) {
      const {
        statusBarSize,
        scale
      } = await this.getScreenInfo();
      this.deviceCaps = {
        pixelRatio: scale,
        statBarHeight: statusBarSize.height,
        viewportRect: await this.getViewportRect()
      };
    }

    _logger.default.info('Merging WDA caps over Appium caps for session detail response');

    return Object.assign({
      udid: this.opts.udid
    }, driverSession, this.wdaCaps.capabilities, this.deviceCaps);
  }

  async startIWDP() {
    this.logEvent('iwdpStarting');
    this.iwdpServer = new _appiumIosDriver.IWDP({
      webkitDebugProxyPort: this.opts.webkitDebugProxyPort,
      udid: this.opts.udid,
      logStdout: !!this.opts.showIWDPLog
    });
    await this.iwdpServer.start();
    this.logEvent('iwdpStarted');
  }

  async stopIWDP() {
    if (this.iwdpServer) {
      await this.iwdpServer.stop();
      delete this.iwdpServer;
    }
  }

  async reset() {
    if (this.opts.noReset) {
      let opts = _lodash.default.cloneDeep(this.opts);

      opts.noReset = false;
      opts.fullReset = false;
      const shutdownHandler = this.resetOnUnexpectedShutdown;

      this.resetOnUnexpectedShutdown = () => {};

      try {
        await this.runReset(opts);
      } finally {
        this.resetOnUnexpectedShutdown = shutdownHandler;
      }
    }

    await super.reset();
  }

}

exports.XCUITestDriver = XCUITestDriver;
Object.assign(XCUITestDriver.prototype, _index.default);
var _default = XCUITestDriver;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9kcml2ZXIuanMiXSwibmFtZXMiOlsiU0FGQVJJX0JVTkRMRV9JRCIsIldEQV9TSU1fU1RBUlRVUF9SRVRSSUVTIiwiV0RBX1JFQUxfREVWX1NUQVJUVVBfUkVUUklFUyIsIldEQV9SRUFMX0RFVl9UVVRPUklBTF9VUkwiLCJXREFfU1RBUlRVUF9SRVRSWV9JTlRFUlZBTCIsIkRFRkFVTFRfU0VUVElOR1MiLCJuYXRpdmVXZWJUYXAiLCJ1c2VKU09OU291cmNlIiwic2hvdWxkVXNlQ29tcGFjdFJlc3BvbnNlcyIsImVsZW1lbnRSZXNwb25zZUF0dHJpYnV0ZXMiLCJtanBlZ1NlcnZlclNjcmVlbnNob3RRdWFsaXR5IiwibWpwZWdTZXJ2ZXJGcmFtZXJhdGUiLCJzY3JlZW5zaG90UXVhbGl0eSIsIlNIQVJFRF9SRVNPVVJDRVNfR1VBUkQiLCJBc3luY0xvY2siLCJOT19QUk9YWV9OQVRJVkVfTElTVCIsIk5PX1BST1hZX1dFQl9MSVNUIiwiY29uY2F0IiwiTUVNT0laRURfRlVOQ1RJT05TIiwiWENVSVRlc3REcml2ZXIiLCJCYXNlRHJpdmVyIiwiY29uc3RydWN0b3IiLCJvcHRzIiwic2hvdWxkVmFsaWRhdGVDYXBzIiwiZGVzaXJlZENhcENvbnN0cmFpbnRzIiwibG9jYXRvclN0cmF0ZWdpZXMiLCJ3ZWJMb2NhdG9yU3RyYXRlZ2llcyIsInJlc2V0SW9zIiwic2V0dGluZ3MiLCJEZXZpY2VTZXR0aW5ncyIsIm9uU2V0dGluZ3NVcGRhdGUiLCJiaW5kIiwibG9ncyIsImZuIiwiXyIsIm1lbW9pemUiLCJrZXkiLCJ2YWx1ZSIsInByb3h5Q29tbWFuZCIsIndkYSIsImRldmljZSIsImp3cFByb3h5QWN0aXZlIiwicHJveHlSZXFSZXMiLCJqd3BQcm94eUF2b2lkIiwic2FmYXJpIiwiY2FjaGVkV2RhU3RhdHVzIiwiY3VyV2ViRnJhbWVzIiwid2ViRWxlbWVudElkcyIsIl9jdXJyZW50VXJsIiwiY3VyQ29udGV4dCIsInhjb2RlVmVyc2lvbiIsImlvc1Nka1ZlcnNpb24iLCJjb250ZXh0cyIsImltcGxpY2l0V2FpdE1zIiwiYXN5bmNsaWJXYWl0TXMiLCJwYWdlTG9hZE1zIiwibGFuZHNjYXBlV2ViQ29vcmRzT2Zmc2V0IiwiZHJpdmVyRGF0YSIsImdldFN0YXR1cyIsImRyaXZlckluZm8iLCJzdGF0dXMiLCJidWlsZCIsInZlcnNpb24iLCJjcmVhdGVTZXNzaW9uIiwiYXJncyIsImxpZmVjeWNsZURhdGEiLCJzZXNzaW9uSWQiLCJjYXBzIiwic3RhcnQiLCJPYmplY3QiLCJhc3NpZ24iLCJkZWZhdWx0U2VydmVyQ2FwcyIsInVkaWQiLCJoYXMiLCJ1cGRhdGVTZXR0aW5ncyIsIndkYVNldHRpbmdzIiwibG9nIiwiaW5mbyIsIm1qcGVnU2NyZWVuc2hvdFVybCIsIm1qcGVnU3RyZWFtIiwibWpwZWciLCJNSnBlZ1N0cmVhbSIsImUiLCJlcnJvciIsImRlbGV0ZVNlc3Npb24iLCJub1Jlc2V0IiwiZnVsbFJlc2V0IiwicGxhdGZvcm1WZXJzaW9uIiwicGFyc2VGbG9hdCIsIkVycm9yIiwicmVhbERldmljZSIsImRldGVybWluZURldmljZSIsImlzRW1wdHkiLCJ3ZWJEcml2ZXJBZ2VudFVybCIsInRvb2xzIiwidG9vbHNWZXJzaW9uIiwidmVyc2lvblN0cmluZyIsImxvZ0V2ZW50IiwiZW5hYmxlQXN5bmNFeGVjdXRlRnJvbUh0dHBzIiwiaXNSZWFsRGV2aWNlIiwic3RhcnRIdHRwc0FzeW5jU2VydmVyIiwiaXNGdW5jdGlvbiIsImdldFBsYXRmb3JtVmVyc2lvbiIsIm1zZyIsImVycm9yQW5kVGhyb3ciLCJkZWJ1ZyIsImJyb3dzZXJOYW1lIiwidG9Mb3dlckNhc2UiLCJhcHAiLCJ1bmRlZmluZWQiLCJwcm9jZXNzQXJndW1lbnRzIiwiYnVuZGxlSWQiLCJzYWZhcmlJbml0aWFsVXJsIiwiYWRkcmVzcyIsInBvcnQiLCJjb25maWd1cmVBcHAiLCJhcHBVdGlscyIsImV4dHJhY3RCdW5kbGVJZCIsInJ1blJlc2V0IiwibWVtb2l6ZWRMb2dJbmZvIiwic3RhcnRMb2dDYXB0dXJlIiwic2tpcExvZ0NhcHR1cmUiLCJyZXN1bHQiLCJpc0xvZ0NhcHR1cmVTdGFydGVkIiwiaXNTaW11bGF0b3IiLCJzaHV0ZG93bk90aGVyU2ltdWxhdG9ycyIsInJlbGF4ZWRTZWN1cml0eUVuYWJsZWQiLCJ1dGlsIiwiaGFzVmFsdWUiLCJyZWR1Y2VNb3Rpb24iLCJzZXRSZWR1Y2VNb3Rpb24iLCJsb2NhbENvbmZpZyIsImlvc1NldHRpbmdzIiwic2V0TG9jYWxlQW5kUHJlZmVyZW5jZXMiLCJpc1NhZmFyaSIsInNpbSIsInN0YXJ0U2ltIiwiY3VzdG9tU1NMQ2VydCIsInRydW5jYXRlIiwibGVuZ3RoIiwiaW5zdGFsbEFVVCIsImlzQXBwSW5zdGFsbGVkIiwicGVybWlzc2lvbnMiLCJwZXJtaXNzaW9uc01hcHBpbmciLCJ0b1BhaXJzIiwiSlNPTiIsInBhcnNlIiwic2V0UGVybWlzc2lvbnMiLCJ3YXJuIiwiYWNxdWlyZSIsIm5hbWUiLCJzdGFydFdkYSIsInNldEluaXRpYWxPcmllbnRhdGlvbiIsIm9yaWVudGF0aW9uIiwic3RhcnRJV0RQIiwiaXdkcFNlcnZlciIsImVuZHBvaW50IiwiZXJyIiwibWVzc2FnZSIsImF1dG9XZWJ2aWV3IiwibmF2VG9Jbml0aWFsV2VidmlldyIsImNhbGVuZGFyQWNjZXNzQXV0aG9yaXplZCIsImVuYWJsZUNhbGVuZGFyQWNjZXNzIiwiZGlzYWJsZUNhbGVuZGFyQWNjZXNzIiwiV2ViRHJpdmVyQWdlbnQiLCJjbGVhbnVwT2Jzb2xldGVQcm9jZXNzZXMiLCJ1c2VOZXdXREEiLCJxdWl0QW5kVW5pbnN0YWxsIiwic2V0dXBDYWNoaW5nIiwidXBkYXRlZFdEQUJ1bmRsZUlkIiwic3RhcnR1cFJldHJpZXMiLCJ3ZGFTdGFydHVwUmV0cmllcyIsInN0YXJ0dXBSZXRyeUludGVydmFsIiwid2RhU3RhcnR1cFJldHJ5SW50ZXJ2YWwiLCJyZXRyeUNvdW50IiwicmV0cmllcyIsIm1ham9yIiwibGF1bmNoIiwiZXJyb3JNc2ciLCJzdGFydFdkYVNlc3Npb24iLCJwcmV2ZW50V0RBQXR0YWNobWVudHMiLCJjbGVhclN5c3RlbUZpbGVzIiwiZnVsbHlTdGFydGVkIiwic2VydmVyIiwic3RvcCIsImlzQXBwVGVtcG9yYXJ5IiwiZnMiLCJyaW1yYWYiLCJzaG93WGNvZGVMb2ciLCJpc1dlYkNvbnRleHQiLCJzdG9wUmVtb3RlIiwicmVzZXRPblNlc3Npb25TdGFydE9ubHkiLCJjcmVhdGVTaW0iLCJkZWxldGUiLCJzeXNsb2ciLCJzdG9wQ2FwdHVyZSIsInN0b3BJV0RQIiwic3RvcEh0dHBzQXN5bmNTZXJ2ZXIiLCJqd3Byb3h5IiwicXVpdCIsImV4ZWN1dGVDb21tYW5kIiwiY21kIiwicmVjZWl2ZUFzeW5jUmVzcG9uc2UiLCJhcHBJc1BhY2thZ2VPckJ1bmRsZSIsInRlc3QiLCJvcmlnaW5hbEFwcFBhdGgiLCJoZWxwZXJzIiwiZXhpc3RzIiwiaXNTYW1lRGVzdGluYXRpb24iLCJkZXZpY2VOYW1lIiwiZGV2aWNlcyIsImpvaW4iLCJpbmNsdWRlcyIsImVuZm9yY2VGcmVzaFNpbXVsYXRvckNyZWF0aW9uIiwicnVuT3B0cyIsInNjYWxlRmFjdG9yIiwiY29ubmVjdEhhcmR3YXJlS2V5Ym9hcmQiLCJpc0hlYWRsZXNzIiwiZGV2aWNlUHJlZmVyZW5jZXMiLCJTaW11bGF0b3JXaW5kb3dDZW50ZXIiLCJpc1N0cmluZyIsInRvVXBwZXJDYXNlIiwiU2ltdWxhdG9yV2luZG93T3JpZW50YXRpb24iLCJTaW11bGF0b3JXaW5kb3dSb3RhdGlvbkFuZ2xlIiwicnVuIiwibGF1bmNoQXBwIiwiQVBQX0xBVU5DSF9USU1FT1VUIiwiY2hlY2tTdGF0dXMiLCJyZXNwb25zZSIsImN1cnJlbnRBcHAiLCJidW5kbGVJRCIsInBhcnNlSW50IiwiaXNBcnJheSIsInN0cmluZ2lmeSIsImVudiIsImlzUGxhaW5PYmplY3QiLCJzaG91bGRXYWl0Rm9yUXVpZXNjZW5jZSIsIndhaXRGb3JRdWllc2NlbmNlIiwibWF4VHlwaW5nRnJlcXVlbmN5Iiwic2hvdWxkVXNlU2luZ2xldG9uVGVzdE1hbmFnZXIiLCJzaG91bGRVc2VUZXN0TWFuYWdlckZvclZpc2liaWxpdHlEZXRlY3Rpb24iLCJldmVudGxvb3BJZGxlRGVsYXlTZWMiLCJ3ZGFFdmVudGxvb3BJZGxlRGVsYXkiLCJzaW1wbGVJc1Zpc2libGVDaGVjayIsImlzTmFOIiwidG9GaXhlZCIsImxhbmd1YWdlIiwicHVzaCIsImxvY2FsZSIsImRlc2lyZWQiLCJkZXNpcmVkQ2FwYWJpbGl0aWVzIiwiYXJndW1lbnRzIiwiZW52aXJvbm1lbnQiLCJlbGVtZW50UmVzcG9uc2VGaWVsZHMiLCJhdXRvQWNjZXB0QWxlcnRzIiwiZGVmYXVsdEFsZXJ0QWN0aW9uIiwiYXV0b0Rpc21pc3NBbGVydHMiLCJwcm94eUFjdGl2ZSIsImdldFByb3h5QXZvaWRMaXN0IiwiaXNXZWJ2aWV3IiwiY2FuUHJveHkiLCJ2YWxpZGF0ZUxvY2F0b3JTdHJhdGVneSIsInN0cmF0ZWd5IiwidmFsaWRhdGVEZXNpcmVkQ2FwcyIsInZlcmlmeVByb2Nlc3NBcmd1bWVudCIsImlzTmlsIiwia2V5Y2hhaW5QYXRoIiwia2V5Y2hhaW5QYXNzd29yZCIsImNvbW1hbmRUaW1lb3V0cyIsInByb3RvY29sIiwiaG9zdCIsInVybCIsInBlcm1zIiwiYXV0b0xhdW5jaCIsImlvc0luc3RhbGxQYXVzZSIsInBhdXNlIiwiQiIsImRlbGF5IiwiY3VyT3JpZW50YXRpb24iLCJfZ2V0Q29tbWFuZFRpbWVvdXQiLCJjbWROYW1lIiwiREVGQVVMVF9USU1FT1VUX0tFWSIsImdldFNlc3Npb24iLCJkcml2ZXJTZXNzaW9uIiwid2RhQ2FwcyIsImRldmljZUNhcHMiLCJzdGF0dXNCYXJTaXplIiwic2NhbGUiLCJnZXRTY3JlZW5JbmZvIiwicGl4ZWxSYXRpbyIsInN0YXRCYXJIZWlnaHQiLCJoZWlnaHQiLCJ2aWV3cG9ydFJlY3QiLCJnZXRWaWV3cG9ydFJlY3QiLCJjYXBhYmlsaXRpZXMiLCJJV0RQIiwid2Via2l0RGVidWdQcm94eVBvcnQiLCJsb2dTdGRvdXQiLCJzaG93SVdEUExvZyIsInJlc2V0IiwiY2xvbmVEZWVwIiwic2h1dGRvd25IYW5kbGVyIiwicmVzZXRPblVuZXhwZWN0ZWRTaHV0ZG93biIsInByb3RvdHlwZSIsImNvbW1hbmRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUtBOztBQUVBOztBQUNBOztBQUdBLE1BQU1BLGdCQUFnQixHQUFHLHdCQUF6QjtBQUNBLE1BQU1DLHVCQUF1QixHQUFHLENBQWhDO0FBQ0EsTUFBTUMsNEJBQTRCLEdBQUcsQ0FBckM7QUFDQSxNQUFNQyx5QkFBeUIsR0FBRyx5RkFBbEM7QUFDQSxNQUFNQywwQkFBMEIsR0FBRyxLQUFuQztBQUNBLE1BQU1DLGdCQUFnQixHQUFHO0FBQ3ZCQyxFQUFBQSxZQUFZLEVBQUUsS0FEUztBQUV2QkMsRUFBQUEsYUFBYSxFQUFFLEtBRlE7QUFHdkJDLEVBQUFBLHlCQUF5QixFQUFFLElBSEo7QUFJdkJDLEVBQUFBLHlCQUF5QixFQUFFLFlBSko7QUFNdkJDLEVBQUFBLDRCQUE0QixFQUFFLEVBTlA7QUFPdkJDLEVBQUFBLG9CQUFvQixFQUFFLEVBUEM7QUFRdkJDLEVBQUFBLGlCQUFpQixFQUFFO0FBUkksQ0FBekI7QUFZQSxNQUFNQyxzQkFBc0IsR0FBRyxJQUFJQyxrQkFBSixFQUEvQjtBQUdBLE1BQU1DLG9CQUFvQixHQUFHLENBQzNCLENBQUMsUUFBRCxFQUFXLFFBQVgsQ0FEMkIsRUFFM0IsQ0FBQyxLQUFELEVBQVEscUJBQVIsQ0FGMkIsRUFHM0IsQ0FBQyxLQUFELEVBQVEsWUFBUixDQUgyQixFQUkzQixDQUFDLEtBQUQsRUFBUSxlQUFSLENBSjJCLEVBSzNCLENBQUMsS0FBRCxFQUFRLFFBQVIsQ0FMMkIsRUFNM0IsQ0FBQyxLQUFELEVBQVEsV0FBUixDQU4yQixFQU8zQixDQUFDLEtBQUQsRUFBUSxTQUFSLENBUDJCLEVBUTNCLENBQUMs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QTdCOztBQUNBLFdBQUtBLHlCQUFMLEdBQWlDLE1BQU0sQ0FBRSxDQUF6Qzs7QUFDQSxVQUFJO0FBQ0YsY0FBTSxLQUFLeEwsUUFBTCxDQUFjaEcsSUFBZCxDQUFOO0FBQ0QsT0FGRCxTQUVVO0FBQ1IsYUFBS3dSLHlCQUFMLEdBQWlDRCxlQUFqQztBQUNEO0FBQ0Y7O0FBQ0QsVUFBTSxNQUFNRixLQUFOLEVBQU47QUFDRDs7QUExZ0NxQzs7O0FBNmdDeEN0TyxNQUFNLENBQUNDLE1BQVAsQ0FBY25ELGNBQWMsQ0FBQzRSLFNBQTdCLEVBQXdDQyxjQUF4QztlQUVlN1IsYyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJhc2VEcml2ZXIsIERldmljZVNldHRpbmdzIH0gZnJvbSAnYXBwaXVtLWJhc2UtZHJpdmVyJztcbmltcG9ydCB7IHV0aWwsIGZzLCBtanBlZyB9IGZyb20gJ2FwcGl1bS1zdXBwb3J0JztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgdXJsIGZyb20gJ3VybCc7XG5pbXBvcnQgeyBsYXVuY2ggfSBmcm9tICdub2RlLXNpbWN0bCc7XG5pbXBvcnQgV2ViRHJpdmVyQWdlbnQgZnJvbSAnLi93ZGEvd2ViZHJpdmVyYWdlbnQnO1xuaW1wb3J0IGxvZyBmcm9tICcuL2xvZ2dlcic7XG5pbXBvcnQgeyBjcmVhdGVTaW0sIGdldEV4aXN0aW5nU2ltLCBydW5TaW11bGF0b3JSZXNldCwgaW5zdGFsbFRvU2ltdWxhdG9yLFxuICAgICAgICAgc2h1dGRvd25PdGhlclNpbXVsYXRvcnMsIHNodXRkb3duU2ltdWxhdG9yIH0gZnJvbSAnLi9zaW11bGF0b3ItbWFuYWdlbWVudCc7XG5pbXBvcnQgeyBzaW1FeGlzdHMsIGdldFNpbXVsYXRvciwgaW5zdGFsbFNTTENlcnQsIGhhc1NTTENlcnQgfSBmcm9tICdhcHBpdW0taW9zLXNpbXVsYXRvcic7XG5pbXBvcnQgeyByZXRyeUludGVydmFsLCByZXRyeSB9IGZyb20gJ2FzeW5jYm94JztcbmltcG9ydCB7IHNldHRpbmdzIGFzIGlvc1NldHRpbmdzLCBkZWZhdWx0U2VydmVyQ2FwcywgYXBwVXRpbHMsIElXRFAgfSBmcm9tICdhcHBpdW0taW9zLWRyaXZlcic7XG5pbXBvcnQgZGVzaXJlZENhcENvbnN0cmFpbnRzIGZyb20gJy4vZGVzaXJlZC1jYXBzJztcbmltcG9ydCBjb21tYW5kcyBmcm9tICcuL2NvbW1hbmRzL2luZGV4JztcbmltcG9ydCB7IGRldGVjdFVkaWQsIGdldEFuZENoZWNrWGNvZGVWZXJzaW9uLCBnZXRBbmRDaGVja0lvc1Nka1ZlcnNpb24sXG4gICAgICAgICBhZGp1c3RXREFBdHRhY2htZW50c1Blcm1pc3Npb25zLCBjaGVja0FwcFByZXNlbnQsIGdldERyaXZlckluZm8sXG4gICAgICAgICBjbGVhclN5c3RlbUZpbGVzLCB0cmFuc2xhdGVEZXZpY2VOYW1lLCBub3JtYWxpemVDb21tYW5kVGltZW91dHMsXG4gICAgICAgICBERUZBVUxUX1RJTUVPVVRfS0VZLCBtYXJrU3lzdGVtRmlsZXNGb3JDbGVhbnVwLFxuICAgICAgICAgcHJpbnRVc2VyLCByZW1vdmVBbGxTZXNzaW9uV2ViU29ja2V0SGFuZGxlcnMsIHZlcmlmeUFwcGxpY2F0aW9uUGxhdGZvcm0gfSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCB7IGdldENvbm5lY3RlZERldmljZXMsIHJ1blJlYWxEZXZpY2VSZXNldCwgaW5zdGFsbFRvUmVhbERldmljZSxcbiAgICAgICAgIGdldFJlYWxEZXZpY2VPYmogfSBmcm9tICcuL3JlYWwtZGV2aWNlLW1hbmFnZW1lbnQnO1xuaW1wb3J0IEIgZnJvbSAnYmx1ZWJpcmQnO1xuaW1wb3J0IEFzeW5jTG9jayBmcm9tICdhc3luYy1sb2NrJztcblxuXG5jb25zdCBTQUZBUklfQlVORExFX0lEID0gJ2NvbS5hcHBsZS5tb2JpbGVzYWZhcmknO1xuY29uc3QgV0RBX1NJTV9TVEFSVFVQX1JFVFJJRVMgPSAyO1xuY29uc3QgV0RBX1JFQUxfREVWX1NUQVJUVVBfUkVUUklFUyA9IDE7XG5jb25zdCBXREFfUkVBTF9ERVZfVFVUT1JJQUxfVVJMID0gJ2h0dHBzOi8vZ2l0aHViLmNvbS9hcHBpdW0vYXBwaXVtLXhjdWl0ZXN0LWRyaXZlci9ibG9iL21hc3Rlci9kb2NzL3JlYWwtZGV2aWNlLWNvbmZpZy5tZCc7XG5jb25zdCBXREFfU1RBUlRVUF9SRVRSWV9JTlRFUlZBTCA9IDEwMDAwO1xuY29uc3QgREVGQVVMVF9TRVRUSU5HUyA9IHtcbiAgbmF0aXZlV2ViVGFwOiBmYWxzZSxcbiAgdXNlSlNPTlNvdXJjZTogZmFsc2UsXG4gIHNob3VsZFVzZUNvbXBhY3RSZXNwb25zZXM6IHRydWUsXG4gIGVsZW1lbnRSZXNwb25zZUF0dHJpYnV0ZXM6ICd0eXBlLGxhYmVsJyxcbiAgLy8gUmVhZCBodHRwczovL2dpdGh1Yi5jb20vYXBwaXVtL1dlYkRyaXZlckFnZW50L2Jsb2IvbWFzdGVyL1dlYkRyaXZlckFnZW50TGliL1V0aWxpdGllcy9GQkNvbmZpZ3VyYXRpb24ubSBmb3IgZm9sbG93aW5nIHNldHRpbmdzJyB2YWx1ZXNcbiAgbWpwZWdTZXJ2ZXJTY3JlZW5zaG90UXVhbGl0eTogMjUsXG4gIG1qcGVnU2VydmVyRnJhbWVyYXRlOiAxMCxcbiAgc2NyZWVuc2hvdFF1YWxpdHk6IDEsXG59O1xuLy8gVGhpcyBsb2NrIGFzc3VyZXMsIHRoYXQgZWFjaCBkcml2ZXIgc2Vzc2lvbiBkb2VzIG5vdFxuLy8gYWZmZWN0IHNoYXJlZCByZXNvdXJjZXMgb2YgdGhlIG90aGVyIHBhcmFsbGVsIHNlc3Npb25zXG5jb25zdCBTSEFSRURfUkVTT1VSQ0VTX0dVQVJEID0gbmV3IEFzeW5jTG9jaygpO1xuXG4vKiBlc2xpbnQtZGlzYWJsZSBuby11c2VsZXNzLWVzY2FwZSAqL1xuY29uc3QgTk9fUFJPWFlfTkFUSVZFX0xJU1QgPSBbXG4gIFsnREVMRVRFJywgL3dpbmRvdy9dLFxuICBbJ0dFVCcsIC9eXFwvc2Vzc2lvblxcL1teXFwvXSskL10sXG4gIFsnR0VUJywgL2FsZXJ0X3RleHQvXSxcbiAgWydHRVQnLCAvYWxlcnRcXC9bXlxcL10rL10sXG4gIFsnR0VUJywgL2FwcGl1bS9dLFxuICBbJ0dFVCcsIC9hdHRyaWJ1dGUvXSxcbiAgWydHRVQnLCAvY29udGV4dC9dLFxuICBbJ0dFVCcsIC9sb2NhdGlvbi9dLFxuICBbJ0dFVCcsIC9sb2cvXSxcbiAgWydHRVQnLCAvc2NyZWVuc2hvdC9dLFxuICBbJ0dFVCcsIC9zaXplL10sXG4gIFsnR0VUJywgL3NvdXJjZS9dLFxuICBbJ0dFVCcsIC91cmwvXSxcbiAgWydHRVQnLCAvd2luZG93L10sXG4gIFsnUE9TVCcsIC9hY2NlcHRfYWxlcnQvXSxcbiAgWydQT1NUJywgL2FjdGlvbnMkL10sXG4gIFsnUE9TVCcsIC9hbGVydF90ZXh0L10sXG4gIFsnUE9TVCcsIC9hbGVydFxcL1teXFwvXSsvXSxcbiAgWydQT1NUJywgL2FwcGl1bS9dLFxuICBbJ1BPU1QnLCAvYXBwaXVtXFwvZGV2aWNlXFwvaXNfbG9ja2VkL10sXG4gIFsnUE9TVCcsIC9hcHBpdW1cXC9kZXZpY2VcXC9sb2NrL10sXG4gIFsnUE9TVCcsIC9hcHBpdW1cXC9kZXZpY2VcXC91bmxvY2svXSxcbiAgWydQT1NUJywgL2JhY2svXSxcbiAgWydQT1NUJywgL2NsZWFyL10sXG4gIFsnUE9TVCcsIC9jb250ZXh0L10sXG4gIFsnUE9TVCcsIC9kaXNtaXNzX2FsZXJ0L10sXG4gIFsnUE9TVCcsIC9lbGVtZW50JC9dLFxuICBbJ1BPU1QnLCAvZWxlbWVudHMkL10sXG4gIFsnUE9TVCcsIC9leGVjdXRlL10sXG4gIFsnUE9TVCcsIC9rZXlzL10sXG4gIFsnUE9TVCcsIC9sb2cvXSxcbiAgWydQT1NUJywgL21vdmV0by9dLFxuICBbJ1BPU1QnLCAvcmVjZWl2ZV9hc3luY19yZXNwb25zZS9dLCAvLyBhbHdheXMsIGluIGNhc2UgY29udGV4dCBzd2l0Y2hlcyB3aGlsZSB3YWl0aW5nXG4gIFsnUE9TVCcsIC9zZXNzaW9uXFwvW15cXC9dK1xcL2xvY2F0aW9uL10sIC8vIGdlbyBsb2NhdGlvbiwgYnV0IG5vdCBlbGVtZW50IGxvY2F0aW9uXG4gIFsnUE9TVCcsIC9zaGFrZS9dLFxuICBbJ1BPU1QnLCAvdGltZW91dHMvXSxcbiAgWydQT1NUJywgL3RvdWNoL10sXG4gIFsnUE9TVCcsIC91cmwvXSxcbiAgWydQT1NUJywgL3ZhbHVlL10sXG4gIFsnUE9TVCcsIC93aW5kb3cvXSxcbl07XG5jb25zdCBOT19QUk9YWV9XRUJfTElTVCA9IFtcbiAgWydERUxFVEUnLCAvY29va2llL10sXG4gIFsnR0VUJywgL2F0dHJpYnV0ZS9dLFxuICBbJ0dFVCcsIC9jb29raWUvXSxcbiAgWydHRVQnLCAvZWxlbWVudC9dLFxuICBbJ0dFVCcsIC90ZXh0L10sXG4gIFsnR0VUJywgL3RpdGxlL10sXG4gIFsnUE9TVCcsIC9jbGVhci9dLFxuICBbJ1BPU1QnLCAvY2xpY2svXSxcbiAgWydQT1NUJywgL2Nvb2tpZS9dLFxuICBbJ1BPU1QnLCAvZWxlbWVudC9dLFxuICBbJ1BPU1QnLCAvZm9yd2FyZC9dLFxuICBbJ1BPU1QnLCAvZnJhbWUvXSxcbiAgWydQT1NUJywgL2tleXMvXSxcbiAgWydQT1NUJywgL3JlZnJlc2gvXSxcbl0uY29uY2F0KE5PX1BST1hZX05BVElWRV9MSVNUKTtcbi8qIGVzbGludC1lbmFibGUgbm8tdXNlbGVzcy1lc2NhcGUgKi9cblxuY29uc3QgTUVNT0laRURfRlVOQ1RJT05TID0gW1xuICAnZ2V0U3RhdHVzQmFySGVpZ2h0JyxcbiAgJ2dldERldmljZVBpeGVsUmF0aW8nLFxuICAnZ2V0U2NyZWVuSW5mbycsXG4gICdnZXRTYWZhcmlJc0lwaG9uZScsXG4gICdnZXRTYWZhcmlJc0lwaG9uZVgnLFxuXTtcblxuY2xhc3MgWENVSVRlc3REcml2ZXIgZXh0ZW5kcyBCYXNlRHJpdmVyIHtcbiAgY29uc3RydWN0b3IgKG9wdHMgPSB7fSwgc2hvdWxkVmFsaWRhdGVDYXBzID0gdHJ1ZSkge1xuICAgIHN1cGVyKG9wdHMsIHNob3VsZFZhbGlkYXRlQ2Fwcyk7XG5cbiAgICB0aGlzLmRlc2lyZWRDYXBDb25zdHJhaW50cyA9IGRlc2lyZWRDYXBDb25zdHJhaW50cztcblxuICAgIHRoaXMubG9jYXRvclN0cmF0ZWdpZXMgPSBbXG4gICAgICAneHBhdGgnLFxuICAgICAgJ2lkJyxcbiAgICAgICduYW1lJyxcbiAgICAgICdjbGFzcyBuYW1lJyxcbiAgICAgICctaW9zIHByZWRpY2F0ZSBzdHJpbmcnLFxuICAgICAgJy1pb3MgY2xhc3MgY2hhaW4nLFxuICAgICAgJ2FjY2Vzc2liaWxpdHkgaWQnXG4gICAgXTtcbiAgICB0aGlzLndlYkxvY2F0b3JTdHJhdGVnaWVzID0gW1xuICAgICAgJ2xpbmsgdGV4dCcsXG4gICAgICAnY3NzIHNlbGVjdG9yJyxcbiAgICAgICd0YWcgbmFtZScsXG4gICAgICAnbGluayB0ZXh0JyxcbiAgICAgICdwYXJ0aWFsIGxpbmsgdGV4dCdcbiAgICBdO1xuICAgIHRoaXMucmVzZXRJb3MoKTtcbiAgICB0aGlzLnNldHRpbmdzID0gbmV3IERldmljZVNldHRpbmdzKERFRkFVTFRfU0VUVElOR1MsIHRoaXMub25TZXR0aW5nc1VwZGF0ZS5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmxvZ3MgPSB7fTtcblxuICAgIC8vIG1lbW9pemUgZnVuY3Rpb25zIGhlcmUsIHNvIHRoYXQgdGhleSBhcmUgZG9uZSBvbiBhIHBlci1pbnN0YW5jZSBiYXNpc1xuICAgIGZvciAoY29uc3QgZm4gb2YgTUVNT0laRURfRlVOQ1RJT05TKSB7XG4gICAgICB0aGlzW2ZuXSA9IF8ubWVtb2l6ZSh0aGlzW2ZuXSk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgb25TZXR0aW5nc1VwZGF0ZSAoa2V5LCB2YWx1ZSkge1xuICAgIGlmIChrZXkgIT09ICduYXRpdmVXZWJUYXAnKSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5wcm94eUNvbW1hbmQoJy9hcHBpdW0vc2V0dGluZ3MnLCAnUE9TVCcsIHtcbiAgICAgICAgc2V0dGluZ3M6IHtba2V5XTogdmFsdWV9XG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhpcy5vcHRzLm5hdGl2ZVdlYlRhcCA9ICEhdmFsdWU7XG4gIH1cblxuICByZXNldElvcyAoKSB7XG4gICAgdGhpcy5vcHRzID0gdGhpcy5vcHRzIHx8IHt9O1xuICAgIHRoaXMud2RhID0gbnVsbDtcbiAgICB0aGlzLm9wdHMuZGV2aWNlID0gbnVsbDtcbiAgICB0aGlzLmp3cFByb3h5QWN0aXZlID0gZmFsc2U7XG4gICAgdGhpcy5wcm94eVJlcVJlcyA9IG51bGw7XG4gICAgdGhpcy5qd3BQcm94eUF2b2lkID0gW107XG4gICAgdGhpcy5zYWZhcmkgPSBmYWxzZTtcbiAgICB0aGlzLmNhY2hlZFdkYVN0YXR1cyA9IG51bGw7XG5cbiAgICAvLyBzb21lIHRoaW5ncyB0aGF0IGNvbW1hbmRzIGltcG9ydGVkIGZyb20gYXBwaXVtLWlvcy1kcml2ZXIgbmVlZFxuICAgIHRoaXMuY3VyV2ViRnJhbWVzID0gW107XG4gICAgdGhpcy53ZWJFbGVtZW50SWRzID0gW107XG4gICAgdGhpcy5fY3VycmVudFVybCA9IG51bGw7XG4gICAgdGhpcy5jdXJDb250ZXh0ID0gbnVsbDtcbiAgICB0aGlzLnhjb2RlVmVyc2lvbiA9IHt9O1xuICAgIHRoaXMuaW9zU2RrVmVyc2lvbiA9IG51bGw7XG4gICAgdGhpcy5jb250ZXh0cyA9IFtdO1xuICAgIHRoaXMuaW1wbGljaXRXYWl0TXMgPSAwO1xuICAgIHRoaXMuYXN5bmNsaWJXYWl0TXMgPSAwO1xuICAgIHRoaXMucGFnZUxvYWRNcyA9IDYwMDA7XG4gICAgdGhpcy5sYW5kc2NhcGVXZWJDb29yZHNPZmZzZXQgPSAwO1xuICB9XG5cbiAgZ2V0IGRyaXZlckRhdGEgKCkge1xuICAgIC8vIFRPRE8gZmlsbCBvdXQgcmVzb3VyY2UgaW5mbyBoZXJlXG4gICAgcmV0dXJuIHt9O1xuICB9XG5cbiAgYXN5bmMgZ2V0U3RhdHVzICgpIHtcbiAgICBpZiAodHlwZW9mIHRoaXMuZHJpdmVySW5mbyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHRoaXMuZHJpdmVySW5mbyA9IGF3YWl0IGdldERyaXZlckluZm8oKTtcbiAgICB9XG4gICAgbGV0IHN0YXR1cyA9IHtidWlsZDoge3ZlcnNpb246IHRoaXMuZHJpdmVySW5mby52ZXJzaW9ufX07XG4gICAgaWYgKHRoaXMuY2FjaGVkV2RhU3RhdHVzKSB7XG4gICAgICBzdGF0dXMud2RhID0gdGhpcy5jYWNoZWRXZGFTdGF0dXM7XG4gICAgfVxuICAgIHJldHVybiBzdGF0dXM7XG4gIH1cblxuICBhc3luYyBjcmVhdGVTZXNzaW9uICguLi5hcmdzKSB7XG4gICAgdGhpcy5saWZlY3ljbGVEYXRhID0ge307IC8vIHRoaXMgaXMgdXNlZCBmb3Iga2VlcGluZyB0cmFjayBvZiB0aGUgc3RhdGUgd2Ugc3RhcnQgc28gd2hlbiB3ZSBkZWxldGUgdGhlIHNlc3Npb24gd2UgY2FuIHB1dCB0aGluZ3MgYmFja1xuICAgIHRyeSB7XG4gICAgICAvLyBUT0RPIGFkZCB2YWxpZGF0aW9uIG9uIGNhcHNcbiAgICAgIGxldCBbc2Vzc2lvbklkLCBjYXBzXSA9IGF3YWl0IHN1cGVyLmNyZWF0ZVNlc3Npb24oLi4uYXJncyk7XG4gICAgICB0aGlzLm9wdHMuc2Vzc2lvbklkID0gc2Vzc2lvbklkO1xuXG4gICAgICBhd2FpdCB0aGlzLnN0YXJ0KCk7XG5cbiAgICAgIC8vIG1lcmdlIHNlcnZlciBjYXBhYmlsaXRpZXMgKyBkZXNpcmVkIGNhcGFiaWxpdGllc1xuICAgICAgY2FwcyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRTZXJ2ZXJDYXBzLCBjYXBzKTtcbiAgICAgIC8vIHVwZGF0ZSB0aGUgdWRpZCB3aXRoIHdoYXQgaXMgYWN0dWFsbHkgdXNlZFxuICAgICAgY2Fwcy51ZGlkID0gdGhpcy5vcHRzLnVkaWQ7XG4gICAgICAvLyBlbnN1cmUgd2UgdHJhY2sgbmF0aXZlV2ViVGFwIGNhcGFiaWxpdHkgYXMgYSBzZXR0aW5nIGFzIHdlbGxcbiAgICAgIGlmIChfLmhhcyh0aGlzLm9wdHMsICduYXRpdmVXZWJUYXAnKSkge1xuICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZVNldHRpbmdzKHtuYXRpdmVXZWJUYXA6IHRoaXMub3B0cy5uYXRpdmVXZWJUYXB9KTtcbiAgICAgIH1cbiAgICAgIC8vIGVuc3VyZSB3ZSB0cmFjayB1c2VKU09OU291cmNlIGNhcGFiaWxpdHkgYXMgYSBzZXR0aW5nIGFzIHdlbGxcbiAgICAgIGlmIChfLmhhcyh0aGlzLm9wdHMsICd1c2VKU09OU291cmNlJykpIHtcbiAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVTZXR0aW5ncyh7dXNlSlNPTlNvdXJjZTogdGhpcy5vcHRzLnVzZUpTT05Tb3VyY2V9KTtcbiAgICAgIH1cblxuICAgICAgbGV0IHdkYVNldHRpbmdzID0ge1xuICAgICAgICBlbGVtZW50UmVzcG9uc2VBdHRyaWJ1dGVzOiBERUZBVUxUX1NFVFRJTkdTLmVsZW1lbnRSZXNwb25zZUF0dHJpYnV0ZXMsXG4gICAgICAgIHNob3VsZFVzZUNvbXBhY3RSZXNwb25zZXM6IERFRkFVTFRfU0VUVElOR1Muc2hvdWxkVXNlQ29tcGFjdFJlc3BvbnNlcyxcbiAgICAgIH07XG4gICAgICBpZiAoXy5oYXModGhpcy5vcHRzLCAnZWxlbWVudFJlc3BvbnNlQXR0cmlidXRlcycpKSB7XG4gICAgICAgIHdkYVNldHRpbmdzLmVsZW1lbnRSZXNwb25zZUF0dHJpYnV0ZXMgPSB0aGlzLm9wdHMuZWxlbWVudFJlc3BvbnNlQXR0cmlidXRlcztcbiAgICAgIH1cbiAgICAgIGlmIChfLmhhcyh0aGlzLm9wdHMsICdzaG91bGRVc2VDb21wYWN0UmVzcG9uc2VzJykpIHtcbiAgICAgICAgd2RhU2V0dGluZ3Muc2hvdWxkVXNlQ29tcGFjdFJlc3BvbnNlcyA9IHRoaXMub3B0cy5zaG91bGRVc2VDb21wYWN0UmVzcG9uc2VzO1xuICAgICAgfVxuICAgICAgaWYgKF8uaGFzKHRoaXMub3B0cywgJ21qcGVnU2VydmVyU2NyZWVuc2hvdFF1YWxpdHknKSkge1xuICAgICAgICB3ZGFTZXR0aW5ncy5tanBlZ1NlcnZlclNjcmVlbnNob3RRdWFsaXR5ID0gdGhpcy5vcHRzLm1qcGVnU2VydmVyU2NyZWVuc2hvdFF1YWxpdHk7XG4gICAgICB9XG4gICAgICBpZiAoXy5oYXModGhpcy5vcHRzLCAnbWpwZWdTZXJ2ZXJGcmFtZXJhdGUnKSkge1xuICAgICAgICB3ZGFTZXR0aW5ncy5tanBlZ1NlcnZlckZyYW1lcmF0ZSA9IHRoaXMub3B0cy5tanBlZ1NlcnZlckZyYW1lcmF0ZTtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLm9wdHMuc2NyZWVuc2hvdFF1YWxpdHkpIHtcbiAgICAgICAgbG9nLmluZm8oYFNldHRpbmcgdGhlIHF1YWxpdHkgb2YgcGhvbmUgc2NyZWVuc2hvdDogJyR7dGhpcy5vcHRzLnNjcmVlbnNob3RRdWFsaXR5fSdgKTtcbiAgICAgICAgd2RhU2V0dGluZ3Muc2NyZWVuc2hvdFF1YWxpdHkgPSB0aGlzLm9wdHMuc2NyZWVuc2hvdFF1YWxpdHk7XG4gICAgICB9XG4gICAgICAvLyBlbnN1cmUgV0RBIGdldHMgb3VyIGRlZmF1bHRzIGluc3RlYWQgb2Ygd2hhdGV2ZXIgaXRzIG93biBtaWdodCBiZVxuICAgICAgYXdhaXQgdGhpcy51cGRhdGVTZXR0aW5ncyh3ZGFTZXR0aW5ncyk7XG5cbiAgICAgIC8vIHR1cm4gb24gbWpwZWcgc3RyZWFtIHJlYWRpbmcgaWYgcmVxdWVzdGVkXG4gICAgICBpZiAodGhpcy5vcHRzLm1qcGVnU2NyZWVuc2hvdFVybCkge1xuICAgICAgICBsb2cuaW5mbyhgU3RhcnRpbmcgTUpQRUcgc3RyZWFtIHJlYWRpbmcgVVJMOiAnJHt0aGlzLm9wdHMubWpwZWdTY3JlZW5zaG90VXJsfSdgKTtcbiAgICAgICAgdGhpcy5tanBlZ1N0cmVhbSA9IG5ldyBtanBlZy5NSnBlZ1N0cmVhbSh0aGlzLm9wdHMubWpwZWdTY3JlZW5zaG90VXJsKTtcbiAgICAgICAgYXdhaXQgdGhpcy5tanBlZ1N0cmVhbS5zdGFydCgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFtzZXNzaW9uSWQsIGNhcHNdO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvZy5lcnJvcihlKTtcbiAgICAgIGF3YWl0IHRoaXMuZGVsZXRlU2Vzc2lvbigpO1xuICAgICAgdGhyb3cgZTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBzdGFydCAoKSB7XG4gICAgdGhpcy5vcHRzLm5vUmVzZXQgPSAhIXRoaXMub3B0cy5ub1Jlc2V0O1xuICAgIHRoaXMub3B0cy5mdWxsUmVzZXQgPSAhIXRoaXMub3B0cy5mdWxsUmVzZXQ7XG5cbiAgICBhd2FpdCBwcmludFVzZXIoKTtcblxuICAgIGlmICh0aGlzLm9wdHMucGxhdGZvcm1WZXJzaW9uICYmIHBhcnNlRmxvYXQodGhpcy5vcHRzLnBsYXRmb3JtVmVyc2lvbikgPCA5LjMpIHtcbiAgICAgIHRocm93IEVycm9yKGBQbGF0Zm9ybSB2ZXJzaW9uIG11c3QgYmUgOS4zIG9yIGFib3ZlLiAnJHt0aGlzLm9wdHMucGxhdGZvcm1WZXJzaW9ufScgaXMgbm90IHN1cHBvcnRlZC5gKTtcbiAgICB9XG5cbiAgICBjb25zdCB7ZGV2aWNlLCB1ZGlkLCByZWFsRGV2aWNlfSA9IGF3YWl0IHRoaXMuZGV0ZXJtaW5lRGV2aWNlKCk7XG4gICAgbG9nLmluZm8oYERldGVybWluaW5nIGRldmljZSB0byBydW4gdGVzdHMgb246IHVkaWQ6ICcke3VkaWR9JywgcmVhbCBkZXZpY2U6ICR7cmVhbERldmljZX1gKTtcbiAgICB0aGlzLm9wdHMuZGV2aWNlID0gZGV2aWNlO1xuICAgIHRoaXMub3B0cy51ZGlkID0gdWRpZDtcbiAgICB0aGlzLm9wdHMucmVhbERldmljZSA9IHJlYWxEZXZpY2U7XG5cbiAgICBpZiAoXy5pc0VtcHR5KHRoaXMueGNvZGVWZXJzaW9uKSAmJiAoIXRoaXMub3B0cy53ZWJEcml2ZXJBZ2VudFVybCB8fCAhdGhpcy5vcHRzLnJlYWxEZXZpY2UpKSB7XG4gICAgICAvLyBubyBgd2ViRHJpdmVyQWdlbnRVcmxgLCBvciBvbiBhIHNpbXVsYXRvciwgc28gd2UgbmVlZCBhbiBYY29kZSB2ZXJzaW9uXG4gICAgICB0aGlzLnhjb2RlVmVyc2lvbiA9IGF3YWl0IGdldEFuZENoZWNrWGNvZGVWZXJzaW9uKCk7XG4gICAgICBjb25zdCB0b29scyA9ICF0aGlzLnhjb2RlVmVyc2lvbi50b29sc1ZlcnNpb24gPyAnJyA6IGAodG9vbHMgdiR7dGhpcy54Y29kZVZlcnNpb24udG9vbHNWZXJzaW9ufSlgO1xuICAgICAgbG9nLmluZm8oYFhjb2RlIHZlcnNpb24gc2V0IHRvICcke3RoaXMueGNvZGVWZXJzaW9uLnZlcnNpb25TdHJpbmd9JyAke3Rvb2xzfWApO1xuXG4gICAgICB0aGlzLmlvc1Nka1ZlcnNpb24gPSBhd2FpdCBnZXRBbmRDaGVja0lvc1Nka1ZlcnNpb24oKTtcbiAgICAgIGxvZy5pbmZvKGBpT1MgU0RLIFZlcnNpb24gc2V0IHRvICcke3RoaXMuaW9zU2RrVmVyc2lvbn0nYCk7XG4gICAgfVxuICAgIHRoaXMubG9nRXZlbnQoJ3hjb2RlRGV0YWlsc1JldHJpZXZlZCcpO1xuXG4gICAgaWYgKHRoaXMub3B0cy5lbmFibGVBc3luY0V4ZWN1dGVGcm9tSHR0cHMgJiYgIXRoaXMuaXNSZWFsRGV2aWNlKCkpIHtcbiAgICAgIC8vIHNodXRkb3duIHRoZSBzaW11bGF0b3Igc28gdGhhdCB0aGUgc3NsIGNlcnQgaXMgcmVjb2duaXplZFxuICAgICAgYXdhaXQgc2h1dGRvd25TaW11bGF0b3IodGhpcy5vcHRzLmRldmljZSk7XG4gICAgICBhd2FpdCB0aGlzLnN0YXJ0SHR0cHNBc3luY1NlcnZlcigpO1xuICAgIH1cblxuICAgIC8vIGF0IHRoaXMgcG9pbnQgaWYgdGhlcmUgaXMgbm8gcGxhdGZvcm1WZXJzaW9uLCBnZXQgaXQgZnJvbSB0aGUgZGV2aWNlXG4gICAgaWYgKCF0aGlzLm9wdHMucGxhdGZvcm1WZXJzaW9uKSB7XG4gICAgICBpZiAodGhpcy5vcHRzLmRldmljZSAmJiBfLmlzRnVuY3Rpb24odGhpcy5vcHRzLmRldmljZS5nZXRQbGF0Zm9ybVZlcnNpb24pKSB7XG4gICAgICAgIHRoaXMub3B0cy5wbGF0Zm9ybVZlcnNpb24gPSBhd2FpdCB0aGlzLm9wdHMuZGV2aWNlLmdldFBsYXRmb3JtVmVyc2lvbigpO1xuICAgICAgICBsb2cuaW5mbyhgTm8gcGxhdGZvcm1WZXJzaW9uIHNwZWNpZmllZC4gVXNpbmcgZGV2aWNlIHZlcnNpb246ICcke3RoaXMub3B0cy5wbGF0Zm9ybVZlcnNpb259J2ApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gVE9ETzogdGhpcyBpcyB3aGVuIGl0IGlzIGEgcmVhbCBkZXZpY2UuIHdoZW4gd2UgaGF2ZSBhIHJlYWwgb2JqZWN0IHdpcmUgaXQgaW5cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIXRoaXMub3B0cy53ZWJEcml2ZXJBZ2VudFVybCAmJiB0aGlzLmlvc1Nka1ZlcnNpb24pIHtcbiAgICAgIC8vIG1ha2Ugc3VyZSB0aGF0IHRoZSB4Y29kZSB3ZSBhcmUgdXNpbmcgY2FuIGhhbmRsZSB0aGUgcGxhdGZvcm1cbiAgICAgIGlmIChwYXJzZUZsb2F0KHRoaXMub3B0cy5wbGF0Zm9ybVZlcnNpb24pID4gcGFyc2VGbG9hdCh0aGlzLmlvc1Nka1ZlcnNpb24pKSB7XG4gICAgICAgIGxldCBtc2cgPSBgWGNvZGUgJHt0aGlzLnhjb2RlVmVyc2lvbi52ZXJzaW9uU3RyaW5nfSBoYXMgYSBtYXhpbXVtIFNESyB2ZXJzaW9uIG9mICR7dGhpcy5pb3NTZGtWZXJzaW9ufS4gYCArXG4gICAgICAgICAgICAgICAgICBgSXQgZG9lcyBub3Qgc3VwcG9ydCBpT1MgdmVyc2lvbiAke3RoaXMub3B0cy5wbGF0Zm9ybVZlcnNpb259YDtcbiAgICAgICAgbG9nLmVycm9yQW5kVGhyb3cobXNnKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgbG9nLmRlYnVnKCdYY29kZSB2ZXJzaW9uIHdpbGwgbm90IGJlIHZhbGlkYXRlZCBhZ2FpbnN0IGlPUyBTREsgdmVyc2lvbi4nKTtcbiAgICB9XG5cbiAgICBpZiAoKHRoaXMub3B0cy5icm93c2VyTmFtZSB8fCAnJykudG9Mb3dlckNhc2UoKSA9PT0gJ3NhZmFyaScpIHtcbiAgICAgIGxvZy5pbmZvKCdTYWZhcmkgdGVzdCByZXF1ZXN0ZWQnKTtcbiAgICAgIHRoaXMuc2FmYXJpID0gdHJ1ZTtcbiAgICAgIHRoaXMub3B0cy5hcHAgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLm9wdHMucHJvY2Vzc0FyZ3VtZW50cyA9IHRoaXMub3B0cy5wcm9jZXNzQXJndW1lbnRzIHx8IHt9O1xuICAgICAgdGhpcy5vcHRzLmJ1bmRsZUlkID0gU0FGQVJJX0JVTkRMRV9JRDtcbiAgICAgIHRoaXMuX2N1cnJlbnRVcmwgPSB0aGlzLm9wdHMuc2FmYXJpSW5pdGlhbFVybCB8fCAoXG4gICAgICAgIHRoaXMuaXNSZWFsRGV2aWNlKClcbiAgICAgICAgICA/ICdodHRwOi8vYXBwaXVtLmlvJ1xuICAgICAgICAgIDogYGh0dHA6Ly8ke3RoaXMub3B0cy5hZGRyZXNzfToke3RoaXMub3B0cy5wb3J0fS93ZWxjb21lYFxuICAgICAgKTtcbiAgICAgIHRoaXMub3B0cy5wcm9jZXNzQXJndW1lbnRzLmFyZ3MgPSBbJy11JywgdGhpcy5fY3VycmVudFVybF07XG4gICAgfSBlbHNlIHtcbiAgICAgIGF3YWl0IHRoaXMuY29uZmlndXJlQXBwKCk7XG4gICAgfVxuICAgIHRoaXMubG9nRXZlbnQoJ2FwcENvbmZpZ3VyZWQnKTtcblxuICAgIC8vIGZhaWwgdmVyeSBlYXJseSBpZiB0aGUgYXBwIGRvZXNuJ3QgYWN0dWFsbHkgZXhpc3RcbiAgICAvLyBvciBpZiBidW5kbGUgaWQgZG9lc24ndCBwb2ludCB0byBhbiBpbnN0YWxsZWQgYXBwXG4gICAgaWYgKHRoaXMub3B0cy5hcHApIHtcbiAgICAgIGF3YWl0IGNoZWNrQXBwUHJlc2VudCh0aGlzLm9wdHMuYXBwKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMub3B0cy5idW5kbGVJZCkge1xuICAgICAgdGhpcy5vcHRzLmJ1bmRsZUlkID0gYXdhaXQgYXBwVXRpbHMuZXh0cmFjdEJ1bmRsZUlkKHRoaXMub3B0cy5hcHApO1xuICAgIH1cblxuICAgIGF3YWl0IHRoaXMucnVuUmVzZXQoKTtcblxuICAgIGNvbnN0IG1lbW9pemVkTG9nSW5mbyA9IF8ubWVtb2l6ZShmdW5jdGlvbiAoKSB7XG4gICAgICBsb2cuaW5mbyhcIidza2lwTG9nQ2FwdHVyZScgaXMgc2V0LiBTa2lwcGluZyBzdGFydGluZyBsb2dzIHN1Y2ggYXMgY3Jhc2gsIHN5c3RlbSwgc2FmYXJpIGNvbnNvbGUgYW5kIHNhZmFyaSBuZXR3b3JrLlwiKTtcbiAgICB9KTtcbiAgICBjb25zdCBzdGFydExvZ0NhcHR1cmUgPSBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5vcHRzLnNraXBMb2dDYXB0dXJlKSB7XG4gICAgICAgIG1lbW9pemVkTG9nSW5mbygpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuc3RhcnRMb2dDYXB0dXJlKCk7XG4gICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIHRoaXMubG9nRXZlbnQoJ2xvZ0NhcHR1cmVTdGFydGVkJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgY29uc3QgaXNMb2dDYXB0dXJlU3RhcnRlZCA9IGF3YWl0IHN0YXJ0TG9nQ2FwdHVyZSgpO1xuXG4gICAgbG9nLmluZm8oYFNldHRpbmcgdXAgJHt0aGlzLmlzUmVhbERldmljZSgpID8gJ3JlYWwgZGV2aWNlJyA6ICdzaW11bGF0b3InfWApO1xuXG4gICAgaWYgKHRoaXMuaXNTaW11bGF0b3IoKSkge1xuICAgICAgaWYgKHRoaXMub3B0cy5zaHV0ZG93bk90aGVyU2ltdWxhdG9ycykge1xuICAgICAgICBpZiAoIXRoaXMucmVsYXhlZFNlY3VyaXR5RW5hYmxlZCkge1xuICAgICAgICAgIGxvZy5lcnJvckFuZFRocm93KGBBcHBpdW0gc2VydmVyIG11c3QgaGF2ZSByZWxheGVkIHNlY3VyaXR5IGZsYWcgc2V0IGluIG9yZGVyIGAgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBmb3IgJ3NodXRkb3duT3RoZXJTaW11bGF0b3JzJyBjYXBhYmlsaXR5IHRvIHdvcmtgKTtcbiAgICAgICAgfVxuICAgICAgICBhd2FpdCBzaHV0ZG93bk90aGVyU2ltdWxhdG9ycyh0aGlzLm9wdHMuZGV2aWNlKTtcbiAgICAgIH1cblxuICAgICAgLy8gc2V0IHJlZHVjZU1vdGlvbiBpZiBjYXBhYmlsaXR5IGlzIHNldFxuICAgICAgaWYgKHV0aWwuaGFzVmFsdWUodGhpcy5vcHRzLnJlZHVjZU1vdGlvbikpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5vcHRzLmRldmljZS5zZXRSZWR1Y2VNb3Rpb24odGhpcy5vcHRzLnJlZHVjZU1vdGlvbik7XG4gICAgICB9XG5cbiAgICAgIHRoaXMubG9jYWxDb25maWcgPSBhd2FpdCBpb3NTZXR0aW5ncy5zZXRMb2NhbGVBbmRQcmVmZXJlbmNlcyh0aGlzLm9wdHMuZGV2aWNlLCB0aGlzLm9wdHMsIHRoaXMuaXNTYWZhcmkoKSwgYXN5bmMgKHNpbSkgPT4ge1xuICAgICAgICBhd2FpdCBzaHV0ZG93blNpbXVsYXRvcihzaW0pO1xuXG4gICAgICAgIC8vIHdlIGRvbid0IGtub3cgaWYgdGhlcmUgbmVlZHMgdG8gYmUgY2hhbmdlcyBhIHByaW9yaSwgc28gY2hhbmdlIGZpcnN0LlxuICAgICAgICAvLyBzb21ldGltZXMgdGhlIHNodXRkb3duIHByb2Nlc3MgY2hhbmdlcyB0aGUgc2V0dGluZ3MsIHNvIHJlc2V0IHRoZW0sXG4gICAgICAgIC8vIGtub3dpbmcgdGhhdCB0aGUgc2ltIGlzIGFscmVhZHkgc2h1dFxuICAgICAgICBhd2FpdCBpb3NTZXR0aW5ncy5zZXRMb2NhbGVBbmRQcmVmZXJlbmNlcyhzaW0sIHRoaXMub3B0cywgdGhpcy5pc1NhZmFyaSgpKTtcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCB0aGlzLnN0YXJ0U2ltKCk7XG5cbiAgICAgIGlmICh0aGlzLm9wdHMuY3VzdG9tU1NMQ2VydCkge1xuICAgICAgICBpZiAoYXdhaXQgaGFzU1NMQ2VydCh0aGlzLm9wdHMuY3VzdG9tU1NMQ2VydCwgdGhpcy5vcHRzLnVkaWQpKSB7XG4gICAgICAgICAgbG9nLmluZm8oYFNTTCBjZXJ0ICcke18udHJ1bmNhdGUodGhpcy5vcHRzLmN1c3RvbVNTTENlcnQsIHtsZW5ndGg6IDIwfSl9JyBhbHJlYWR5IGluc3RhbGxlZGApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxvZy5pbmZvKGBJbnN0YWxsaW5nIHNzbCBjZXJ0ICcke18udHJ1bmNhdGUodGhpcy5vcHRzLmN1c3RvbVNTTENlcnQsIHtsZW5ndGg6IDIwfSl9J2ApO1xuICAgICAgICAgIGF3YWl0IHNodXRkb3duU2ltdWxhdG9yKHRoaXMub3B0cy5kZXZpY2UpO1xuICAgICAgICAgIGF3YWl0IGluc3RhbGxTU0xDZXJ0KHRoaXMub3B0cy5jdXN0b21TU0xDZXJ0LCB0aGlzLm9wdHMudWRpZCk7XG4gICAgICAgICAgbG9nLmluZm8oYFJlc3RhcnRpbmcgU2ltdWxhdG9yIHNvIHRoYXQgU1NMIGNlcnRpZmljYXRlIGluc3RhbGxhdGlvbiB0YWtlcyBlZmZlY3RgKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnN0YXJ0U2ltKCk7XG4gICAgICAgICAgdGhpcy5sb2dFdmVudCgnY3VzdG9tQ2VydEluc3RhbGxlZCcpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRoaXMubG9nRXZlbnQoJ3NpbVN0YXJ0ZWQnKTtcbiAgICAgIGlmICghaXNMb2dDYXB0dXJlU3RhcnRlZCkge1xuICAgICAgICAvLyBSZXRyeSBsb2cgY2FwdHVyZSBpZiBTaW11bGF0b3Igd2FzIG5vdCBydW5uaW5nIGJlZm9yZVxuICAgICAgICBhd2FpdCBzdGFydExvZ0NhcHR1cmUoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5vcHRzLmFwcCkge1xuICAgICAgYXdhaXQgdGhpcy5pbnN0YWxsQVVUKCk7XG4gICAgICB0aGlzLmxvZ0V2ZW50KCdhcHBJbnN0YWxsZWQnKTtcbiAgICB9XG5cbiAgICAvLyBpZiB3ZSBvbmx5IGhhdmUgYnVuZGxlIGlkZW50aWZpZXIgYW5kIG5vIGFwcCwgZmFpbCBpZiBpdCBpcyBub3QgYWxyZWFkeSBpbnN0YWxsZWRcbiAgICBpZiAoIXRoaXMub3B0cy5hcHAgJiYgdGhpcy5vcHRzLmJ1bmRsZUlkICYmICF0aGlzLnNhZmFyaSkge1xuICAgICAgaWYgKCFhd2FpdCB0aGlzLm9wdHMuZGV2aWNlLmlzQXBwSW5zdGFsbGVkKHRoaXMub3B0cy5idW5kbGVJZCkpIHtcbiAgICAgICAgbG9nLmVycm9yQW5kVGhyb3coYEFwcCB3aXRoIGJ1bmRsZSBpZGVudGlmaWVyICcke3RoaXMub3B0cy5idW5kbGVJZH0nIHVua25vd25gKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5vcHRzLnBlcm1pc3Npb25zKSB7XG4gICAgICBpZiAodGhpcy5pc1NpbXVsYXRvcigpKSB7XG4gICAgICAgIGxvZy5kZWJ1ZygnU2V0dGluZyB0aGUgcmVxdWVzdGVkIHBlcm1pc3Npb25zIGJlZm9yZSBXREEgaXMgc3RhcnRlZCcpO1xuICAgICAgICBmb3IgKGNvbnN0IFtidW5kbGVJZCwgcGVybWlzc2lvbnNNYXBwaW5nXSBvZiBfLnRvUGFpcnMoSlNPTi5wYXJzZSh0aGlzLm9wdHMucGVybWlzc2lvbnMpKSkge1xuICAgICAgICAgIGF3YWl0IHRoaXMub3B0cy5kZXZpY2Uuc2V0UGVybWlzc2lvbnMoYnVuZGxlSWQsIHBlcm1pc3Npb25zTWFwcGluZyk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvZy53YXJuKCdTZXR0aW5nIHBlcm1pc3Npb25zIGlzIG9ubHkgc3VwcG9ydGVkIG9uIFNpbXVsYXRvci4gJyArXG4gICAgICAgICAgJ1RoZSBcInBlcm1pc3Npb25zXCIgY2FwYWJpbGl0eSB3aWxsIGJlIGlnbm9yZWQuJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgYXdhaXQgU0hBUkVEX1JFU09VUkNFU19HVUFSRC5hY3F1aXJlKFhDVUlUZXN0RHJpdmVyLm5hbWUsXG4gICAgICBhc3luYyAoKSA9PiBhd2FpdCB0aGlzLnN0YXJ0V2RhKHRoaXMub3B0cy5zZXNzaW9uSWQsIHJlYWxEZXZpY2UpKTtcblxuICAgIGF3YWl0IHRoaXMuc2V0SW5pdGlhbE9yaWVudGF0aW9uKHRoaXMub3B0cy5vcmllbnRhdGlvbik7XG4gICAgdGhpcy5sb2dFdmVudCgnb3JpZW50YXRpb25TZXQnKTtcblxuICAgIGlmICh0aGlzLmlzUmVhbERldmljZSgpICYmIHRoaXMub3B0cy5zdGFydElXRFApIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc3RhcnRJV0RQKCk7XG4gICAgICAgIGxvZy5kZWJ1ZyhgU3RhcnRlZCBpb3Nfd2Via2l0X2RlYnVnIHByb3h5IHNlcnZlciBhdDogJHt0aGlzLml3ZHBTZXJ2ZXIuZW5kcG9pbnR9YCk7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgbG9nLmVycm9yQW5kVGhyb3coYENvdWxkIG5vdCBzdGFydCBpb3Nfd2Via2l0X2RlYnVnX3Byb3h5IHNlcnZlcjogJHtlcnIubWVzc2FnZX1gKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5pc1NhZmFyaSgpIHx8IHRoaXMub3B0cy5hdXRvV2Vidmlldykge1xuICAgICAgbG9nLmRlYnVnKCdXYWl0aW5nIGZvciBpbml0aWFsIHdlYnZpZXcnKTtcbiAgICAgIGF3YWl0IHRoaXMubmF2VG9Jbml0aWFsV2VidmlldygpO1xuICAgICAgdGhpcy5sb2dFdmVudCgnaW5pdGlhbFdlYnZpZXdOYXZpZ2F0ZWQnKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuaXNSZWFsRGV2aWNlKCkpIHtcbiAgICAgIGlmICh0aGlzLm9wdHMuY2FsZW5kYXJBY2Nlc3NBdXRob3JpemVkKSB7XG4gICAgICAgIGF3YWl0IHRoaXMub3B0cy5kZXZpY2UuZW5hYmxlQ2FsZW5kYXJBY2Nlc3ModGhpcy5vcHRzLmJ1bmRsZUlkKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5vcHRzLmNhbGVuZGFyQWNjZXNzQXV0aG9yaXplZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5vcHRzLmRldmljZS5kaXNhYmxlQ2FsZW5kYXJBY2Nlc3ModGhpcy5vcHRzLmJ1bmRsZUlkKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU3RhcnQgV2ViRHJpdmVyQWdlbnRSdW5uZXJcbiAgICogQHBhcmFtIHtzdHJpbmd9IHNlc3Npb25JZCAtIFRoZSBpZCBvZiB0aGUgdGFyZ2V0IHNlc3Npb24gdG8gbGF1bmNoIFdEQSB3aXRoLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IHJlYWxEZXZpY2UgLSBFcXVhbHMgdG8gdHJ1ZSBpZiB0aGUgdGVzdCB0YXJnZXQgZGV2aWNlIGlzIGEgcmVhbCBkZXZpY2UuXG4gICAqL1xuICBhc3luYyBzdGFydFdkYSAoc2Vzc2lvbklkLCByZWFsRGV2aWNlKSB7XG4gICAgdGhpcy53ZGEgPSBuZXcgV2ViRHJpdmVyQWdlbnQodGhpcy54Y29kZVZlcnNpb24sIHRoaXMub3B0cyk7XG5cbiAgICBhd2FpdCB0aGlzLndkYS5jbGVhbnVwT2Jzb2xldGVQcm9jZXNzZXMoKTtcblxuICAgIGlmICh0aGlzLm9wdHMudXNlTmV3V0RBKSB7XG4gICAgICBsb2cuZGVidWcoYENhcGFiaWxpdHkgJ3VzZU5ld1dEQScgc2V0IHRvIHRydWUsIHNvIHVuaW5zdGFsbGluZyBXREEgYmVmb3JlIHByb2NlZWRpbmdgKTtcbiAgICAgIGF3YWl0IHRoaXMud2RhLnF1aXRBbmRVbmluc3RhbGwoKTtcbiAgICAgIHRoaXMubG9nRXZlbnQoJ3dkYVVuaW5zdGFsbGVkJyk7XG4gICAgfSBlbHNlIGlmICghdXRpbC5oYXNWYWx1ZSh0aGlzLndkYS53ZWJEcml2ZXJBZ2VudFVybCkpIHtcbiAgICAgIGF3YWl0IHRoaXMud2RhLnNldHVwQ2FjaGluZyh0aGlzLm9wdHMudXBkYXRlZFdEQUJ1bmRsZUlkKTtcbiAgICB9XG5cbiAgICAvLyBsb2NhbCBoZWxwZXIgZm9yIHRoZSB0d28gcGxhY2VzIHdlIG5lZWQgdG8gdW5pbnN0YWxsIHdkYSBhbmQgcmUtc3RhcnQgaXRcbiAgICBjb25zdCBxdWl0QW5kVW5pbnN0YWxsID0gYXN5bmMgKG1zZykgPT4ge1xuICAgICAgbG9nLmRlYnVnKG1zZyk7XG4gICAgICBpZiAodGhpcy5vcHRzLndlYkRyaXZlckFnZW50VXJsKSB7XG4gICAgICAgIGxvZy5kZWJ1ZygnTm90IHF1aXR0aW5nL3VuaW5zdGFsbGluZyBXZWJEcml2ZXJBZ2VudCBzaW5jZSB3ZWJEcml2ZXJBZ2VudFVybCBjYXBhYmlsaXR5IGlzIHByb3ZpZGVkJyk7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihtc2cpO1xuICAgICAgfVxuICAgICAgbG9nLndhcm4oJ1F1aXR0aW5nIGFuZCB1bmluc3RhbGxpbmcgV2ViRHJpdmVyQWdlbnQnKTtcbiAgICAgIGF3YWl0IHRoaXMud2RhLnF1aXRBbmRVbmluc3RhbGwoKTtcblxuICAgICAgdGhyb3cgbmV3IEVycm9yKG1zZyk7XG4gICAgfTtcblxuICAgIGNvbnN0IHN0YXJ0dXBSZXRyaWVzID0gdGhpcy5vcHRzLndkYVN0YXJ0dXBSZXRyaWVzIHx8ICh0aGlzLmlzUmVhbERldmljZSgpID8gV0RBX1JFQUxfREVWX1NUQVJUVVBfUkVUUklFUyA6IFdEQV9TSU1fU1RBUlRVUF9SRVRSSUVTKTtcbiAgICBjb25zdCBzdGFydHVwUmV0cnlJbnRlcnZhbCA9IHRoaXMub3B0cy53ZGFTdGFydHVwUmV0cnlJbnRlcnZhbCB8fCBXREFfU1RBUlRVUF9SRVRSWV9JTlRFUlZBTDtcbiAgICBsb2cuZGVidWcoYFRyeWluZyB0byBzdGFydCBXZWJEcml2ZXJBZ2VudCAke3N0YXJ0dXBSZXRyaWVzfSB0aW1lcyB3aXRoICR7c3RhcnR1cFJldHJ5SW50ZXJ2YWx9bXMgaW50ZXJ2YWxgKTtcbiAgICBpZiAoIXV0aWwuaGFzVmFsdWUodGhpcy5vcHRzLndkYVN0YXJ0dXBSZXRyaWVzKSAmJiAhdXRpbC5oYXNWYWx1ZSh0aGlzLm9wdHMud2RhU3RhcnR1cFJldHJ5SW50ZXJ2YWwpKSB7XG4gICAgICBsb2cuZGVidWcoYFRoZXNlIHZhbHVlcyBjYW4gYmUgY3VzdG9taXplZCBieSBjaGFuZ2luZyB3ZGFTdGFydHVwUmV0cmllcy93ZGFTdGFydHVwUmV0cnlJbnRlcnZhbCBjYXBhYmlsaXRpZXNgKTtcbiAgICB9XG4gICAgbGV0IHJldHJ5Q291bnQgPSAwO1xuICAgIGF3YWl0IHJldHJ5SW50ZXJ2YWwoc3RhcnR1cFJldHJpZXMsIHN0YXJ0dXBSZXRyeUludGVydmFsLCBhc3luYyAoKSA9PiB7XG4gICAgICB0aGlzLmxvZ0V2ZW50KCd3ZGFTdGFydEF0dGVtcHRlZCcpO1xuICAgICAgaWYgKHJldHJ5Q291bnQgPiAwKSB7XG4gICAgICAgIGxvZy5pbmZvKGBSZXRyeWluZyBXREEgc3RhcnR1cCAoJHtyZXRyeUNvdW50ICsgMX0gb2YgJHtzdGFydHVwUmV0cmllc30pYCk7XG4gICAgICB9XG4gICAgICB0cnkge1xuICAgICAgICAvLyBvbiB4Y29kZSAxMCBpbnN0YWxsZCB3aWxsIG9mdGVuIHRyeSB0byBhY2Nlc3MgdGhlIGFwcCBmcm9tIGl0cyBzdGFnaW5nXG4gICAgICAgIC8vIGRpcmVjdG9yeSBiZWZvcmUgZnVsbHkgbW92aW5nIGl0IHRoZXJlLCBhbmQgZmFpbC4gUmV0cnlpbmcgb25jZVxuICAgICAgICAvLyBpbW1lZGlhdGVseSBoZWxwc1xuICAgICAgICBjb25zdCByZXRyaWVzID0gdGhpcy54Y29kZVZlcnNpb24ubWFqb3IgPj0gMTAgPyAyIDogMTtcbiAgICAgICAgdGhpcy5jYWNoZWRXZGFTdGF0dXMgPSBhd2FpdCByZXRyeShyZXRyaWVzLCB0aGlzLndkYS5sYXVuY2guYmluZCh0aGlzLndkYSksIHNlc3Npb25JZCwgcmVhbERldmljZSk7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgdGhpcy5sb2dFdmVudCgnd2RhU3RhcnRGYWlsZWQnKTtcbiAgICAgICAgcmV0cnlDb3VudCsrO1xuICAgICAgICBsZXQgZXJyb3JNc2cgPSBgVW5hYmxlIHRvIGxhdW5jaCBXZWJEcml2ZXJBZ2VudCBiZWNhdXNlIG9mIHhjb2RlYnVpbGQgZmFpbHVyZTogXCIke2Vyci5tZXNzYWdlfVwiLmA7XG4gICAgICAgIGlmICh0aGlzLmlzUmVhbERldmljZSgpKSB7XG4gICAgICAgICAgZXJyb3JNc2cgKz0gYCBNYWtlIHN1cmUgeW91IGZvbGxvdyB0aGUgdHV0b3JpYWwgYXQgJHtXREFfUkVBTF9ERVZfVFVUT1JJQUxfVVJMfS4gYCArXG4gICAgICAgICAgICAgICAgICAgICAgYFRyeSB0byByZW1vdmUgdGhlIFdlYkRyaXZlckFnZW50UnVubmVyIGFwcGxpY2F0aW9uIGZyb20gdGhlIGRldmljZSBpZiBpdCBpcyBpbnN0YWxsZWQgYCArXG4gICAgICAgICAgICAgICAgICAgICAgYGFuZCByZWJvb3QgdGhlIGRldmljZS5gO1xuICAgICAgICB9XG4gICAgICAgIGF3YWl0IHF1aXRBbmRVbmluc3RhbGwoZXJyb3JNc2cpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnByb3h5UmVxUmVzID0gdGhpcy53ZGEucHJveHlSZXFSZXMuYmluZCh0aGlzLndkYSk7XG4gICAgICB0aGlzLmp3cFByb3h5QWN0aXZlID0gdHJ1ZTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgcmV0cnlJbnRlcnZhbCgxNSwgMTAwMCwgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgIHRoaXMubG9nRXZlbnQoJ3dkYVNlc3Npb25BdHRlbXB0ZWQnKTtcbiAgICAgICAgICBsb2cuZGVidWcoJ1NlbmRpbmcgY3JlYXRlU2Vzc2lvbiBjb21tYW5kIHRvIFdEQScpO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLmNhY2hlZFdkYVN0YXR1cyA9IHRoaXMuY2FjaGVkV2RhU3RhdHVzIHx8IGF3YWl0IHRoaXMucHJveHlDb21tYW5kKCcvc3RhdHVzJywgJ0dFVCcpO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5zdGFydFdkYVNlc3Npb24odGhpcy5vcHRzLmJ1bmRsZUlkLCB0aGlzLm9wdHMucHJvY2Vzc0FyZ3VtZW50cyk7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBsb2cuZGVidWcoYEZhaWxlZCB0byBjcmVhdGUgV0RBIHNlc3Npb24gKCR7ZXJyLm1lc3NhZ2V9KS4gUmV0cnlpbmcuLi5gKTtcbiAgICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmxvZ0V2ZW50KCd3ZGFTZXNzaW9uU3RhcnRlZCcpO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGxldCBlcnJvck1zZyA9IGBVbmFibGUgdG8gc3RhcnQgV2ViRHJpdmVyQWdlbnQgc2Vzc2lvbiBiZWNhdXNlIG9mIHhjb2RlYnVpbGQgZmFpbHVyZTogJHtlcnIubWVzc2FnZX1gO1xuICAgICAgICBpZiAodGhpcy5pc1JlYWxEZXZpY2UoKSkge1xuICAgICAgICAgIGVycm9yTXNnICs9IGAgTWFrZSBzdXJlIHlvdSBmb2xsb3cgdGhlIHR1dG9yaWFsIGF0ICR7V0RBX1JFQUxfREVWX1RVVE9SSUFMX1VSTH0uIGAgK1xuICAgICAgICAgICAgICAgICAgICAgIGBUcnkgdG8gcmVtb3ZlIHRoZSBXZWJEcml2ZXJBZ2VudFJ1bm5lciBhcHBsaWNhdGlvbiBmcm9tIHRoZSBkZXZpY2UgaWYgaXQgaXMgaW5zdGFsbGVkIGAgK1xuICAgICAgICAgICAgICAgICAgICAgIGBhbmQgcmVib290IHRoZSBkZXZpY2UuYDtcbiAgICAgICAgfVxuICAgICAgICBhd2FpdCBxdWl0QW5kVW5pbnN0YWxsKGVycm9yTXNnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCF1dGlsLmhhc1ZhbHVlKHRoaXMub3B0cy5wcmV2ZW50V0RBQXR0YWNobWVudHMpKSB7XG4gICAgICAgIC8vIFhDVGVzdCBwcmlvciB0byBYY29kZSA5IFNESyBoYXMgbm8gbmF0aXZlIHdheSB0byBkaXNhYmxlIGF0dGFjaG1lbnRzXG4gICAgICAgIHRoaXMub3B0cy5wcmV2ZW50V0RBQXR0YWNobWVudHMgPSB0aGlzLnhjb2RlVmVyc2lvbi5tYWpvciA8IDk7XG4gICAgICAgIGlmICh0aGlzLm9wdHMucHJldmVudFdEQUF0dGFjaG1lbnRzKSB7XG4gICAgICAgICAgbG9nLmluZm8oJ0VuYWJsZWQgV0RBIGF0dGFjaG1lbnRzIHByZXZlbnRpb24gYnkgZGVmYXVsdCB0byBzYXZlIHRoZSBkaXNrIHNwYWNlLiAnICtcbiAgICAgICAgICAgICAgICAgICBgU2V0ICdwcmV2ZW50V0RBQXR0YWNobWVudHMnIGNhcGFiaWxpdHkgdG8gZmFsc2UgaWYgdGhpcyBpcyBhbiB1bmRlc2lyZWQgYmVoYXZpb3IuYCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLm9wdHMucHJldmVudFdEQUF0dGFjaG1lbnRzKSB7XG4gICAgICAgIGF3YWl0IGFkanVzdFdEQUF0dGFjaG1lbnRzUGVybWlzc2lvbnModGhpcy53ZGEsIHRoaXMub3B0cy5wcmV2ZW50V0RBQXR0YWNobWVudHMgPyAnNTU1JyA6ICc3NTUnKTtcbiAgICAgICAgdGhpcy5sb2dFdmVudCgnd2RhUGVybXNBZGp1c3RlZCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5vcHRzLmNsZWFyU3lzdGVtRmlsZXMpIHtcbiAgICAgICAgYXdhaXQgbWFya1N5c3RlbUZpbGVzRm9yQ2xlYW51cCh0aGlzLndkYSk7XG4gICAgICB9XG5cbiAgICAgIC8vIHdlIGV4cGVjdCBjZXJ0YWluIHNvY2tldCBlcnJvcnMgdW50aWwgdGhpcyBwb2ludCwgYnV0IG5vd1xuICAgICAgLy8gbWFyayB0aGluZ3MgYXMgZnVsbHkgd29ya2luZ1xuICAgICAgdGhpcy53ZGEuZnVsbHlTdGFydGVkID0gdHJ1ZTtcbiAgICAgIHRoaXMubG9nRXZlbnQoJ3dkYVN0YXJ0ZWQnKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIHJ1blJlc2V0IChvcHRzID0gbnVsbCkge1xuICAgIHRoaXMubG9nRXZlbnQoJ3Jlc2V0U3RhcnRlZCcpO1xuICAgIGlmICh0aGlzLmlzUmVhbERldmljZSgpKSB7XG4gICAgICBhd2FpdCBydW5SZWFsRGV2aWNlUmVzZXQodGhpcy5vcHRzLmRldmljZSwgb3B0cyB8fCB0aGlzLm9wdHMpO1xuICAgIH0gZWxzZSB7XG4gICAgICBhd2FpdCBydW5TaW11bGF0b3JSZXNldCh0aGlzLm9wdHMuZGV2aWNlLCBvcHRzIHx8IHRoaXMub3B0cyk7XG4gICAgfVxuICAgIHRoaXMubG9nRXZlbnQoJ3Jlc2V0Q29tcGxldGUnKTtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZVNlc3Npb24gKCkge1xuICAgIGF3YWl0IHJlbW92ZUFsbFNlc3Npb25XZWJTb2NrZXRIYW5kbGVycyh0aGlzLnNlcnZlciwgdGhpcy5zZXNzaW9uSWQpO1xuXG4gICAgYXdhaXQgU0hBUkVEX1JFU09VUkNFU19HVUFSRC5hY3F1aXJlKFhDVUlUZXN0RHJpdmVyLm5hbWUsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IHRoaXMuc3RvcCgpO1xuXG4gICAgICAvLyByZXNldCB0aGUgcGVybWlzc2lvbnMgb24gdGhlIGRlcml2ZWQgZGF0YSBmb2xkZXIsIGlmIG5lY2Vzc2FyeVxuICAgICAgaWYgKHRoaXMub3B0cy5wcmV2ZW50V0RBQXR0YWNobWVudHMpIHtcbiAgICAgICAgYXdhaXQgYWRqdXN0V0RBQXR0YWNobWVudHNQZXJtaXNzaW9ucyh0aGlzLndkYSwgJzc1NScpO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5vcHRzLmNsZWFyU3lzdGVtRmlsZXMpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNBcHBUZW1wb3JhcnkpIHtcbiAgICAgICAgICBhd2FpdCBmcy5yaW1yYWYodGhpcy5vcHRzLmFwcCk7XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgY2xlYXJTeXN0ZW1GaWxlcyh0aGlzLndkYSwgISF0aGlzLm9wdHMuc2hvd1hjb2RlTG9nKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvZy5kZWJ1ZygnTm90IGNsZWFyaW5nIGxvZyBmaWxlcy4gVXNlIGBjbGVhclN5c3RlbUZpbGVzYCBjYXBhYmlsaXR5IHRvIHR1cm4gb24uJyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAodGhpcy5pc1dlYkNvbnRleHQoKSkge1xuICAgICAgbG9nLmRlYnVnKCdJbiBhIHdlYiBzZXNzaW9uLiBSZW1vdmluZyByZW1vdGUgZGVidWdnZXInKTtcbiAgICAgIGF3YWl0IHRoaXMuc3RvcFJlbW90ZSgpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLm9wdHMucmVzZXRPblNlc3Npb25TdGFydE9ubHkgPT09IGZhbHNlKSB7XG4gICAgICBhd2FpdCB0aGlzLnJ1blJlc2V0KCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNTaW11bGF0b3IoKSAmJiAhdGhpcy5vcHRzLm5vUmVzZXQgJiYgISF0aGlzLm9wdHMuZGV2aWNlKSB7XG4gICAgICBpZiAodGhpcy5saWZlY3ljbGVEYXRhLmNyZWF0ZVNpbSkge1xuICAgICAgICBsb2cuZGVidWcoYERlbGV0aW5nIHNpbXVsYXRvciBjcmVhdGVkIGZvciB0aGlzIHJ1biAodWRpZDogJyR7dGhpcy5vcHRzLnVkaWR9JylgKTtcbiAgICAgICAgYXdhaXQgc2h1dGRvd25TaW11bGF0b3IodGhpcy5vcHRzLmRldmljZSk7XG4gICAgICAgIGF3YWl0IHRoaXMub3B0cy5kZXZpY2UuZGVsZXRlKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFfLmlzRW1wdHkodGhpcy5sb2dzKSkge1xuICAgICAgYXdhaXQgdGhpcy5sb2dzLnN5c2xvZy5zdG9wQ2FwdHVyZSgpO1xuICAgICAgdGhpcy5sb2dzID0ge307XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXdkcFNlcnZlcikge1xuICAgICAgYXdhaXQgdGhpcy5zdG9wSVdEUCgpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLm9wdHMuZW5hYmxlQXN5bmNFeGVjdXRlRnJvbUh0dHBzICYmICF0aGlzLmlzUmVhbERldmljZSgpKSB7XG4gICAgICBhd2FpdCB0aGlzLnN0b3BIdHRwc0FzeW5jU2VydmVyKCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMubWpwZWdTdHJlYW0pIHtcbiAgICAgIGxvZy5pbmZvKCdDbG9zaW5nIE1KUEVHIHN0cmVhbScpO1xuICAgICAgdGhpcy5tanBlZ1N0cmVhbS5zdG9wKCk7XG4gICAgfVxuXG4gICAgdGhpcy5yZXNldElvcygpO1xuXG4gICAgYXdhaXQgc3VwZXIuZGVsZXRlU2Vzc2lvbigpO1xuICB9XG5cbiAgYXN5bmMgc3RvcCAoKSB7XG4gICAgdGhpcy5qd3BQcm94eUFjdGl2ZSA9IGZhbHNlO1xuICAgIHRoaXMucHJveHlSZXFSZXMgPSBudWxsO1xuXG4gICAgaWYgKHRoaXMud2RhICYmIHRoaXMud2RhLmZ1bGx5U3RhcnRlZCkge1xuICAgICAgaWYgKHRoaXMud2RhLmp3cHJveHkpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCB0aGlzLnByb3h5Q29tbWFuZChgL3Nlc3Npb24vJHt0aGlzLnNlc3Npb25JZH1gLCAnREVMRVRFJyk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIC8vIGFuIGVycm9yIGhlcmUgc2hvdWxkIG5vdCBzaG9ydC1jaXJjdWl0IHRoZSByZXN0IG9mIGNsZWFuIHVwXG4gICAgICAgICAgbG9nLmRlYnVnKGBVbmFibGUgdG8gREVMRVRFIHNlc3Npb24gb24gV0RBOiAnJHtlcnIubWVzc2FnZX0nLiBDb250aW51aW5nIHNodXRkb3duLmApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAodGhpcy53ZGEgJiYgIXRoaXMud2RhLndlYkRyaXZlckFnZW50VXJsICYmIHRoaXMub3B0cy51c2VOZXdXREEpIHtcbiAgICAgICAgYXdhaXQgdGhpcy53ZGEucXVpdCgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGV4ZWN1dGVDb21tYW5kIChjbWQsIC4uLmFyZ3MpIHtcbiAgICBsb2cuZGVidWcoYEV4ZWN1dGluZyBjb21tYW5kICcke2NtZH0nYCk7XG5cbiAgICBpZiAoY21kID09PSAncmVjZWl2ZUFzeW5jUmVzcG9uc2UnKSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5yZWNlaXZlQXN5bmNSZXNwb25zZSguLi5hcmdzKTtcbiAgICB9XG4gICAgLy8gVE9ETzogb25jZSB0aGlzIGZpeCBnZXRzIGludG8gYmFzZSBkcml2ZXIgcmVtb3ZlIGZyb20gaGVyZVxuICAgIGlmIChjbWQgPT09ICdnZXRTdGF0dXMnKSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5nZXRTdGF0dXMoKTtcbiAgICB9XG4gICAgcmV0dXJuIGF3YWl0IHN1cGVyLmV4ZWN1dGVDb21tYW5kKGNtZCwgLi4uYXJncyk7XG4gIH1cblxuICBhc3luYyBjb25maWd1cmVBcHAgKCkge1xuICAgIGZ1bmN0aW9uIGFwcElzUGFja2FnZU9yQnVuZGxlIChhcHApIHtcbiAgICAgIHJldHVybiAoL14oW2EtekEtWjAtOVxcLV9dK1xcLlthLXpBLVowLTlcXC1fXSspKyQvKS50ZXN0KGFwcCk7XG4gICAgfVxuXG4gICAgLy8gdGhlIGFwcCBuYW1lIGlzIGEgYnVuZGxlSWQgYXNzaWduIGl0IHRvIHRoZSBidW5kbGVJZCBwcm9wZXJ0eVxuICAgIGlmICghdGhpcy5vcHRzLmJ1bmRsZUlkICYmIGFwcElzUGFja2FnZU9yQnVuZGxlKHRoaXMub3B0cy5hcHApKSB7XG4gICAgICB0aGlzLm9wdHMuYnVuZGxlSWQgPSB0aGlzLm9wdHMuYXBwO1xuICAgICAgdGhpcy5vcHRzLmFwcCA9ICcnO1xuICAgIH1cbiAgICAvLyB3ZSBoYXZlIGEgYnVuZGxlIElELCBidXQgbm8gYXBwLCBvciBhcHAgaXMgYWxzbyBhIGJ1bmRsZVxuICAgIGlmICgodGhpcy5vcHRzLmJ1bmRsZUlkICYmIGFwcElzUGFja2FnZU9yQnVuZGxlKHRoaXMub3B0cy5idW5kbGVJZCkpICYmXG4gICAgICAgICh0aGlzLm9wdHMuYXBwID09PSAnJyB8fCBhcHBJc1BhY2thZ2VPckJ1bmRsZSh0aGlzLm9wdHMuYXBwKSkpIHtcbiAgICAgIGxvZy5kZWJ1ZygnQXBwIGlzIGFuIGlPUyBidW5kbGUsIHdpbGwgYXR0ZW1wdCB0byBydW4gYXMgcHJlLWV4aXN0aW5nJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gY2hlY2sgZm9yIHN1cHBvcnRlZCBidWlsZC1pbiBhcHBzXG4gICAgaWYgKHRoaXMub3B0cy5hcHAgJiYgdGhpcy5vcHRzLmFwcC50b0xvd2VyQ2FzZSgpID09PSAnc2V0dGluZ3MnKSB7XG4gICAgICB0aGlzLm9wdHMuYnVuZGxlSWQgPSAnY29tLmFwcGxlLlByZWZlcmVuY2VzJztcbiAgICAgIHRoaXMub3B0cy5hcHAgPSBudWxsO1xuICAgICAgcmV0dXJuO1xuICAgIH0gZWxzZSBpZiAodGhpcy5vcHRzLmFwcCAmJiB0aGlzLm9wdHMuYXBwLnRvTG93ZXJDYXNlKCkgPT09ICdjYWxlbmRhcicpIHtcbiAgICAgIHRoaXMub3B0cy5idW5kbGVJZCA9ICdjb20uYXBwbGUubW9iaWxlY2FsJztcbiAgICAgIHRoaXMub3B0cy5hcHAgPSBudWxsO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IG9yaWdpbmFsQXBwUGF0aCA9IHRoaXMub3B0cy5hcHA7XG4gICAgdHJ5IHtcbiAgICAgIC8vIGRvd25sb2FkIGlmIG5lY2Vzc2FyeVxuICAgICAgdGhpcy5vcHRzLmFwcCA9IGF3YWl0IHRoaXMuaGVscGVycy5jb25maWd1cmVBcHAodGhpcy5vcHRzLmFwcCwgJy5hcHAnKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGxvZy5lcnJvcihlcnIpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBCYWQgYXBwOiAke3RoaXMub3B0cy5hcHB9LiBBcHAgcGF0aHMgbmVlZCB0byBiZSBhYnNvbHV0ZSBvciBhbiBVUkwgdG8gYSBjb21wcmVzc2VkIGZpbGVgKTtcbiAgICB9XG4gICAgdGhpcy5pc0FwcFRlbXBvcmFyeSA9IHRoaXMub3B0cy5hcHAgJiYgYXdhaXQgZnMuZXhpc3RzKHRoaXMub3B0cy5hcHApXG4gICAgICAmJiAhYXdhaXQgdXRpbC5pc1NhbWVEZXN0aW5hdGlvbihvcmlnaW5hbEFwcFBhdGgsIHRoaXMub3B0cy5hcHApO1xuICB9XG5cbiAgYXN5bmMgZGV0ZXJtaW5lRGV2aWNlICgpIHtcbiAgICAvLyBpbiB0aGUgb25lIGNhc2Ugd2hlcmUgd2UgY3JlYXRlIGEgc2ltLCB3ZSB3aWxsIHNldCB0aGlzIHN0YXRlXG4gICAgdGhpcy5saWZlY3ljbGVEYXRhLmNyZWF0ZVNpbSA9IGZhbHNlO1xuXG4gICAgLy8gaWYgd2UgZ2V0IGdlbmVyaWMgbmFtZXMsIHRyYW5zbGF0ZSB0aGVtXG4gICAgdGhpcy5vcHRzLmRldmljZU5hbWUgPSB0cmFuc2xhdGVEZXZpY2VOYW1lKHRoaXMub3B0cy5wbGF0Zm9ybVZlcnNpb24sIHRoaXMub3B0cy5kZXZpY2VOYW1lKTtcblxuICAgIGlmICh0aGlzLm9wdHMudWRpZCkge1xuICAgICAgaWYgKHRoaXMub3B0cy51ZGlkLnRvTG93ZXJDYXNlKCkgPT09ICdhdXRvJykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHRoaXMub3B0cy51ZGlkID0gYXdhaXQgZGV0ZWN0VWRpZCgpO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAvLyBUcnlpbmcgdG8gZmluZCBtYXRjaGluZyBVRElEIGZvciBTaW11bGF0b3JcbiAgICAgICAgICBsb2cud2FybihgQ2Fubm90IGRldGVjdCBhbnkgY29ubmVjdGVkIHJlYWwgZGV2aWNlcy4gRmFsbGluZyBiYWNrIHRvIFNpbXVsYXRvci4gT3JpZ2luYWwgZXJyb3I6ICR7ZXJyLm1lc3NhZ2V9YCk7XG4gICAgICAgICAgY29uc3QgZGV2aWNlID0gYXdhaXQgZ2V0RXhpc3RpbmdTaW0odGhpcy5vcHRzKTtcbiAgICAgICAgICBpZiAoIWRldmljZSkge1xuICAgICAgICAgICAgLy8gTm8gbWF0Y2hpbmcgU2ltdWxhdG9yIGlzIGZvdW5kLiBUaHJvdyBhbiBlcnJvclxuICAgICAgICAgICAgbG9nLmVycm9yQW5kVGhyb3coYENhbm5vdCBkZXRlY3QgdWRpZCBmb3IgJHt0aGlzLm9wdHMuZGV2aWNlTmFtZX0gU2ltdWxhdG9yIHJ1bm5pbmcgaU9TICR7dGhpcy5vcHRzLnBsYXRmb3JtVmVyc2lvbn1gKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gTWF0Y2hpbmcgU2ltdWxhdG9yIGV4aXN0cyBhbmQgaXMgZm91bmQuIFVzZSBpdFxuICAgICAgICAgIHRoaXMub3B0cy51ZGlkID0gZGV2aWNlLnVkaWQ7XG4gICAgICAgICAgcmV0dXJuIHtkZXZpY2UsIHJlYWxEZXZpY2U6IGZhbHNlLCB1ZGlkOiBkZXZpY2UudWRpZH07XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIG1ha2Ugc3VyZSBpdCBpcyBhIGNvbm5lY3RlZCBkZXZpY2UuIElmIG5vdCwgdGhlIHVkaWQgcGFzc2VkIGluIGlzIGludmFsaWRcbiAgICAgICAgY29uc3QgZGV2aWNlcyA9IGF3YWl0IGdldENvbm5lY3RlZERldmljZXMoKTtcbiAgICAgICAgbG9nLmRlYnVnKGBBdmFpbGFibGUgZGV2aWNlczogJHtkZXZpY2VzLmpvaW4oJywgJyl9YCk7XG4gICAgICAgIGlmICghZGV2aWNlcy5pbmNsdWRlcyh0aGlzLm9wdHMudWRpZCkpIHtcbiAgICAgICAgICAvLyBjaGVjayBmb3IgYSBwYXJ0aWN1bGFyIHNpbXVsYXRvclxuICAgICAgICAgIGlmIChhd2FpdCBzaW1FeGlzdHModGhpcy5vcHRzLnVkaWQpKSB7XG4gICAgICAgICAgICBjb25zdCBkZXZpY2UgPSBhd2FpdCBnZXRTaW11bGF0b3IodGhpcy5vcHRzLnVkaWQpO1xuICAgICAgICAgICAgcmV0dXJuIHtkZXZpY2UsIHJlYWxEZXZpY2U6IGZhbHNlLCB1ZGlkOiB0aGlzLm9wdHMudWRpZH07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIGRldmljZSBvciBzaW11bGF0b3IgVURJRDogJyR7dGhpcy5vcHRzLnVkaWR9J2ApO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRldmljZSA9IGF3YWl0IGdldFJlYWxEZXZpY2VPYmoodGhpcy5vcHRzLnVkaWQpO1xuICAgICAgcmV0dXJuIHtkZXZpY2UsIHJlYWxEZXZpY2U6IHRydWUsIHVkaWQ6IHRoaXMub3B0cy51ZGlkfTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMub3B0cy5wbGF0Zm9ybVZlcnNpb24gJiYgdGhpcy5pb3NTZGtWZXJzaW9uKSB7XG4gICAgICBsb2cuaW5mbyhgTm8gcGxhdGZvcm1WZXJzaW9uIHNwZWNpZmllZC4gVXNpbmcgbGF0ZXN0IHZlcnNpb24gWGNvZGUgc3VwcG9ydHM6ICcke3RoaXMuaW9zU2RrVmVyc2lvbn0nIGAgK1xuICAgICAgICAgICAgICAgYFRoaXMgbWF5IGNhdXNlIHByb2JsZW1zIGlmIGEgc2ltdWxhdG9yIGRvZXMgbm90IGV4aXN0IGZvciB0aGlzIHBsYXRmb3JtIHZlcnNpb24uYCk7XG4gICAgICB0aGlzLm9wdHMucGxhdGZvcm1WZXJzaW9uID0gdGhpcy5pb3NTZGtWZXJzaW9uO1xuICAgIH1cblxuICAgIGlmICh0aGlzLm9wdHMuZW5mb3JjZUZyZXNoU2ltdWxhdG9yQ3JlYXRpb24pIHtcbiAgICAgIGxvZy5kZWJ1ZyhgTmV3IHNpbXVsYXRvciBpcyByZXF1ZXN0ZWQuIElmIHRoaXMgaXMgbm90IHdhbnRlZCwgc2V0ICdlbmZvcmNlRnJlc2hTaW11bGF0b3JDcmVhdGlvbicgY2FwYWJpbGl0eSB0byBmYWxzZWApO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBmaWd1cmUgb3V0IHRoZSBjb3JyZWN0IHNpbXVsYXRvciB0byB1c2UsIGdpdmVuIHRoZSBkZXNpcmVkIGNhcGFiaWxpdGllc1xuICAgICAgY29uc3QgZGV2aWNlID0gYXdhaXQgZ2V0RXhpc3RpbmdTaW0odGhpcy5vcHRzKTtcblxuICAgICAgLy8gY2hlY2sgZm9yIGFuIGV4aXN0aW5nIHNpbXVsYXRvclxuICAgICAgaWYgKGRldmljZSkge1xuICAgICAgICByZXR1cm4ge2RldmljZSwgcmVhbERldmljZTogZmFsc2UsIHVkaWQ6IGRldmljZS51ZGlkfTtcbiAgICAgIH1cblxuICAgICAgbG9nLmluZm8oJ1NpbXVsYXRvciB1ZGlkIG5vdCBwcm92aWRlZCcpO1xuICAgIH1cblxuICAgIC8vIG5vIGRldmljZSBvZiB0aGlzIHR5cGUgZXhpc3RzLCBvciB0aGV5IHJlcXVlc3QgbmV3IHNpbSwgc28gY3JlYXRlIG9uZVxuICAgIGxvZy5pbmZvKCdVc2luZyBkZXNpcmVkIGNhcHMgdG8gY3JlYXRlIGEgbmV3IHNpbXVsYXRvcicpO1xuICAgIGNvbnN0IGRldmljZSA9IGF3YWl0IHRoaXMuY3JlYXRlU2ltKCk7XG4gICAgcmV0dXJuIHtkZXZpY2UsIHJlYWxEZXZpY2U6IGZhbHNlLCB1ZGlkOiBkZXZpY2UudWRpZH07XG4gIH1cblxuICBhc3luYyBzdGFydFNpbSAoKSB7XG4gICAgY29uc3QgcnVuT3B0cyA9IHtcbiAgICAgIHNjYWxlRmFjdG9yOiB0aGlzLm9wdHMuc2NhbGVGYWN0b3IsXG4gICAgICBjb25uZWN0SGFyZHdhcmVLZXlib2FyZDogISF0aGlzLm9wdHMuY29ubmVjdEhhcmR3YXJlS2V5Ym9hcmQsXG4gICAgICBpc0hlYWRsZXNzOiAhIXRoaXMub3B0cy5pc0hlYWRsZXNzLFxuICAgICAgZGV2aWNlUHJlZmVyZW5jZXM6IHt9LFxuICAgIH07XG5cbiAgICAvLyBhZGQgdGhlIHdpbmRvdyBjZW50ZXIsIGlmIGl0IGlzIHNwZWNpZmllZFxuICAgIGlmICh0aGlzLm9wdHMuU2ltdWxhdG9yV2luZG93Q2VudGVyKSB7XG4gICAgICBydW5PcHRzLmRldmljZVByZWZlcmVuY2VzLlNpbXVsYXRvcldpbmRvd0NlbnRlciA9IHRoaXMub3B0cy5TaW11bGF0b3JXaW5kb3dDZW50ZXI7XG4gICAgfVxuXG4gICAgLy8gVGhpcyBpcyB0byB3b3JrYXJvdW5kIFhDVGVzdCBidWcgYWJvdXQgY2hhbmdpbmcgU2ltdWxhdG9yXG4gICAgLy8gb3JpZW50YXRpb24gaXMgbm90IHN5bmNocm9uaXplZCB0byB0aGUgYWN0dWFsIHdpbmRvdyBvcmllbnRhdGlvblxuICAgIGNvbnN0IG9yaWVudGF0aW9uID0gXy5pc1N0cmluZyh0aGlzLm9wdHMub3JpZW50YXRpb24pICYmIHRoaXMub3B0cy5vcmllbnRhdGlvbi50b1VwcGVyQ2FzZSgpO1xuICAgIHN3aXRjaCAob3JpZW50YXRpb24pIHtcbiAgICAgIGNhc2UgJ0xBTkRTQ0FQRSc6XG4gICAgICAgIHJ1bk9wdHMuZGV2aWNlUHJlZmVyZW5jZXMuU2ltdWxhdG9yV2luZG93T3JpZW50YXRpb24gPSAnTGFuZHNjYXBlTGVmdCc7XG4gICAgICAgIHJ1bk9wdHMuZGV2aWNlUHJlZmVyZW5jZXMuU2ltdWxhdG9yV2luZG93Um90YXRpb25BbmdsZSA9IDkwO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ1BPUlRSQUlUJzpcbiAgICAgICAgcnVuT3B0cy5kZXZpY2VQcmVmZXJlbmNlcy5TaW11bGF0b3JXaW5kb3dPcmllbnRhdGlvbiA9ICdQb3J0cmFpdCc7XG4gICAgICAgIHJ1bk9wdHMuZGV2aWNlUHJlZmVyZW5jZXMuU2ltdWxhdG9yV2luZG93Um90YXRpb25BbmdsZSA9IDA7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIGF3YWl0IHRoaXMub3B0cy5kZXZpY2UucnVuKHJ1bk9wdHMpO1xuICB9XG5cbiAgYXN5bmMgY3JlYXRlU2ltICgpIHtcbiAgICB0aGlzLmxpZmVjeWNsZURhdGEuY3JlYXRlU2ltID0gdHJ1ZTtcblxuICAgIC8vIGNyZWF0ZSBzaW0gZm9yIGNhcHNcbiAgICBsZXQgc2ltID0gYXdhaXQgY3JlYXRlU2ltKHRoaXMub3B0cyk7XG4gICAgbG9nLmluZm8oYENyZWF0ZWQgc2ltdWxhdG9yIHdpdGggdWRpZCAnJHtzaW0udWRpZH0nLmApO1xuXG4gICAgcmV0dXJuIHNpbTtcbiAgfVxuXG4gIGFzeW5jIGxhdW5jaEFwcCAoKSB7XG4gICAgY29uc3QgQVBQX0xBVU5DSF9USU1FT1VUID0gMjAgKiAxMDAwO1xuXG4gICAgdGhpcy5sb2dFdmVudCgnYXBwTGF1bmNoQXR0ZW1wdGVkJyk7XG4gICAgYXdhaXQgbGF1bmNoKHRoaXMub3B0cy5kZXZpY2UudWRpZCwgdGhpcy5vcHRzLmJ1bmRsZUlkKTtcblxuICAgIGxldCBjaGVja1N0YXR1cyA9IGFzeW5jICgpID0+IHtcbiAgICAgIGxldCByZXNwb25zZSA9IGF3YWl0IHRoaXMucHJveHlDb21tYW5kKCcvc3RhdHVzJywgJ0dFVCcpO1xuICAgICAgbGV0IGN1cnJlbnRBcHAgPSByZXNwb25zZS5jdXJyZW50QXBwLmJ1bmRsZUlEO1xuICAgICAgaWYgKGN1cnJlbnRBcHAgIT09IHRoaXMub3B0cy5idW5kbGVJZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7dGhpcy5vcHRzLmJ1bmRsZUlkfSBub3QgaW4gZm9yZWdyb3VuZC4gJHtjdXJyZW50QXBwfSBpcyBpbiBmb3JlZ3JvdW5kYCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGxvZy5pbmZvKGBXYWl0aW5nIGZvciAnJHt0aGlzLm9wdHMuYnVuZGxlSWR9JyB0byBiZSBpbiBmb3JlZ3JvdW5kYCk7XG4gICAgbGV0IHJldHJpZXMgPSBwYXJzZUludChBUFBfTEFVTkNIX1RJTUVPVVQgLyAyMDAsIDEwKTtcbiAgICBhd2FpdCByZXRyeUludGVydmFsKHJldHJpZXMsIDIwMCwgY2hlY2tTdGF0dXMpO1xuICAgIGxvZy5pbmZvKGAke3RoaXMub3B0cy5idW5kbGVJZH0gaXMgaW4gZm9yZWdyb3VuZGApO1xuICAgIHRoaXMubG9nRXZlbnQoJ2FwcExhdW5jaGVkJyk7XG4gIH1cblxuICBhc3luYyBzdGFydFdkYVNlc3Npb24gKGJ1bmRsZUlkLCBwcm9jZXNzQXJndW1lbnRzKSB7XG4gICAgbGV0IGFyZ3MgPSBwcm9jZXNzQXJndW1lbnRzID8gKHByb2Nlc3NBcmd1bWVudHMuYXJncyB8fCBbXSkgOiBbXTtcbiAgICBpZiAoIV8uaXNBcnJheShhcmdzKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBwcm9jZXNzQXJndW1lbnRzLmFyZ3MgY2FwYWJpbGl0eSBpcyBleHBlY3RlZCB0byBiZSBhbiBhcnJheS4gYCArXG4gICAgICAgICAgICAgICAgICAgICAgYCR7SlNPTi5zdHJpbmdpZnkoYXJncyl9IGlzIGdpdmVuIGluc3RlYWRgKTtcbiAgICB9XG4gICAgbGV0IGVudiA9IHByb2Nlc3NBcmd1bWVudHMgPyAocHJvY2Vzc0FyZ3VtZW50cy5lbnYgfHwge30pIDoge307XG4gICAgaWYgKCFfLmlzUGxhaW5PYmplY3QoZW52KSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBwcm9jZXNzQXJndW1lbnRzLmVudiBjYXBhYmlsaXR5IGlzIGV4cGVjdGVkIHRvIGJlIGEgZGljdGlvbmFyeS4gYCArXG4gICAgICAgICAgICAgICAgICAgICAgYCR7SlNPTi5zdHJpbmdpZnkoZW52KX0gaXMgZ2l2ZW4gaW5zdGVhZGApO1xuICAgIH1cblxuICAgIGxldCBzaG91bGRXYWl0Rm9yUXVpZXNjZW5jZSA9IHV0aWwuaGFzVmFsdWUodGhpcy5vcHRzLndhaXRGb3JRdWllc2NlbmNlKSA/IHRoaXMub3B0cy53YWl0Rm9yUXVpZXNjZW5jZSA6IHRydWU7XG4gICAgbGV0IG1heFR5cGluZ0ZyZXF1ZW5jeSA9IHV0aWwuaGFzVmFsdWUodGhpcy5vcHRzLm1heFR5cGluZ0ZyZXF1ZW5jeSkgPyB0aGlzLm9wdHMubWF4VHlwaW5nRnJlcXVlbmN5IDogNjA7XG4gICAgbGV0IHNob3VsZFVzZVNpbmdsZXRvblRlc3RNYW5hZ2VyID0gdXRpbC5oYXNWYWx1ZSh0aGlzLm9wdHMuc2hvdWxkVXNlU2luZ2xldG9uVGVzdE1hbmFnZXIpID8gdGhpcy5vcHRzLnNob3VsZFVzZVNpbmdsZXRvblRlc3RNYW5hZ2VyIDogdHJ1ZTtcbiAgICBsZXQgc2hvdWxkVXNlVGVzdE1hbmFnZXJGb3JWaXNpYmlsaXR5RGV0ZWN0aW9uID0gZmFsc2U7XG4gICAgbGV0IGV2ZW50bG9vcElkbGVEZWxheVNlYyA9IHRoaXMub3B0cy53ZGFFdmVudGxvb3BJZGxlRGVsYXkgfHwgMDtcbiAgICBpZiAodXRpbC5oYXNWYWx1ZSh0aGlzLm9wdHMuc2ltcGxlSXNWaXNpYmxlQ2hlY2spKSB7XG4gICAgICBzaG91bGRVc2VUZXN0TWFuYWdlckZvclZpc2liaWxpdHlEZXRlY3Rpb24gPSB0aGlzLm9wdHMuc2ltcGxlSXNWaXNpYmxlQ2hlY2s7XG4gICAgfVxuICAgIGlmICghaXNOYU4ocGFyc2VGbG9hdCh0aGlzLm9wdHMucGxhdGZvcm1WZXJzaW9uKSkgJiYgcGFyc2VGbG9hdCh0aGlzLm9wdHMucGxhdGZvcm1WZXJzaW9uKS50b0ZpeGVkKDEpID09PSAnOS4zJykge1xuICAgICAgbG9nLmluZm8oYEZvcmNpbmcgc2hvdWxkVXNlU2luZ2xldG9uVGVzdE1hbmFnZXIgY2FwYWJpbGl0eSB2YWx1ZSB0byB0cnVlLCBiZWNhdXNlIG9mIGtub3duIFhDVGVzdCBpc3N1ZXMgdW5kZXIgOS4zIHBsYXRmb3JtIHZlcnNpb25gKTtcbiAgICAgIHNob3VsZFVzZVRlc3RNYW5hZ2VyRm9yVmlzaWJpbGl0eURldGVjdGlvbiA9IHRydWU7XG4gICAgfVxuICAgIGlmICh1dGlsLmhhc1ZhbHVlKHRoaXMub3B0cy5sYW5ndWFnZSkpIHtcbiAgICAgIGFyZ3MucHVzaCgnLUFwcGxlTGFuZ3VhZ2VzJywgYCgke3RoaXMub3B0cy5sYW5ndWFnZX0pYCk7XG4gICAgICBhcmdzLnB1c2goJy1OU0xhbmd1YWdlcycsIGAoJHt0aGlzLm9wdHMubGFuZ3VhZ2V9KWApO1xuICAgIH1cblxuICAgIGlmICh1dGlsLmhhc1ZhbHVlKHRoaXMub3B0cy5sb2NhbGUpKSB7XG4gICAgICBhcmdzLnB1c2goJy1BcHBsZUxvY2FsZScsIHRoaXMub3B0cy5sb2NhbGUpO1xuICAgIH1cblxuICAgIGxldCBkZXNpcmVkID0ge1xuICAgICAgZGVzaXJlZENhcGFiaWxpdGllczoge1xuICAgICAgICBidW5kbGVJZCxcbiAgICAgICAgYXJndW1lbnRzOiBhcmdzLFxuICAgICAgICBlbnZpcm9ubWVudDogZW52LFxuICAgICAgICBldmVudGxvb3BJZGxlRGVsYXlTZWMsXG4gICAgICAgIHNob3VsZFdhaXRGb3JRdWllc2NlbmNlLFxuICAgICAgICBzaG91bGRVc2VUZXN0TWFuYWdlckZvclZpc2liaWxpdHlEZXRlY3Rpb24sXG4gICAgICAgIG1heFR5cGluZ0ZyZXF1ZW5jeSxcbiAgICAgICAgc2hvdWxkVXNlU2luZ2xldG9uVGVzdE1hbmFnZXIsXG4gICAgICB9XG4gICAgfTtcbiAgICBpZiAodXRpbC5oYXNWYWx1ZSh0aGlzLm9wdHMuc2hvdWxkVXNlQ29tcGFjdFJlc3BvbnNlcykpIHtcbiAgICAgIGRlc2lyZWQuZGVzaXJlZENhcGFiaWxpdGllcy5zaG91bGRVc2VDb21wYWN0UmVzcG9uc2VzID0gdGhpcy5vcHRzLnNob3VsZFVzZUNvbXBhY3RSZXNwb25zZXM7XG4gICAgfVxuICAgIGlmICh1dGlsLmhhc1ZhbHVlKHRoaXMub3B0cy5lbGVtZW50UmVzcG9uc2VGaWVsZHMpKSB7XG4gICAgICBkZXNpcmVkLmRlc2lyZWRDYXBhYmlsaXRpZXMuZWxlbWVudFJlc3BvbnNlRmllbGRzID0gdGhpcy5vcHRzLmVsZW1lbnRSZXNwb25zZUZpZWxkcztcbiAgICB9XG4gICAgaWYgKHRoaXMub3B0cy5hdXRvQWNjZXB0QWxlcnRzKSB7XG4gICAgICBkZXNpcmVkLmRlc2lyZWRDYXBhYmlsaXRpZXMuZGVmYXVsdEFsZXJ0QWN0aW9uID0gJ2FjY2VwdCc7XG4gICAgfSBlbHNlIGlmICh0aGlzLm9wdHMuYXV0b0Rpc21pc3NBbGVydHMpIHtcbiAgICAgIGRlc2lyZWQuZGVzaXJlZENhcGFiaWxpdGllcy5kZWZhdWx0QWxlcnRBY3Rpb24gPSAnZGlzbWlzcyc7XG4gICAgfVxuXG4gICAgYXdhaXQgdGhpcy5wcm94eUNvbW1hbmQoJy9zZXNzaW9uJywgJ1BPU1QnLCBkZXNpcmVkKTtcbiAgfVxuXG4gIC8vIE92ZXJyaWRlIFByb3h5IG1ldGhvZHMgZnJvbSBCYXNlRHJpdmVyXG4gIHByb3h5QWN0aXZlICgpIHtcbiAgICByZXR1cm4gdGhpcy5qd3BQcm94eUFjdGl2ZTtcbiAgfVxuXG4gIGdldFByb3h5QXZvaWRMaXN0ICgpIHtcbiAgICBpZiAodGhpcy5pc1dlYnZpZXcoKSkge1xuICAgICAgcmV0dXJuIE5PX1BST1hZX1dFQl9MSVNUO1xuICAgIH1cbiAgICByZXR1cm4gTk9fUFJPWFlfTkFUSVZFX0xJU1Q7XG4gIH1cblxuICBjYW5Qcm94eSAoKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBpc1NhZmFyaSAoKSB7XG4gICAgcmV0dXJuICEhdGhpcy5zYWZhcmk7XG4gIH1cblxuICBpc1JlYWxEZXZpY2UgKCkge1xuICAgIHJldHVybiB0aGlzLm9wdHMucmVhbERldmljZTtcbiAgfVxuXG4gIGlzU2ltdWxhdG9yICgpIHtcbiAgICByZXR1cm4gIXRoaXMub3B0cy5yZWFsRGV2aWNlO1xuICB9XG5cbiAgaXNXZWJ2aWV3ICgpIHtcbiAgICByZXR1cm4gdGhpcy5pc1NhZmFyaSgpIHx8IHRoaXMuaXNXZWJDb250ZXh0KCk7XG4gIH1cblxuICB2YWxpZGF0ZUxvY2F0b3JTdHJhdGVneSAoc3RyYXRlZ3kpIHtcbiAgICBzdXBlci52YWxpZGF0ZUxvY2F0b3JTdHJhdGVneShzdHJhdGVneSwgdGhpcy5pc1dlYkNvbnRleHQoKSk7XG4gIH1cblxuICB2YWxpZGF0ZURlc2lyZWRDYXBzIChjYXBzKSB7XG4gICAgaWYgKCFzdXBlci52YWxpZGF0ZURlc2lyZWRDYXBzKGNhcHMpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gbWFrZSBzdXJlIHRoYXQgdGhlIGNhcGFiaWxpdGllcyBoYXZlIG9uZSBvZiBgYXBwYCBvciBgYnVuZGxlSWRgXG4gICAgaWYgKChjYXBzLmJyb3dzZXJOYW1lIHx8ICcnKS50b0xvd2VyQ2FzZSgpICE9PSAnc2FmYXJpJyAmJiAhY2Fwcy5hcHAgJiYgIWNhcHMuYnVuZGxlSWQpIHtcbiAgICAgIGxldCBtc2cgPSAnVGhlIGRlc2lyZWQgY2FwYWJpbGl0aWVzIG11c3QgaW5jbHVkZSBlaXRoZXIgYW4gYXBwIG9yIGEgYnVuZGxlSWQgZm9yIGlPUyc7XG4gICAgICBsb2cuZXJyb3JBbmRUaHJvdyhtc2cpO1xuICAgIH1cblxuICAgIGxldCB2ZXJpZnlQcm9jZXNzQXJndW1lbnQgPSAocHJvY2Vzc0FyZ3VtZW50cykgPT4ge1xuICAgICAgY29uc3Qge2FyZ3MsIGVudn0gPSBwcm9jZXNzQXJndW1lbnRzO1xuICAgICAgaWYgKCFfLmlzTmlsKGFyZ3MpICYmICFfLmlzQXJyYXkoYXJncykpIHtcbiAgICAgICAgbG9nLmVycm9yQW5kVGhyb3coJ3Byb2Nlc3NBcmd1bWVudHMuYXJncyBtdXN0IGJlIGFuIGFycmF5IG9mIHN0cmluZ3MnKTtcbiAgICAgIH1cbiAgICAgIGlmICghXy5pc05pbChlbnYpICYmICFfLmlzUGxhaW5PYmplY3QoZW52KSkge1xuICAgICAgICBsb2cuZXJyb3JBbmRUaHJvdygncHJvY2Vzc0FyZ3VtZW50cy5lbnYgbXVzdCBiZSBhbiBvYmplY3QgPGtleSx2YWx1ZT4gcGFpciB7YTpiLCBjOmR9Jyk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8vIGBwcm9jZXNzQXJndW1lbnRzYCBzaG91bGQgYmUgSlNPTiBzdHJpbmcgb3IgYW4gb2JqZWN0IHdpdGggYXJndW1lbnRzIGFuZC8gZW52aXJvbm1lbnQgZGV0YWlsc1xuICAgIGlmIChjYXBzLnByb2Nlc3NBcmd1bWVudHMpIHtcbiAgICAgIGlmIChfLmlzU3RyaW5nKGNhcHMucHJvY2Vzc0FyZ3VtZW50cykpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAvLyB0cnkgdG8gcGFyc2UgdGhlIHN0cmluZyBhcyBKU09OXG4gICAgICAgICAgY2Fwcy5wcm9jZXNzQXJndW1lbnRzID0gSlNPTi5wYXJzZShjYXBzLnByb2Nlc3NBcmd1bWVudHMpO1xuICAgICAgICAgIHZlcmlmeVByb2Nlc3NBcmd1bWVudChjYXBzLnByb2Nlc3NBcmd1bWVudHMpO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICBsb2cuZXJyb3JBbmRUaHJvdyhgcHJvY2Vzc0FyZ3VtZW50cyBtdXN0IGJlIGEganNvbiBmb3JtYXQgb3IgYW4gb2JqZWN0IHdpdGggZm9ybWF0IHthcmdzIDogW10sIGVudiA6IHthOmIsIGM6ZH19LiBgICtcbiAgICAgICAgICAgIGBCb3RoIGVudmlyb25tZW50IGFuZCBhcmd1bWVudCBjYW4gYmUgbnVsbC4gRXJyb3I6ICR7ZXJyfWApO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKF8uaXNQbGFpbk9iamVjdChjYXBzLnByb2Nlc3NBcmd1bWVudHMpKSB7XG4gICAgICAgIHZlcmlmeVByb2Nlc3NBcmd1bWVudChjYXBzLnByb2Nlc3NBcmd1bWVudHMpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbG9nLmVycm9yQW5kVGhyb3coYCdwcm9jZXNzQXJndW1lbnRzIG11c3QgYmUgYW4gb2JqZWN0LCBvciBhIHN0cmluZyBKU09OIG9iamVjdCB3aXRoIGZvcm1hdCB7YXJncyA6IFtdLCBlbnYgOiB7YTpiLCBjOmR9fS4gYCArXG4gICAgICAgICAgYEJvdGggZW52aXJvbm1lbnQgYW5kIGFyZ3VtZW50IGNhbiBiZSBudWxsLmApO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIHRoZXJlIGlzIG5vIHBvaW50IGluIGhhdmluZyBga2V5Y2hhaW5QYXRoYCB3aXRob3V0IGBrZXljaGFpblBhc3N3b3JkYFxuICAgIGlmICgoY2Fwcy5rZXljaGFpblBhdGggJiYgIWNhcHMua2V5Y2hhaW5QYXNzd29yZCkgfHwgKCFjYXBzLmtleWNoYWluUGF0aCAmJiBjYXBzLmtleWNoYWluUGFzc3dvcmQpKSB7XG4gICAgICBsb2cuZXJyb3JBbmRUaHJvdyhgSWYgJ2tleWNoYWluUGF0aCcgaXMgc2V0LCAna2V5Y2hhaW5QYXNzd29yZCcgbXVzdCBhbHNvIGJlIHNldCAoYW5kIHZpY2UgdmVyc2EpLmApO1xuICAgIH1cblxuICAgIC8vIGByZXNldE9uU2Vzc2lvblN0YXJ0T25seWAgc2hvdWxkIGJlIHNldCB0byB0cnVlIGJ5IGRlZmF1bHRcbiAgICB0aGlzLm9wdHMucmVzZXRPblNlc3Npb25TdGFydE9ubHkgPSAhdXRpbC5oYXNWYWx1ZSh0aGlzLm9wdHMucmVzZXRPblNlc3Npb25TdGFydE9ubHkpIHx8IHRoaXMub3B0cy5yZXNldE9uU2Vzc2lvblN0YXJ0T25seTtcbiAgICB0aGlzLm9wdHMudXNlTmV3V0RBID0gdXRpbC5oYXNWYWx1ZSh0aGlzLm9wdHMudXNlTmV3V0RBKSA/IHRoaXMub3B0cy51c2VOZXdXREEgOiBmYWxzZTtcblxuICAgIGlmIChjYXBzLmNvbW1hbmRUaW1lb3V0cykge1xuICAgICAgY2Fwcy5jb21tYW5kVGltZW91dHMgPSBub3JtYWxpemVDb21tYW5kVGltZW91dHMoY2Fwcy5jb21tYW5kVGltZW91dHMpO1xuICAgIH1cblxuICAgIGlmIChfLmlzU3RyaW5nKGNhcHMud2ViRHJpdmVyQWdlbnRVcmwpKSB7XG4gICAgICBjb25zdCB7cHJvdG9jb2wsIGhvc3R9ID0gdXJsLnBhcnNlKGNhcHMud2ViRHJpdmVyQWdlbnRVcmwpO1xuICAgICAgaWYgKF8uaXNFbXB0eShwcm90b2NvbCkgfHwgXy5pc0VtcHR5KGhvc3QpKSB7XG4gICAgICAgIGxvZy5lcnJvckFuZFRocm93KGAnd2ViRHJpdmVyQWdlbnRVcmwnIGNhcGFiaWxpdHkgaXMgZXhwZWN0ZWQgdG8gY29udGFpbiBhIHZhbGlkIFdlYkRyaXZlckFnZW50IHNlcnZlciBVUkwuIGAgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICBgJyR7Y2Fwcy53ZWJEcml2ZXJBZ2VudFVybH0nIGlzIGdpdmVuIGluc3RlYWRgKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoY2Fwcy5icm93c2VyTmFtZSkge1xuICAgICAgaWYgKGNhcHMuYnVuZGxlSWQpIHtcbiAgICAgICAgbG9nLmVycm9yQW5kVGhyb3coYCdicm93c2VyTmFtZScgY2Fubm90IGJlIHNldCB0b2dldGhlciB3aXRoICdidW5kbGVJZCcgY2FwYWJpbGl0eWApO1xuICAgICAgfVxuICAgICAgLy8gd2FybiBpZiB0aGUgY2FwYWJpbGl0aWVzIGhhdmUgYm90aCBgYXBwYCBhbmQgYGJyb3dzZXIsIGFsdGhvdWdoIHRoaXNcbiAgICAgIC8vIGlzIGNvbW1vbiB3aXRoIHNlbGVuaXVtIGdyaWRcbiAgICAgIGlmIChjYXBzLmFwcCkge1xuICAgICAgICBsb2cud2FybihgVGhlIGNhcGFiaWxpdGllcyBzaG91bGQgZ2VuZXJhbGx5IG5vdCBpbmNsdWRlIGJvdGggYW4gJ2FwcCcgYW5kIGEgJ2Jyb3dzZXJOYW1lJ2ApO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChjYXBzLnBlcm1pc3Npb25zKSB7XG4gICAgICB0cnkge1xuICAgICAgICBmb3IgKGNvbnN0IFtidW5kbGVJZCwgcGVybXNdIG9mIF8udG9QYWlycyhKU09OLnBhcnNlKGNhcHMucGVybWlzc2lvbnMpKSkge1xuICAgICAgICAgIGlmICghXy5pc1N0cmluZyhidW5kbGVJZCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgJyR7SlNPTi5zdHJpbmdpZnkoYnVuZGxlSWQpfScgbXVzdCBiZSBhIHN0cmluZ2ApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIV8uaXNQbGFpbk9iamVjdChwZXJtcykpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgJyR7SlNPTi5zdHJpbmdpZnkocGVybXMpfScgbXVzdCBiZSBhIEpTT04gb2JqZWN0YCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGxvZy5lcnJvckFuZFRocm93KGAnJHtjYXBzLnBlcm1pc3Npb25zfScgaXMgZXhwZWN0ZWQgdG8gYmUgYSB2YWxpZCBvYmplY3Qgd2l0aCBmb3JtYXQgYCArXG4gICAgICAgICAgYHtcIjxidW5kbGVJZDE+XCI6IHtcIjxzZXJ2aWNlTmFtZTE+XCI6IFwiPHNlcnZpY2VTdGF0dXMxPlwiLCAuLi59LCAuLi59LiBPcmlnaW5hbCBlcnJvcjogJHtlLm1lc3NhZ2V9YCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gZmluYWxseSwgcmV0dXJuIHRydWUgc2luY2UgdGhlIHN1cGVyY2xhc3MgY2hlY2sgcGFzc2VkLCBhcyBkaWQgdGhpc1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgYXN5bmMgaW5zdGFsbEFVVCAoKSB7XG4gICAgaWYgKHRoaXMuaXNTYWZhcmkoKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvLyBpZiB1c2VyIGhhcyBwYXNzZWQgaW4gZGVzaXJlZENhcHMuYXV0b0xhdW5jaCA9IGZhbHNlXG4gICAgLy8gbWVhbmluZyB0aGV5IHdpbGwgbWFuYWdlIGFwcCBpbnN0YWxsIC8gbGF1bmNoaW5nXG4gICAgaWYgKHRoaXMub3B0cy5hdXRvTGF1bmNoID09PSBmYWxzZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBhd2FpdCB2ZXJpZnlBcHBsaWNhdGlvblBsYXRmb3JtKHRoaXMub3B0cy5hcHAsIHRoaXMuaXNTaW11bGF0b3IoKSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAvLyBUT0RPOiBMZXQgaXQgdGhyb3cgYWZ0ZXIgd2UgY29uZmlybSB0aGUgYXJjaGl0ZWN0dXJlIHZlcmlmaWNhdGlvbiBhbGdvcml0aG0gaXMgc3RhYmxlXG4gICAgICBsb2cud2FybihgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqYCk7XG4gICAgICBsb2cud2FybihgJHt0aGlzLmlzU2ltdWxhdG9yKCkgPyAnU2ltdWxhdG9yJyA6ICdSZWFsIGRldmljZSd9IGFyY2hpdGVjdHVyZSBhcHBlYXJzIHRvIGJlIHVuc3VwcG9ydGVkIGAgK1xuICAgICAgICAgICAgICAgYGJ5IHRoZSAnJHt0aGlzLm9wdHMuYXBwfScgYXBwbGljYXRpb24uIGAgK1xuICAgICAgICAgICAgICAgYE1ha2Ugc3VyZSB0aGUgY29ycmVjdCBkZXBsb3ltZW50IHRhcmdldCBoYXMgYmVlbiBzZWxlY3RlZCBmb3IgaXRzIGNvbXBpbGF0aW9uIGluIFhjb2RlLmApO1xuICAgICAgbG9nLndhcm4oJ0RvblxcJ3QgYmUgc3VycHJpc2VkIGlmIHRoZSBhcHBsaWNhdGlvbiBmYWlscyB0byBsYXVuY2guJyk7XG4gICAgICBsb2cud2FybihgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqYCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNSZWFsRGV2aWNlKCkpIHtcbiAgICAgIGF3YWl0IGluc3RhbGxUb1JlYWxEZXZpY2UodGhpcy5vcHRzLmRldmljZSwgdGhpcy5vcHRzLmFwcCwgdGhpcy5vcHRzLmJ1bmRsZUlkLCB0aGlzLm9wdHMubm9SZXNldCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGF3YWl0IGluc3RhbGxUb1NpbXVsYXRvcih0aGlzLm9wdHMuZGV2aWNlLCB0aGlzLm9wdHMuYXBwLCB0aGlzLm9wdHMuYnVuZGxlSWQsIHRoaXMub3B0cy5ub1Jlc2V0KTtcbiAgICB9XG5cbiAgICBpZiAodXRpbC5oYXNWYWx1ZSh0aGlzLm9wdHMuaW9zSW5zdGFsbFBhdXNlKSkge1xuICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FwcGl1bS9hcHBpdW0vaXNzdWVzLzY4ODlcbiAgICAgIGxldCBwYXVzZSA9IHBhcnNlSW50KHRoaXMub3B0cy5pb3NJbnN0YWxsUGF1c2UsIDEwKTtcbiAgICAgIGxvZy5kZWJ1ZyhgaW9zSW5zdGFsbFBhdXNlIHNldC4gUGF1c2luZyAke3BhdXNlfSBtcyBiZWZvcmUgY29udGludWluZ2ApO1xuICAgICAgYXdhaXQgQi5kZWxheShwYXVzZSk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgc2V0SW5pdGlhbE9yaWVudGF0aW9uIChvcmllbnRhdGlvbikge1xuICAgIGlmICghXy5pc1N0cmluZyhvcmllbnRhdGlvbikpIHtcbiAgICAgIGxvZy5pbmZvKCdTa2lwcGluZyBzZXR0aW5nIG9mIHRoZSBpbml0aWFsIGRpc3BsYXkgb3JpZW50YXRpb24uICcgK1xuICAgICAgICAnU2V0IHRoZSBcIm9yaWVudGF0aW9uXCIgY2FwYWJpbGl0eSB0byBlaXRoZXIgXCJMQU5EU0NBUEVcIiBvciBcIlBPUlRSQUlUXCIsIGlmIHRoaXMgaXMgYW4gdW5kZXNpcmVkIGJlaGF2aW9yLicpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBvcmllbnRhdGlvbiA9IG9yaWVudGF0aW9uLnRvVXBwZXJDYXNlKCk7XG4gICAgaWYgKCFfLmluY2x1ZGVzKFsnTEFORFNDQVBFJywgJ1BPUlRSQUlUJ10sIG9yaWVudGF0aW9uKSkge1xuICAgICAgbG9nLmRlYnVnKGBVbmFibGUgdG8gc2V0IGluaXRpYWwgb3JpZW50YXRpb24gdG8gJyR7b3JpZW50YXRpb259J2ApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBsb2cuZGVidWcoYFNldHRpbmcgaW5pdGlhbCBvcmllbnRhdGlvbiB0byAnJHtvcmllbnRhdGlvbn0nYCk7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMucHJveHlDb21tYW5kKCcvb3JpZW50YXRpb24nLCAnUE9TVCcsIHtvcmllbnRhdGlvbn0pO1xuICAgICAgdGhpcy5vcHRzLmN1ck9yaWVudGF0aW9uID0gb3JpZW50YXRpb247XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBsb2cud2FybihgU2V0dGluZyBpbml0aWFsIG9yaWVudGF0aW9uIGZhaWxlZCB3aXRoOiAke2Vyci5tZXNzYWdlfWApO1xuICAgIH1cbiAgfVxuXG4gIF9nZXRDb21tYW5kVGltZW91dCAoY21kTmFtZSkge1xuICAgIGlmICh0aGlzLm9wdHMuY29tbWFuZFRpbWVvdXRzKSB7XG4gICAgICBpZiAoY21kTmFtZSAmJiBfLmhhcyh0aGlzLm9wdHMuY29tbWFuZFRpbWVvdXRzLCBjbWROYW1lKSkge1xuICAgICAgICByZXR1cm4gdGhpcy5vcHRzLmNvbW1hbmRUaW1lb3V0c1tjbWROYW1lXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLm9wdHMuY29tbWFuZFRpbWVvdXRzW0RFRkFVTFRfVElNRU9VVF9LRVldO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgc2Vzc2lvbiBjYXBhYmlsaXRpZXMgbWVyZ2VkIHdpdGggd2hhdCBXREEgcmVwb3J0c1xuICAgKiBUaGlzIGlzIGEgbGlicmFyeSBjb21tYW5kIGJ1dCBuZWVkcyB0byBjYWxsICdzdXBlcicgc28gY2FuJ3QgYmUgb25cbiAgICogYSBoZWxwZXIgb2JqZWN0XG4gICAqL1xuICBhc3luYyBnZXRTZXNzaW9uICgpIHtcbiAgICAvLyBjYWxsIHN1cGVyIHRvIGdldCBldmVudCB0aW1pbmdzLCBldGMuLi5cbiAgICBjb25zdCBkcml2ZXJTZXNzaW9uID0gYXdhaXQgc3VwZXIuZ2V0U2Vzc2lvbigpO1xuICAgIGlmICghdGhpcy53ZGFDYXBzKSB7XG4gICAgICB0aGlzLndkYUNhcHMgPSBhd2FpdCB0aGlzLnByb3h5Q29tbWFuZCgnLycsICdHRVQnKTtcbiAgICB9XG4gICAgaWYgKCF0aGlzLmRldmljZUNhcHMpIHtcbiAgICAgIGNvbnN0IHtzdGF0dXNCYXJTaXplLCBzY2FsZX0gPSBhd2FpdCB0aGlzLmdldFNjcmVlbkluZm8oKTtcbiAgICAgIHRoaXMuZGV2aWNlQ2FwcyA9IHtcbiAgICAgICAgcGl4ZWxSYXRpbzogc2NhbGUsXG4gICAgICAgIHN0YXRCYXJIZWlnaHQ6IHN0YXR1c0JhclNpemUuaGVpZ2h0LFxuICAgICAgICB2aWV3cG9ydFJlY3Q6IGF3YWl0IHRoaXMuZ2V0Vmlld3BvcnRSZWN0KCksXG4gICAgICB9O1xuICAgIH1cbiAgICBsb2cuaW5mbygnTWVyZ2luZyBXREEgY2FwcyBvdmVyIEFwcGl1bSBjYXBzIGZvciBzZXNzaW9uIGRldGFpbCByZXNwb25zZScpO1xuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt1ZGlkOiB0aGlzLm9wdHMudWRpZH0sIGRyaXZlclNlc3Npb24sXG4gICAgICB0aGlzLndkYUNhcHMuY2FwYWJpbGl0aWVzLCB0aGlzLmRldmljZUNhcHMpO1xuICB9XG5cbiAgYXN5bmMgc3RhcnRJV0RQICgpIHtcbiAgICB0aGlzLmxvZ0V2ZW50KCdpd2RwU3RhcnRpbmcnKTtcbiAgICB0aGlzLml3ZHBTZXJ2ZXIgPSBuZXcgSVdEUCh7XG4gICAgICB3ZWJraXREZWJ1Z1Byb3h5UG9ydDogdGhpcy5vcHRzLndlYmtpdERlYnVnUHJveHlQb3J0LFxuICAgICAgdWRpZDogdGhpcy5vcHRzLnVkaWQsXG4gICAgICBsb2dTdGRvdXQ6ICEhdGhpcy5vcHRzLnNob3dJV0RQTG9nLFxuICAgIH0pO1xuICAgIGF3YWl0IHRoaXMuaXdkcFNlcnZlci5zdGFydCgpO1xuICAgIHRoaXMubG9nRXZlbnQoJ2l3ZHBTdGFydGVkJyk7XG4gIH1cblxuICBhc3luYyBzdG9wSVdEUCAoKSB7XG4gICAgaWYgKHRoaXMuaXdkcFNlcnZlcikge1xuICAgICAgYXdhaXQgdGhpcy5pd2RwU2VydmVyLnN0b3AoKTtcbiAgICAgIGRlbGV0ZSB0aGlzLml3ZHBTZXJ2ZXI7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcmVzZXQgKCkge1xuICAgIGlmICh0aGlzLm9wdHMubm9SZXNldCkge1xuICAgICAgLy8gVGhpcyBpcyB0byBtYWtlIHN1cmUgcmVzZXQgaGFwcGVucyBldmVuIGlmIG5vUmVzZXQgaXMgc2V0IHRvIHRydWVcbiAgICAgIGxldCBvcHRzID0gXy5jbG9uZURlZXAodGhpcy5vcHRzKTtcbiAgICAgIG9wdHMubm9SZXNldCA9IGZhbHNlO1xuICAgICAgb3B0cy5mdWxsUmVzZXQgPSBmYWxzZTtcbiAgICAgIGNvbnN0IHNodXRkb3duSGFuZGxlciA9IHRoaXMucmVzZXRPblVuZXhwZWN0ZWRTaHV0ZG93bjtcbiAgICAgIHRoaXMucmVzZXRPblVuZXhwZWN0ZWRTaHV0ZG93biA9ICgpID0+IHt9O1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgdGhpcy5ydW5SZXNldChvcHRzKTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIHRoaXMucmVzZXRPblVuZXhwZWN0ZWRTaHV0ZG93biA9IHNodXRkb3duSGFuZGxlcjtcbiAgICAgIH1cbiAgICB9XG4gICAgYXdhaXQgc3VwZXIucmVzZXQoKTtcbiAgfVxufVxuXG5PYmplY3QuYXNzaWduKFhDVUlUZXN0RHJpdmVyLnByb3RvdHlwZSwgY29tbWFuZHMpO1xuXG5leHBvcnQgZGVmYXVsdCBYQ1VJVGVzdERyaXZlcjtcbmV4cG9ydCB7IFhDVUlUZXN0RHJpdmVyIH07XG4iXSwiZmlsZSI6ImxpYi9kcml2ZXIuanMiLCJzb3VyY2VSb290IjoiLi4vLi4ifQ==
